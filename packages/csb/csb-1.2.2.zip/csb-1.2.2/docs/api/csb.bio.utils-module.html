<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>csb.bio.utils</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="csb-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >CSB v1.2.2.614</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="csb-module.html">Package&nbsp;csb</a> ::
        <a href="csb.bio-module.html">Package&nbsp;bio</a> ::
        Package&nbsp;utils
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="csb.bio.utils-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== PACKAGE DESCRIPTION ==================== -->
<h1 class="epydoc">Package utils</h1><p class="nomargin-top"><span class="codelink"><a href="csb.bio.utils-pysrc.html">source&nbsp;code</a></span></p>
<p>Computational utility functions.</p>
  <p>This module defines a number of low-level, numerical, high-performance
  utility functions like <a href="csb.bio.utils-module.html#rmsd" 
  class="link">rmsd</a> for example.</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(n,3) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#average_structure" class="summary-sig-name">average_structure</a>(<span class="summary-sig-arg">X</span>)</span><br />
      Calculate an average structure from an ensemble of structures (i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#average_structure">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#bfit" class="summary-sig-name">bfit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">n_iter</span>=<span class="summary-sig-default">10</span>,
        <span class="summary-sig-arg">distribution</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">student</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">em</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">full_output</span>=<span class="summary-sig-default">False</span>)</span><br />
      Robust superposition of two coordinate arrays.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#bfit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(d,) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#center_of_mass" class="summary-sig-name">center_of_mass</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">m</span>=<span class="summary-sig-default">None</span>)</span><br />
      Compute the mean of a set of (optionally weighted) points.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#center_of_mass">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#deg" class="summary-sig-name">deg</a>(<span class="summary-sig-arg">x</span>)</span><br />
      Convert an array of torsion angles in radians to torsion degrees 
      ranging from -180 to 180.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#deg">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(m,) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#distance" class="summary-sig-name">distance</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Distance between <code>X</code> and <code>Y</code> along the last 
      axis.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#distance">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#distance_matrix" class="summary-sig-name">distance_matrix</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>=<span class="summary-sig-default">None</span>)</span><br />
      Calculates a matrix of pairwise distances</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#distance_matrix">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(m,) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#distance_sq" class="summary-sig-name">distance_sq</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Squared distance between <code>X</code> and <code>Y</code> along the 
      last axis.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#distance_sq">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">iterable</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#find_pairs" class="summary-sig-name">find_pairs</a>(<span class="summary-sig-arg">cutoff</span>,
        <span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>=<span class="summary-sig-default">None</span>)</span><br />
      Find pairs with euclidean distance below <code>cutoff</code>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#find_pairs">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#fit" class="summary-sig-name">fit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Return the translation vector and the rotation matrix minimizing the 
      RMSD between two sets of d-dimensional vectors, i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#fit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(n,3) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#fit_transform" class="summary-sig-name">fit_transform</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">fit</span>=<span class="summary-sig-default">&lt;function fit at 0x02E03FB0&gt;</span>,
        <span class="summary-sig-arg">*args</span>)</span><br />
      Return Y superposed on X.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#fit_transform">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#fit_wellordered" class="summary-sig-name">fit_wellordered</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">n_iter</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">n_stdv</span>=<span class="summary-sig-default">2</span>,
        <span class="summary-sig-arg">tol_rmsd</span>=<span class="summary-sig-default">0.5</span>,
        <span class="summary-sig-arg">tol_stdv</span>=<span class="summary-sig-default">0.05</span>,
        <span class="summary-sig-arg">full_output</span>=<span class="summary-sig-default">False</span>)</span><br />
      Match two arrays onto each other by iteratively throwing out highly 
      deviating entries.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#fit_wellordered">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(d,d) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#inertia_tensor" class="summary-sig-name">inertia_tensor</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">m</span>=<span class="summary-sig-default">None</span>)</span><br />
      Compute the inertia tensor of a set of (optionally weighted) points.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#inertia_tensor">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#is_mirror_image" class="summary-sig-name">is_mirror_image</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Check if two configurations X and Y are mirror images (i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#is_mirror_image">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#probabilistic_fit" class="summary-sig-name">probabilistic_fit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">w</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">niter</span>=<span class="summary-sig-default">10</span>)</span><br />
      Generate a superposition of X, Y where:</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#probabilistic_fit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#rad" class="summary-sig-name">rad</a>(<span class="summary-sig-arg">x</span>)</span><br />
      Convert an array of torsion angles in torsion degrees to radians.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#rad">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(d,) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#radius_of_gyration" class="summary-sig-name">radius_of_gyration</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">m</span>=<span class="summary-sig-default">None</span>)</span><br />
      Compute the radius of gyration of a set of (optionally weighted) 
      points.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#radius_of_gyration">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#rmsd" class="summary-sig-name">rmsd</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Calculate the root mean squared deviation (RMSD) using Kabsch' 
      formula.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#rmsd">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#rmsd_cur" class="summary-sig-name">rmsd_cur</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Calculate the RMSD of two conformations as they are (no fitting is 
      done).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#rmsd_cur">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#scale_and_fit" class="summary-sig-name">scale_and_fit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">check_mirror_image</span>=<span class="summary-sig-default">False</span>)</span><br />
      Return the translation vector, the rotation matrix and a global 
      scaling factor minimizing the RMSD between two sets of d-dimensional 
      vectors, i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#scale_and_fit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(d,d) numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#second_moments" class="summary-sig-name">second_moments</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">m</span>=<span class="summary-sig-default">None</span>)</span><br />
      Compute the tensor second moments of a set of (optionally weighted) 
      points.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#second_moments">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#tm_score" class="summary-sig-name">tm_score</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">y</span>,
        <span class="summary-sig-arg">L</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">d0</span>=<span class="summary-sig-default">None</span>)</span><br />
      Evaluate the TM-score of two conformations as they are (no fitting is
      done).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#tm_score">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#tm_superimpose" class="summary-sig-name">tm_superimpose</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">y</span>,
        <span class="summary-sig-arg">fit_method</span>=<span class="summary-sig-default">&lt;function fit at 0x02E03FB0&gt;</span>,
        <span class="summary-sig-arg">L</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">d0</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">L_ini_min</span>=<span class="summary-sig-default">4</span>,
        <span class="summary-sig-arg">iL_step</span>=<span class="summary-sig-default">1</span>)</span><br />
      Compute the TM-score of two protein coordinate vector sets.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#tm_superimpose">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#torsion_rmsd" class="summary-sig-name">torsion_rmsd</a>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">y</span>)</span><br />
      Compute the circular RMSD of two phi/psi angle sets.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#torsion_rmsd">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#transform" class="summary-sig-name">transform</a>(<span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">R</span>,
        <span class="summary-sig-arg">t</span>,
        <span class="summary-sig-arg">s</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">invert</span>=<span class="summary-sig-default">False</span>)</span><br />
      Transform <code>Y</code> by rotation <code>R</code> and translation 
      <code>t</code>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#transform">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#wfit" class="summary-sig-name">wfit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">w</span>)</span><br />
      Return the translation vector and the rotation matrix minimizing the 
      weighted RMSD between two sets of d-dimensional vectors, i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#wfit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#wrmsd" class="summary-sig-name">wrmsd</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">w</span>)</span><br />
      Calculate the weighted root mean squared deviation (wRMSD) using 
      Kabsch' formula.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#wrmsd">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="csb.bio.utils-module.html#xfit" class="summary-sig-name">xfit</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>,
        <span class="summary-sig-arg">n_iter</span>=<span class="summary-sig-default">10</span>,
        <span class="summary-sig-arg">seed</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">full_output</span>=<span class="summary-sig-default">False</span>)</span><br />
      Maximum likelihood superposition of two coordinate arrays.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="csb.bio.utils-pysrc.html#xfit">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="average_structure"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">average_structure</span>(<span class="sig-arg">X</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#average_structure">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate an average structure from an ensemble of structures (i.e. X 
  is a rank-3 tensor: X[i] is a (N,3) configuration matrix).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - m x n x 3 input vector</li>
    </ul></dd>
    <dt>Returns: (n,3) numpy.array</dt>
        <dd>average structure</dd>
  </dl>
</td></tr></table>
</div>
<a name="bfit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">bfit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">n_iter</span>=<span class="sig-default">10</span>,
        <span class="sig-arg">distribution</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">student</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">em</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">full_output</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#bfit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Robust superposition of two coordinate arrays. Models non-rigid 
  displacements with outlier-tolerant probability distributions.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy.array) - (n, 3) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy.array) - (n, 3) input vector</li>
        <li><strong class="pname"><code>n_iter</code></strong> (int) - number of iterations</li>
        <li><strong class="pname"><code>distribution</code></strong> (str) - student or k</li>
        <li><strong class="pname"><code>em</code></strong> (bool) - use maximum a posteriori probability (MAP) estimator</li>
        <li><strong class="pname"><code>full_output</code></strong> (bool) - if true, return ((R, t), scales)</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
  </dl>
</td></tr></table>
</div>
<a name="center_of_mass"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">center_of_mass</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">m</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#center_of_mass">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the mean of a set of (optionally weighted) points.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy.array) - array of rank (n,d) where n is the number of points and d the 
          dimension</li>
        <li><strong class="pname"><code>m</code></strong> (numpy.array) - rank (n,) array of masses / weights</li>
    </ul></dd>
    <dt>Returns: (d,) numpy.array</dt>
        <dd>center of mass</dd>
  </dl>
</td></tr></table>
</div>
<a name="deg"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">deg</span>(<span class="sig-arg">x</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#deg">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Convert an array of torsion angles in radians to torsion degrees 
  ranging from -180 to 180.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy array) - array of angles</li>
    </ul></dd>
    <dt>Returns: numpy array</dt>
  </dl>
</td></tr></table>
</div>
<a name="distance"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">distance</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#distance">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Distance between <code>X</code> and <code>Y</code> along the last 
  axis.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - m x n input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - m x n input vector</li>
    </ul></dd>
    <dt>Returns: (m,) numpy.array</dt>
        <dd>scalar or array of length m</dd>
  </dl>
</td></tr></table>
</div>
<a name="distance_matrix"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">distance_matrix</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#distance_matrix">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculates a matrix of pairwise distances</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - m x n input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - k x n input vector or None, which defaults to Y=X</li>
    </ul></dd>
    <dt>Returns: numpy array</dt>
        <dd>m x k distance matrix</dd>
  </dl>
</td></tr></table>
</div>
<a name="distance_sq"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">distance_sq</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#distance_sq">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Squared distance between <code>X</code> and <code>Y</code> along the 
  last axis. For details, see <a href="csb.bio.utils-module.html#distance" 
  class="link">distance</a>.</p>
  <dl class="fields">
    <dt>Returns: (m,) numpy.array</dt>
        <dd>scalar or array of length m</dd>
  </dl>
</td></tr></table>
</div>
<a name="find_pairs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_pairs</span>(<span class="sig-arg">cutoff</span>,
        <span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#find_pairs">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Find pairs with euclidean distance below <code>cutoff</code>. Either 
  between <code>X</code> and <code>Y</code>, or within <code>X</code> if 
  <code>Y</code> is <code>None</code>.</p>
  <p>Uses a KDTree and thus is memory efficient and reasonable fast.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>Y</code></strong> ((k,n) numpy.array)</li>
        <li><strong class="pname"><code>cutoff</code></strong> (float)</li>
        <li><strong class="pname"><code>X</code></strong> ((m,n) numpy.array)</li>
    </ul></dd>
    <dt>Returns: iterable</dt>
        <dd>set of index tuples</dd>
  </dl>
</td></tr></table>
</div>
<a name="fit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">fit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#fit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the translation vector and the rotation matrix minimizing the 
  RMSD between two sets of d-dimensional vectors, i.e. if</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>R,t = fit(X,Y)</pre>
  <p>then</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>Y = dot(Y, transpose(R)) + t</pre>
  <p>will be the fitted configuration.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
        <dd>(d, d) rotation matrix and (d,) translation vector</dd>
  </dl>
</td></tr></table>
</div>
<a name="fit_transform"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">fit_transform</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">fit</span>=<span class="sig-default">&lt;function fit at 0x02E03FB0&gt;</span>,
        <span class="sig-arg">*args</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#fit_transform">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return Y superposed on X.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>Y</code></strong> ((n,3) numpy.array)</li>
        <li><strong class="pname"><code>X</code></strong> ((n,3) numpy.array)</li>
        <li><strong class="pname"><code>fit</code></strong> (function)</li>
    </ul></dd>
    <dt>Returns: (n,3) numpy.array</dt>
  </dl>
</td></tr></table>
</div>
<a name="fit_wellordered"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">fit_wellordered</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">n_iter</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">n_stdv</span>=<span class="sig-default">2</span>,
        <span class="sig-arg">tol_rmsd</span>=<span class="sig-default">0.5</span>,
        <span class="sig-arg">tol_stdv</span>=<span class="sig-default">0.05</span>,
        <span class="sig-arg">full_output</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#fit_wellordered">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Match two arrays onto each other by iteratively throwing out highly 
  deviating entries.</p>
  <p>(Reference: Nilges et al.: Delineating well-ordered regions in protein
  structure ensembles).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>n_stdv</code></strong> - number of standard deviations above which points are considered 
          to be outliers</li>
        <li><strong class="pname"><code>tol_rmsd</code></strong> - tolerance in rmsd</li>
        <li><strong class="pname"><code>tol_stdv</code></strong> - tolerance in standard deviations</li>
        <li><strong class="pname"><code>full_output</code></strong> - also return full history of values calculated by the algorithm</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
  </dl>
</td></tr></table>
</div>
<a name="inertia_tensor"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">inertia_tensor</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">m</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#inertia_tensor">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the inertia tensor of a set of (optionally weighted) 
  points.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy.array) - array of rank (n,d) where n is the number of points and d the 
          dimension</li>
        <li><strong class="pname"><code>m</code></strong> (numpy.array) - rank (n,) array of masses / weights</li>
    </ul></dd>
    <dt>Returns: (d,d) numpy.array</dt>
        <dd>inertia tensor</dd>
  </dl>
</td></tr></table>
</div>
<a name="is_mirror_image"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">is_mirror_image</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#is_mirror_image">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check if two configurations X and Y are mirror images (i.e. their 
  optimal superposition involves a reflection).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - n x 3 input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - n x 3 input vector</li>
    </ul></dd>
    <dt>Returns: bool</dt>
  </dl>
</td></tr></table>
</div>
<a name="probabilistic_fit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">probabilistic_fit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">w</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">niter</span>=<span class="sig-default">10</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#probabilistic_fit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Generate a superposition of X, Y where:</p>
<pre class="literalblock">
   R ~ exp(trace(dot(transpose(dot(transpose(X-t), Y)), R)))
   t ~ N(t_opt, 1 / sqrt(N))
</pre>
  <dl class="fields">
    <dt>Returns: tuple</dt>
  </dl>
</td></tr></table>
</div>
<a name="rad"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">rad</span>(<span class="sig-arg">x</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#rad">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Convert an array of torsion angles in torsion degrees to radians.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy array) - array of angles</li>
    </ul></dd>
    <dt>Returns: numpy array</dt>
  </dl>
</td></tr></table>
</div>
<a name="radius_of_gyration"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">radius_of_gyration</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">m</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#radius_of_gyration">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the radius of gyration of a set of (optionally weighted) 
  points.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy.array) - array of rank (n,d) where n is the number of points and d the 
          dimension</li>
        <li><strong class="pname"><code>m</code></strong> (numpy.array) - rank (n,) array of masses / weights</li>
    </ul></dd>
    <dt>Returns: (d,) numpy.array</dt>
        <dd>center of mass</dd>
  </dl>
</td></tr></table>
</div>
<a name="rmsd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">rmsd</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#rmsd">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the root mean squared deviation (RMSD) using Kabsch' 
  formula.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>rmsd value between the input vectors</dd>
  </dl>
</td></tr></table>
</div>
<a name="rmsd_cur"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">rmsd_cur</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#rmsd_cur">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the RMSD of two conformations as they are (no fitting is 
  done). For details, see <a href="csb.bio.utils-module.html#rmsd" 
  class="link">rmsd</a>.</p>
  <dl class="fields">
    <dt>Returns: float</dt>
        <dd>rmsd value between the input vectors</dd>
  </dl>
</td></tr></table>
</div>
<a name="scale_and_fit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">scale_and_fit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">check_mirror_image</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#scale_and_fit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the translation vector, the rotation matrix and a global 
  scaling factor minimizing the RMSD between two sets of d-dimensional 
  vectors, i.e. if</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>R, t, s = scale_and_fit(X, Y)</pre>
  <p>then</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>Y = s * (dot(Y, R.T) + t)</pre>
  <p>will be the fitted configuration.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
        <dd>(d, d) rotation matrix and (d,) translation vector</dd>
  </dl>
</td></tr></table>
</div>
<a name="second_moments"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">second_moments</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">m</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#second_moments">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the tensor second moments of a set of (optionally weighted) 
  points.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy.array) - array of rank (n,d) where n is the number of points and d the 
          dimension</li>
        <li><strong class="pname"><code>m</code></strong> (numpy.array) - rank (n,) array of masses / weights</li>
    </ul></dd>
    <dt>Returns: (d,d) numpy.array</dt>
        <dd>second moments</dd>
  </dl>
</td></tr></table>
</div>
<a name="tm_score"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">tm_score</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">y</span>,
        <span class="sig-arg">L</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">d0</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#tm_score">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Evaluate the TM-score of two conformations as they are (no fitting is 
  done).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy array) - 3 x n input array</li>
        <li><strong class="pname"><code>y</code></strong> (numpy array) - 3 x n input array</li>
        <li><strong class="pname"><code>L</code></strong> (int) - length for normalization (default: <code>len(x)</code>)</li>
        <li><strong class="pname"><code>d0</code></strong> (float) - d0 in Angstroms (default: calculate from <code>L</code>)</li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>computed TM-score</dd>
  </dl>
</td></tr></table>
</div>
<a name="tm_superimpose"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">tm_superimpose</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">y</span>,
        <span class="sig-arg">fit_method</span>=<span class="sig-default">&lt;function fit at 0x02E03FB0&gt;</span>,
        <span class="sig-arg">L</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">d0</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">L_ini_min</span>=<span class="sig-default">4</span>,
        <span class="sig-arg">iL_step</span>=<span class="sig-default">1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#tm_superimpose">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the TM-score of two protein coordinate vector sets. Reference:
  http://zhanglab.ccmb.med.umich.edu/TM-score</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (numpy.array) - 3 x n input vector</li>
        <li><strong class="pname"><code>y</code></strong> (numpy.array) - 3 x n  input vector</li>
        <li><strong class="pname"><code>fit_method</code></strong> (function) - a reference to a proper fitting function, e.g. fit or 
          fit_wellordered</li>
        <li><strong class="pname"><code>L</code></strong> (int) - length for normalization (default: <code>len(x)</code>)</li>
        <li><strong class="pname"><code>d0</code></strong> (float) - d0 in Angstroms (default: calculate from <code>L</code>)</li>
        <li><strong class="pname"><code>L_ini_min</code></strong> (int) - minimum length of initial alignment window (increase to speed up 
          but loose precision, a value of 0 disables local alignment 
          initialization)</li>
        <li><strong class="pname"><code>iL_step</code></strong> (int) - initial alignment window shift (increase to speed up but loose 
          precision)</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
        <dd>rotation matrix, translation vector, TM-score</dd>
  </dl>
</td></tr></table>
</div>
<a name="torsion_rmsd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">torsion_rmsd</span>(<span class="sig-arg">x</span>,
        <span class="sig-arg">y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#torsion_rmsd">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the circular RMSD of two phi/psi angle sets.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>x</code></strong> (array) - query phi/psi angles (Nx2 array, in radians)</li>
        <li><strong class="pname"><code>y</code></strong> (array) - subject phi/psi angles (Nx2 array, in radians)</li>
    </ul></dd>
    <dt>Returns: float</dt>
  </dl>
</td></tr></table>
</div>
<a name="transform"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">transform</span>(<span class="sig-arg">Y</span>,
        <span class="sig-arg">R</span>,
        <span class="sig-arg">t</span>,
        <span class="sig-arg">s</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">invert</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#transform">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Transform <code>Y</code> by rotation <code>R</code> and translation 
  <code>t</code>. Optionally scale by <code>s</code>.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>R, t = fit(X, Y)
<span class="py-prompt">&gt;&gt;&gt; </span>Y_fitted = transform(Y, R, t)</pre>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>Y</code></strong> (numpy.array) - (n, d) input vector</li>
        <li><strong class="pname"><code>R</code></strong> (numpy.array) - (d, d) rotation matrix</li>
        <li><strong class="pname"><code>t</code></strong> (numpy.array) - (d,) translation vector</li>
        <li><strong class="pname"><code>s</code></strong> (float) - scaling factor</li>
        <li><strong class="pname"><code>invert</code></strong> (bool) - if True, apply the inverse transformation</li>
    </ul></dd>
    <dt>Returns: numpy.array</dt>
        <dd>transformed input vector</dd>
  </dl>
</td></tr></table>
</div>
<a name="wfit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">wfit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">w</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#wfit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the translation vector and the rotation matrix minimizing the 
  weighted RMSD between two sets of d-dimensional vectors, i.e. if</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>R,t = fit(X,Y)</pre>
  <p>then</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>Y = dot(Y, transpose(R)) + t</pre>
  <p>will be the fitted configuration.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>w</code></strong> (numpy array) - input weights</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
        <dd>(d, d) rotation matrix and (d,) translation vector</dd>
  </dl>
</td></tr></table>
</div>
<a name="wrmsd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">wrmsd</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">w</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#wrmsd">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the weighted root mean squared deviation (wRMSD) using 
  Kabsch' formula.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy array) - (n, d) input vector</li>
        <li><strong class="pname"><code>w</code></strong> (numpy array) - input weights</li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>rmsd value between the input vectors</dd>
  </dl>
</td></tr></table>
</div>
<a name="xfit"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">xfit</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>,
        <span class="sig-arg">n_iter</span>=<span class="sig-default">10</span>,
        <span class="sig-arg">seed</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">full_output</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="csb.bio.utils-pysrc.html#xfit">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Maximum likelihood superposition of two coordinate arrays. Works 
  similar to <a href="http://theseus3d.org" target="_top">Theseus</a> and 
  to <a href="csb.bio.utils-module.html#bfit" class="link">bfit</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>X</code></strong> (numpy.array) - (n, 3) input vector</li>
        <li><strong class="pname"><code>Y</code></strong> (numpy.array) - (n, 3) input vector</li>
        <li><strong class="pname"><code>n_iter</code></strong> (int) - number of EM iterations</li>
        <li><strong class="pname"><code>full_output</code></strong> (bool) - if true, return ((R, t), scales)</li>
        <li><strong class="pname"><code>seed</code></strong> (bool)</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="csb-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >CSB v1.2.2.614</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Dec 27 22:25:17 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
