<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="content-type">
<title>XSQ report</title>
<script src="http://mbostock.github.com/d3/d3.v2.js?2.8.0" type="text/javascript">
</script>
<script type="text/javascript">
var basequal_max = {{ basequal_max }};
</script>
<script type="text/javascript" src="readqual.js">
</script>

<style>
  html {
    background-color: #d0d0d0;
  }
  body {
    padding: 0px;
    margin: 0px;
  }
  div#main {
    margin-left: 20px;
    margin-right: 2em;
    padding-left: 3em;
    padding-right: 3em;
    padding-top: 1em;
    padding-bottom: 2em;
    background-color: #fff;
  }

  div#header {
    font-size: 200%;
    background-color: 606060;
    color: #f0f0f0;
    width: 100%;
    padding-bottom: .5em;
    padding-top: .5em;
    padding-left: 40px;
    box-shadow:10px 10px 20px #000000;
    //margin-left: 1em;
  }

  .chart rect {
   fill: steelblue;
   stroke: white;
  }

  .chart line.p90 {
   stroke: steelblue;
  }

  table {
    border: solid 1px #ababab;
    padding; 1em;
  }

  table tr.odd {
    background-color: #ebebeb;
  }

  ul.lean li {
    list-style: none;
  }
  ul.lean li.odd {
    background-color: #ebebeb;
  }
  .rule {
    font-size: 70%;
  }
</style>

</head>
<body>

<div id="header">File: {{ filename }}</div>

<div id="main">
<h2>XSQ Info</h2>
<table class="xsqinfo">
<tbody>
{% for field, value in xsqinfo %}
<tr class="{{ loop.cycle('odd', 'even') }}">
<td>{{ field }}:</td>
<td><i>{{ value }} </i></td>
</tr>
{% endfor %}
</tbody>
</table>
<p>
<i>Missing</i> can occur with older XSQ files, or XSQ files generated outside of the software running a SOLiD.
</p>
<h2>File content</h2>
<ul class="lean">
{% for lib in libs %}
<li class="{{ loop.cycle('odd', 'even') }}"><a href="#lib_{{ lib.lib_i}}">{{ lib.name }}</a></li>
{% endfor %}
</ul>

<h2>Libraries</h2>
{% for lib in libs %}
<h3><a name="lib_{{ lib.lib_i }}">Library: "{{ lib.name }}"</a></h3>

<h4>Sequencing data</h4>
<table>
<tbody>
<tr class="even"><td>Number of reads</td><td>{{ '{:,}'.format(lib.readcount) }}</td></tr>
<tr class="odd"><td>Fragments per read</td><td>{% for frg in lib.fragments %} {{frg.name}}, {% endfor %}</td><tr>
</tbody>
</table>
<h4>Read quality (sampling {{ sample_percent * 100 }}&#37; of the data)</h4>
{% for frg in lib.fragments %}
<h5>{{ frg.name }}</h5>
<div id="qualityplot_{{ frg.name }}_{{ lib.lib_i }}">

{% if data_type == 'csv' %}
<script type="text/javascript">
csv_fn = "{{ frg.data_fn }}";
d3.csv(csv_fn, function(data) { qualityplot(data, "{{ frg.name }}_{{ lib.lib_i }}") });
</script>
{% else %}
<script type="text/javascript" src="{{ frg.data_fn }}">
</script>
<script type="text/javascript">
f = function(data) { qualityplot(data, "{{ frg.name }}_{{ lib.lib_i }}") };
f(dataf_{{ lib.lib_i }}_{{ frg.varname }})
</script>
</div>
{% endif %}
{% endfor %} <!-- fragment -->
{% endfor %} <!-- libs -->

</div>

</body>
</html>
