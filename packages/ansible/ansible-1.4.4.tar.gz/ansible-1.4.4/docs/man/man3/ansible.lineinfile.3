.TH ANSIBLE.LINEINFILE 3 "2014-01-08" "1.4.4" "ANSIBLE MODULES"
.\" generated from library/files/lineinfile
.SH NAME
lineinfile \- Ensure a particular line is in a file, or replace an existing line using a back-referenced regular expression.
.\" ------ DESCRIPTION
.SH DESCRIPTION
.PP
This module will search a file for a line, and ensure that it is present or absent. 
.PP
This is primarily useful when you want to change a single line in a file only. For other cases, see the \fIcopy\fR or \fItemplate\fR modules. 
.\" ------ OPTIONS
.\"
.\"
.SH OPTIONS
   
.IP backrefs
Used with \fCstate=present\fR. If set, line can contain backreferences (both positional and named) that will get populated if the regexp matches. This flag changes the operation of the module slightly; insertbefore and insertafter will be ignored, and if the regexp doesn't match anywhere in the file, the file will be left unchanged. If the regexp does match, the last matching line will be replaced by the expanded line parameter.
.IR Choices :
yes,no. (default: no)(Added in Ansible version 1.1.)
   
.IP backup
Create a backup file including the timestamp information so you can get the original file back if you somehow clobbered it incorrectly.
.IR Choices :
yes,no. (default: no)   
.IP create
Used with \fCstate=present\fR. If specified, the file will be created if it does not already exist. By default it will fail if the file is missing.
.IR Choices :
yes,no. (default: no)   
.IP dest
The file to modify.(required)   
.IP insertafter
Used with \fCstate=present\fR. If specified, the line will be inserted after the specified regular expression. A special value is available; \fCEOF\fR for inserting the line at the end of the file. May not be used with backrefs.
.IR Choices :
EOF,*regex*. (default: EOF)   
.IP insertbefore
Used with \fCstate=present\fR. If specified, the line will be inserted before the specified regular expression. A value is available; \fCBOF\fR for inserting the line at the beginning of the file. May not be used with backrefs.
.IR Choices :
BOF,*regex*.(Added in Ansible version 1.1.)
   
.IP line
Required for \fCstate=present\fR. The line to insert/replace into the file. If backrefs is set, may contain backreferences that will get expanded with the regexp capture groups if the regexp matches. The backreferences should be double escaped (see examples).   
.IP others
All arguments accepted by the \fIfile\fR module also work here.   
.IP regexp
The regular expression to look for in every line of the file. For \fCstate=present\fR, the pattern to replace if found; only the last line found will be replaced. For \fCstate=absent\fR, the pattern of the line to remove.  Uses Python regular expressions; see \fIhttp://docs.python.org/2/library/re.html\fR.   
.IP state
Whether the line should be there or not.
.IR Choices :
present,absent. (default: present)   
.IP validate
validation to run before copying into place (default: None)(Added in Ansible version 1.4.)
.\"
.\"
.\" ------ NOTES
.\"
.\"
.\" ------ EXAMPLES
.\" ------ PLAINEXAMPLES
.SH EXAMPLES
.nf
- lineinfile: dest=/etc/selinux/config regexp=^SELINUX= line=SELINUX=disabled

- lineinfile: dest=/etc/sudoers state=absent regexp="^%wheel"

- lineinfile: dest=/etc/hosts regexp='^127\.0\.0\.1' line='127.0.0.1 localhost' owner=root group=root mode=0644

- lineinfile: dest=/etc/httpd/conf/httpd.conf regexp="^Listen " insertafter="^#Listen " line="Listen 8080"

- lineinfile: dest=/etc/services regexp="^# port for http" insertbefore="^www.*80/tcp" line="# port for http by default"

# Add a line to a file if it does not exist, without passing regexp
- lineinfile: dest=/tmp/testfile line="192.168.1.99 foo.lab.net foo"

# Fully quoted because of the ': ' on the line. See the Gotchas in the YAML docs.
- lineinfile: "dest=/etc/sudoers state=present regexp='^%wheel' line='%wheel ALL=(ALL) NOPASSWD: ALL'"

- lineinfile: dest=/opt/jboss-as/bin/standalone.conf regexp='^(.*)Xms(\d+)m(.*)$' line='\1Xms${xms}m\3' backrefs=yes

# Validate a the sudoers file before saving
- lineinfile: dest=/etc/sudoers state=present regexp='^%ADMIN ALL\=' line='%ADMIN ALL=(ALL) NOPASSWD:ALL' validate='visudo -cf %s'

.fi

.\" ------- AUTHOR
.SH AUTHOR
Daniel Hokka Zakrisson
.SH SEE ALSO
.IR ansible (1),
.I http://ansible.github.com/modules.html#lineinfile