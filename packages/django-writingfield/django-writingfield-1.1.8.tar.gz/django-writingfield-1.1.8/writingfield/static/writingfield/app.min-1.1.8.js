window.Mousetrap=function(){function a(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function b(a){return"keypress"==a.type?String.fromCharCode(a.which):l[a.which]?l[a.which]:m[a.which]?m[a.which]:String.fromCharCode(a.which).toLowerCase()}function c(a){var b,a=a||{},c=!1;for(b in r)a[b]?c=!0:r[b]=0;c||(t=!1)}function d(a,b,c,d,e){var f,h,i=[];if(!p[a])return[];for("keyup"==c&&g(a)&&(b=[a]),f=0;f<p[a].length;++f)h=p[a][f],h.seq&&r[h.seq]!=h.level||c!=h.action||"keypress"!=c&&b.sort().join(",")!==h.modifiers.sort().join(",")||(d&&h.combo==e&&p[a].splice(f,1),i.push(h));return i}function e(a,b){!1===a(b)&&(b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.returnValue=!1,b.cancelBubble=!0)}function f(a){a.which="number"==typeof a.which?a.which:a.keyCode;var f=b(a);if(f)if("keyup"==a.type&&s==f)s=!1;else{var h=a.target||a.srcElement,i=h.tagName;if(!(-1<(" "+h.className+" ").indexOf(" mousetrap ")?0:"INPUT"==i||"SELECT"==i||"TEXTAREA"==i||h.contentEditable&&"true"==h.contentEditable)){h=[],a.shiftKey&&h.push("shift"),a.altKey&&h.push("alt"),a.ctrlKey&&h.push("ctrl"),a.metaKey&&h.push("meta");for(var h=d(f,h,a.type),j={},k=!1,i=0;i<h.length;++i)h[i].seq?(k=!0,j[h[i].seq]=1,e(h[i].callback,a)):!k&&!t&&e(h[i].callback,a);a.type==t&&!g(f)&&c(j)}}}function g(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function h(a,b,c){if(!c){if(!j){j={};for(var d in l)d>95&&112>d||l.hasOwnProperty(d)&&(j[l[d]]=d)}c=j[a]?"keydown":"keypress"}return"keypress"==c&&b.length&&(c="keydown"),c}function i(a,f,j,l,m){var q,u,a=a.replace(/\s+/g," "),v=a.split(" "),w=[];if(1<v.length){var x=a,y=j;for(r[x]=0,y||(y=h(v[0],[])),a=function(){t=y,++r[x],clearTimeout(k),k=setTimeout(c,1e3)},j=function(a){e(f,a),"keyup"!==y&&(s=b(a)),setTimeout(c,10)},l=0;l<v.length;++l)i(v[l],l<v.length-1?a:j,y,x,l)}else{for(u="+"===a?["+"]:a.split("+"),v=0;v<u.length;++v)q=u[v],o[q]&&(q=o[q]),j&&"keypress"!=j&&n[q]&&(q=n[q],w.push("shift")),g(q)&&w.push(q);j=h(q,w,j),p[q]||(p[q]=[]),d(q,w,j,!l,a),p[q][l?"unshift":"push"]({callback:f,modifiers:w,action:j,seq:l,level:m,combo:a})}}for(var j,k,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},m={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta","return":"enter",escape:"esc"},p={},q={},r={},s=!1,t=!1,u=1;20>u;++u)l[111+u]="f"+u;for(u=0;9>=u;++u)l[u+96]=u;return a(document,"keypress",f),a(document,"keydown",f),a(document,"keyup",f),{bind:function(a,b,c){for(var d=a instanceof Array?a:[a],e=0;e<d.length;++e)i(d[e],b,c);q[a+":"+c]=b},unbind:function(a,b){q[a+":"+b]&&(delete q[a+":"+b],this.bind(a,function(){},b))},trigger:function(a,b){q[a+":"+b]()},reset:function(){p={},q={}}}}(),function(a,b,c){"use strict";function d(a){self=this,self.$element=c(a),self.init()}d.prototype.init=function(){self.icon=c("<a>",{"class":"fullscreen"}),self.icon.click(self.dispatch),self.$element.before(self.icon),this.$element.parent().addClass("fullscreen-container"),Mousetrap.bind("esc",self._deactivate),Mousetrap.bind(["meta+s","ctrl+s"],self._save),self.$element.addClass("mousetrap"),self.$element.keydown(function(a){if(9===a.keyCode){var b=this.selectionStart,d=this.selectionEnd,e=c(this);return e.val(e.val().substring(0,b)+"	"+e.val().substring(d)),this.selectionStart=this.selectionEnd=b+1,!1}}),this.loading=c("<div>").addClass("loading").hide().text("Saving…"),c("body").append(this.loading)},d.prototype._save=function(b){var d=c("#content-main form"),e=d.serialize();c("div.selector-chosen option").each(function(){c(this).attr("selected","selected")}),0===d.length&&(d=c("#grp-content-container form"),0===d.length&&console.log("Sorry, could not find any FORM to serialize. What Django Admin customization are you using?")),c.ajax({type:"POST",url:a.location.href,headers:{"X-FROM-WRITINGFIELD":"True"},data:e,beforeSend:function(){self.loading.text("Saving…").removeClass("saved").removeClass("error").fadeIn(100)},success:function(){self.loading.addClass("saved").text("Saved."),setTimeout(function(){self.loading.fadeOut(500)},1e3)},error:function(a){0===a.readyState||0===a.status?(console.log(a),self.loading.addClass("saved").text("Saved."),setTimeout(function(){self.loading.fadeOut(500)},1e3)):(self.loading.addClass("error").text("Error, couldn't save form"),setTimeout(function(){self.loading.fadeOut(500)},2e3))}}),b.preventDefault()},d.prototype._activate=function(a){a.parent().addClass("active")},d.prototype._deactivate=function(){c("div.fullscreen-container.active").removeClass("active")},d.prototype.dispatch=function(){var a=c(this).next();a.parent().hasClass("active")?self._deactivate(a):self._activate(a)},c.fn.djwf=function(a){this.each(function(){return new d(this,a)})}}(window,document,django.jQuery),django.jQuery(function(a){a("textarea.fullscreen").djwf()});