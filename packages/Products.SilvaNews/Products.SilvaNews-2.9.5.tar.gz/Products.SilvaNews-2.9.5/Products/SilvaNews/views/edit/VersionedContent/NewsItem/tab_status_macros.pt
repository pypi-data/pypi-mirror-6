<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva_news">

<tal:toc replace="nothing">
_______ Macros in this file _______
datetime_info........notice of previous version times
messages.............author/editor messages
request_approval.....Author requests approval
approved_editor......Editor can change settings
        Subtables
editor_approves......Editor approves
withdraw_request_approval Author/Editor withdraws/rejects request for approval
revoke_approval......Revoke approval
revert_to_previous...Revert to previous
manual_close.........Manual close
</tal:toc>

<span tal:replace="nothing"> _______ Notice of previous version times _______ </span>
<metal:block define-macro="datetime_info"
  tal:define="
    start_time python: mangle.DateTime(model.get_public_version_publication_datetime()).toStr();
    end_time python: mangle.DateTime(model.get_public_version_expiration_datetime()).toStr()"
  tal:condition="start_time"
  >
  <br />
  <p style="margin-top:0.3em; margin-bottom:0.2em;">
<span class="subhead"
  tal:condition="not:end_time"
  i18n:translate="">
Publication time of public version
</span>
<span class="subhead"
  tal:condition="end_time"
  i18n:translate="">
Publication and expiration time of public version
</span>
<br />
<tal:block replace="structure python: '%s%s' % (start_time, test(end_time, ' - %s' % end_time, ''))" />
</p>
  <p style="margin-top:0.3em; margin-bottom:0.2em;"
    tal:condition="exists: python: model.get_viewable().display_datetime()">
    <span class="subhead">
      Display time of public version<br />
    </span>
    <tal:plug tal:define="display_time python:mangle.DateTime(model.get_viewable().display_datetime()).toStr();"
      tal:replace="display_time" />
  </p>
</metal:block>

<span tal:replace="nothing"> _______ Author/Editor messages _______ </span>
<div tal:omit-tag=""
  tal:condition="python:model.get_approval_request_message()"
  metal:define-macro="messages">
<tr class="inter-controls">
<td colspan="2">
<h3 i18n:translate="">
messages
</h3>
</td>
</tr>

<tr class="even">
<td class="feedback"
  colspan="2"
  i18n:translate="">
<span tal:replace="python:model.get_approval_requester()" i18n:name="author_id">author id</span>
sent a message on 
<span tal:replace="structure python:mangle.DateTime(model.get_approval_request_datetime()).toStr()"
  i18n:name="some_date">some date</span>
<tal:if condition="python:model.get_approval_request_message()"
  i18n:name="with_comments">
<tal:inline i18n:translate="">with the following comments:</tal:inline>
</tal:if>
</td>
</tr>

<tr class="controls"
  tal:condition="python:model.get_approval_request_message()">
<td class="message"
  colspan="2"
  style="padding:0">
<div class="message"
  tal:content="python:model.get_approval_request_message() or 'whatever'">
  message text
</div>
</td>
</tr>
</div>


<span tal:replace="nothing"> _______ Author requests approval _______ </span>
<div metal:define-macro="request_approval" tal:omit-tag="">
<form action="." method="post">
<tr tal:condition="python:model.get_approval_request_message()">
<td class="feedback"
 colspan="2" i18n:translate="">
A previous request for approval has been rejected / withdrawn by 
<span tal:replace="python:model.get_approval_requester()" i18n:name="requester" /> on 
<span tal:replace="structure python:mangle.DateTime(model.get_approval_request_datetime()).toStr()" i18n:name="some_date">some date</span>.
<tal:comment condition="nothing"> actually the last message may not have been written
  by the person withdrawing the request; if this person for example made an empty reject,
  this is the message of the requester ...
</tal:comment>
The last message regarding this issue is:
</td>
</tr>

<tr class="even"
  tal:define="message python:model.get_approval_request_message()"
  tal:condition="message">
<td class="message"
  colspan="2">
<div class="message"
  tal:content="message">
  message text
</div>
</td>
</tr>

<tr class="inter-controls">
<td colspan="2">
<h3 i18n:translate="">request approval <span tal:condition="python:may_change_content and unapproved and published" i18n:name="for_new_version"><tal:block i18n:translate="">for new version</tal:block></span></h3>
</td>
</tr>

<tr>
<th i18n:translate="">
message to editor
</th>
<th style="width:40%" i18n:translate="">
notes
</th>
</tr>

<tr class="odd"
  tal:define="field context/tab_status_form_author/message">
<td class="align-right">
<tal:input
  replace="structure python: field.render(REQUEST=request)" />
</td>
<td i18n:translate="">
This message will remain visible in the status screen for other authors and editors.
</td>
</tr>

<tr metal:use-macro="here/tab_status_macros/macros/date_controls">
  pub/exp/display controls inserted (see below, @ line 241)
</tr>

<tr class="controls">
<td class="align-right" colspan="2">
<input 
  type="submit"
  value="request approval"
  class="button"
  name="tab_status_request:method"
  title="access key: alt-r"
  accesskey="r"
  i18n:attributes="value;title"
/>
</td>
</tr>
</form>
</div>
<span tal:replace="nothing"> _______ / Author requests approval _______ </span>


<span tal:replace="nothing"> _______ Editor can change settings _______ </span>
<div metal:define-macro="approved_editor" tal:omit-tag="">
<form action="." method="post">
<tr class="inter-controls">
<td colspan="2">
<h3 i18n:translate="">
change settings
</h3>
</td>
</tr>

<tr>
<th class="align-right" i18n:translate="">
current timings
</th>
<th i18n:translate="">
notes
</th>
</tr>

<tr metal:use-macro="here/tab_status_macros/macros/date_controls">
  pub/exp/display controls inserted (see below, @ line 241)
</tr>

<tr class="inter-controls">
<td class="align-right"
  colspan="2">
<input type="submit" 
  value="update timing"
  name="tab_status_change_settings:method"
  class="button"
  title="access key: alt-u"
  accesskey="u"
  i18n:attributes="value;title"
/>
</td>
</tr>
</form>
</div>
<span tal:replace="nothing"> _______ / Editor can change settings _______ </span>


<span tal:replace="nothing"> ______________ Subtables ______________ </span>

<span tal:replace="nothing"> _______ Editor approves _______ </span>
<div tal:omit-tag=""
  metal:define-macro="approve_new">
<form action="tab_status_approve" method="post">
<table class="listing sublisting">
<tr class="inter-controls">
<td colspan="2">
<h3>
<span tal:condition="python:not closed or (unapproved and (closed or published))"
  i18n:translate="">
publish new version
</span>
<span tal:condition="python: closed and not unapproved"
  i18n:translate="">
publish closed version
</span>
</h3>
</td>
</tr>

<tr>
<th class="align-right" i18n:translate="">
settings
</th>
<th style="width:40%" i18n:translate="">
notes
</th>
</tr>

<metal:block use-macro="context/NewsItem/tab_status_macros/macros/date_controls" />

<tr class="inter-controls">
<td class="align-right"
  colspan="2">
<input class="button executor"
  style="float:right"
  name="tab_status_open_now:method"
  type="submit"
  value="publish now"
  title="access key: alt-p"
  accesskey="p"
  i18n:attributes="value;title"
/>
<input class="button"
  style="float:right"
  type="submit"
  name="tab_status_approve:method"
  value="approve for future"
  title="access key: alt-o"
  accesskey="o"
  i18n:attributes="value;title"
/>
</td>
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Editor approves _______ </span>


<metal:def define-macro="date_controls"> 
<tr class="even"
  style="vertical-align:middle"
  tal:define="field context/tab_status_form_editor/publish_datetime">
<td class="align-right" style="white-space: nowrap;">
<label title="access key: alt-m"
  accesskey="m"
  tal:content="field/title"
  tal:attributes="for field/id"
  i18n:attributes="title">
content publish time
</label>
<input tal:replace="structure python: field.render(REQUEST=request)" />
</td>
<td i18n:translate="">
day / month / year &nbsp;23:59
</td>
</tr>

<tr class="odd"
  tal:define="field context/tab_status_form_editor/expiration_datetime">
<td class="align-right" style="white-space: nowrap;">
<label title="access key: alt-o"
  accesskey="o"
  tal:content="field/title"
  tal:attributes="for field/id"
  i18n:attributes="title">
expiration time
</label>
<input tal:replace="structure python: field.render(REQUEST=request)" />
</td>
<td style="vertical-align:middle"
  tal:content="structure field/description">
  description
</td>
</tr>

<tal:block condition="nothing">__ SilvaNews additional fields __</tal:block>
<tr class="even"
 tal:define="field context/tab_status_form_news/display_datetime">
<td class="align-right">
<label 
  title="access key: alt-h"
  accesskey="h"
  tal:attributes="for field/id"
  tal:content="field/title"
  i18n:attributes="title">
  field title
</label>
<input tal:replace="structure python: field.render(REQUEST=request)" />
</td>
<td tal:content="structure field/description">
  description
</td>
</tr>

<tal:block condition="nothing">__ end SilvaNews additional fields __</tal:block>
</metal:def>


<span tal:replace="nothing"> _______ Author/Editor withdraws/rejects request for approval _______ </span>
<div tal:omit-tag=""
  metal:define-macro="withdraw_request_approval">
<form action="tab_status_withdraw" method="post">
<table class="listing">
<tr class="inter-controls">
<td colspan="2">
<h3>
<tal:block condition="may_approve_content" i18n:translate="">reject</tal:block>
<tal:block condition="not: may_approve_content" i18n:translate="">withdraw</tal:block>
<tal:block i18n:translate="">request</tal:block>
</h3>
</td>
</tr>

<tr>
<input type="hidden" name="rejection_status" tal:attributes="value python:test(may_approve_content, 'true', 'false')" />
<input type="hidden" name="tab_name" value="publish" />
<th>
<tal:block i18n:translate="">
add message on
</tal:block>
<tal:block condition="may_approve_content" i18n:translate="">
rejection
</tal:block>
<tal:block condition="not: may_approve_content" i18n:translate="">
withdrawal
</tal:block>
</th>
<th style="width:40%"
  i18n:translate="">
notes
</th>
</tr>

<tr class="odd">
<td>
<textarea
  class="store"
  name="message"
  cols="65"
  rows="7"
  wrap="soft"></textarea>
</td>
<td width="40%" i18n:translate="">
The message may be viewed by local users.
</td>
</tr>

<tr class="controls">
<td>
&nbsp;
</td>
<td class="align-right">
<input 
  type="submit" 
  class="button"  
  title="access key: alt-j" 
  accesskey="j"
  tal:condition="may_approve_content" 
  value="reject approval request" 
  i18n:attributes="title;value" 
/>
<input 
  type="submit" 
  class="button"  
  title="access key: alt-r" 
  accesskey="r"
  tal:condition="not: may_approve_content" 
  value="withdraw approval request"
  i18n:attributes="title;value" 
/>
</td>
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Author/Editor withdraws/rejects request for  approval _______ </span>


<span tal:replace="nothing"> _______ Revoke approval _______ </span>
<div tal:omit-tag=""
  metal:define-macro="revoke_approval">
<form action="tab_status_revoke" method="post">
<table class="listing sublisting">
<thead>
<tr class="inter-controls">
<td>
<h3 i18n:translate="">
revoke approval
</h3>
</td>
</tr>
</thead>

<tbody>
<tr class="even">
<td i18n:translate="">
If further editing is required, first revoke the approval.
</td>
</tr>
</tbody>

<tfoot>
<tr class="controls">
<td class="align-right">
<input 
  type="submit" 
  value="revoke approval" 
  class="button" 
  title="access key: alt-v"
  accesskey="v" 
  i18n:attributes="value;title" />
</td>
</tr>
</tfoot>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Revoke approval _______ </span>


<span tal:replace="nothing"> _______ Revert to previous _______ </span>
<div tal:omit-tag=""
  metal:define-macro="revert_to_previous">
<form action="tab_status_revert_to_previous" method="post">
<table class="listing">
<tr class="inter-controls">
<td>
<h3 i18n:translate="">
revert to previous version
</h3>
</td>
</tr>
<tr class="even">
<td i18n:translate="">
The current editable version can be replaced with the previous (published)
version. This can not be undone afterwards and will discard all changes
made to the current version.
</td>
</tr>
<tr class="inter-controls">
<td class="align-right">
<input class="button"
  type="submit"
  value="revert to previous"
  title="access key: alt-p"
  accesskey="p"
  onclick="return confirm('Really revert ?')"
  i18n:attributes="value;title"
/>
</td>
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Revert to previous _______ </span>


<span tal:replace="nothing"> _______ Manual close _______ </span>
<div tal:omit-tag=""
  metal:define-macro="manual_close">
<form action="tab_status_close" method="post">
<table class="listing">
<thead>
<tr class="inter-controls">
<td>
<h3 i18n:translate="">manual close</h3> 
</td>
</tr>
</thead>

<tbody>
<tr class="even">
<td i18n:translate="">
If necessary, the published version of this content can be manually closed (taken offline). It will also be removed from the public index.
</td>
</tr>
</tbody>

<tfoot>
<tr class="controls">
<td class="align-right">
<input class="button"
  type="submit"
  value="close published version"
  title="access key: alt-c"
  accesskey="c" 
  i18n:attributes="value;title"
/>
</td>
</tr>
</tfoot>
</table>
</form>
</div>

</html>
