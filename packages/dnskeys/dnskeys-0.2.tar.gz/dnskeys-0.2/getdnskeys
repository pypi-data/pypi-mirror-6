#!/usr/bin/env python

import dnskeys
import sys

def printKey(fingerprint, note, dnssec_valid):
    print ( "V: " if dnssec_valid else "I: " ) + fingerprint + ( ( " # " + note ) if note != None else "" )

def printOtrFingerprints(jid):
    for fingerprint, dnssec_valid in dnskeys.getOtrFingerprints(jid):
        printKey(fingerprint, None, dnssec_valid)

def printOpenPGPFingerprints(uid):
    for fingerprint, uri, dnssec_valid in dnskeys.getOpenPGPFingerprints(uid):
        printKey(fingerprint, uri, dnssec_valid)

def usage():
        print "Usage: %s {otr|openpgp} <jabberID>" % (sys.argv[0],)
        sys.exit(255)

if __name__ == "__main__":
    if len(sys.argv) < 3:
        usage()
    else:
        if sys.argv[1] == "otr":
            printOtrFingerprints(sys.argv[2])
            sys.exit(0)
        if sys.argv[1] == "openpgp":
            printOpenPGPFingerprints(sys.argv[2])
            sys.exit(0)
        usage() # Something wasn't right

