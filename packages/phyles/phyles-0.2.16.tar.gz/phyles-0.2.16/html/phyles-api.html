

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Phyles API &mdash; phyles 0.2.16 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.16',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="phyles 0.2.16 documentation" href="index.html" />
    <link rel="prev" title="2. Tutorial" href="tutorial.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="2. Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">phyles 0.2.16 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="phyles-api">
<h1>3. Phyles API<a class="headerlink" href="#phyles-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="api-overview">
<h2>3.1. API Overview<a class="headerlink" href="#api-overview" title="Permalink to this headline">¶</a></h2>
<p>The phyles API has several functions and classes to
facilitate the construction of medium-sized utilites.
These functions and classes are divided into four categories:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#classes-for-configurations-and-schemata">Classes for Configurations and Schemata</a></li>
<li><a class="reference internal" href="#functions-for-configurations-and-schemata">Functions for Configurations and Schemata</a></li>
<li><a class="reference internal" href="#functions-for-files-and-directories">Functions for Files and Directories</a></li>
<li><a class="reference internal" href="#functions-for-user-interaction">Functions for User Interaction</a></li>
<li><a class="reference internal" href="#functions-for-a-one-size-fits-all-runtime">Functions for a One-Size-Fits-All Runtime</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="classes-for-configurations-and-schemata">
<h2>3.2. Classes for Configurations and Schemata<a class="headerlink" href="#classes-for-configurations-and-schemata" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">phyles.Schema</span></tt></a></dt>
<dd><p class="first last">encapsulates a schema and wraps <a class="reference internal" href="#phyles.sample_config">phyles.sample_config</a>,
<a class="reference internal" href="#phyles.validate_config">phyles.validate_config</a>, and <a class="reference internal" href="#phyles.read_config">phyles.read_config</a>
for convenience</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">phyles.Configuration</span></tt></a></dt>
<dd><p class="first last">encapsulates a configuration, remembering values
before any conversion</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions-for-configurations-and-schemata">
<h2>3.3. Functions for Configurations and Schemata<a class="headerlink" href="#functions-for-configurations-and-schemata" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.read_schema">phyles.read_schema</a></dt>
<dd><p class="first last">makes a schema from a specification in a YAML file</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.load_schema">phyles.load_schema</a></dt>
<dd><p class="first last">makes a schema a specification in YAML text, a mapping,
or a <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of 2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt> with unique keys</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.sample_config">phyles.sample_config</a></dt>
<dd><p class="first last">produces a sample config from a schema</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.validate_config">phyles.validate_config</a></dt>
<dd><p class="first last">validates a config file with a schema</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.read_config">phyles.read_config</a></dt>
<dd><p class="first last">reads a yaml config file and validates the config
with a schema</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions-for-files-and-directories">
<h2>3.4. Functions for Files and Directories<a class="headerlink" href="#functions-for-files-and-directories" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.last_made">phyles.last_made</a></dt>
<dd><p class="first last">returns the most recently created file in a directory</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.get_home_dir">phyles.get_home_dir</a></dt>
<dd><p class="first last">returns the users home directory in a representation
native to the host OS</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.get_data_path">phyles.get_data_path</a></dt>
<dd><p class="first last">returns the absolute path to a data directory
within a package</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.package_spec">phyles.package_spec</a></dt>
<dd><p class="first last">reads and returns the contents a schema specification
somewhere in a package as YAML text</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.prune">phyles.prune</a></dt>
<dd><p class="first last">recursively deletes files matching specified
unix sytle patterns</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.zipdir">phyles.zipdir</a></dt>
<dd><p class="first last">uses python zipfile package to create a zip archive
of a directory</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions-for-user-interaction">
<h2>3.5. Functions for User Interaction<a class="headerlink" href="#functions-for-user-interaction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.wait_exec">phyles.wait_exec</a></dt>
<dd><p class="first last">waits for a command to execute via a system call
and returns the output from stdout; slightly
more convenient than <a class="reference external" href="http://docs.python.org/2/library/popen2.html#popen2.Popen3" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">popen2.Popen3</span></tt></a></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.doyn">phyles.doyn</a></dt>
<dd><p class="first last">queries user for yes/no input from <a class="reference external" href="http://docs.python.org/2/library/functions.html#raw_input" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">raw_input()</span></tt></a>
and can execute an optional command with <a class="reference internal" href="#phyles.wait_exec">phyles.wait_exec</a></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.banner">phyles.banner</a></dt>
<dd><p class="first last">prints a banner for the program to stdout</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.usage">phyles.usage</a></dt>
<dd><p class="first last">uses <a class="reference external" href="http://docs.python.org/2/library/optparse.html#optparse.OptionParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">optparse.OptionParser</span></tt></a> to print usage and
can print an optional error message, if provided.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.default_argparser">phyles.default_argparser</a></dt>
<dd><p class="first last">returns a default <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a>
with mutually exclusive template, config, and
override arguments added</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.get_terminal_size">phyles.get_terminal_size</a></dt>
<dd><p class="first last">returns the terminal size as a (width, height)
<tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt> (works with Linux, OS X, Windows, Cygwin)</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions-for-a-one-size-fits-all-runtime">
<h2>3.6. Functions for a One-Size-Fits-All Runtime<a class="headerlink" href="#functions-for-a-one-size-fits-all-runtime" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.set_up">phyles.set_up</a></dt>
<dd><p class="first last">sets up the runtime with an <tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgParser</span></tt>,
loads a schema and validates a config with config override,
and prepares state for graceful recovery from user error</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.run_main">phyles.run_main</a></dt>
<dd><p class="first last">trivial try-except block for graceful recovery from
anticipated types of user error</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#phyles.mapify">phyles.mapify</a></dt>
<dd><p class="first last">function decorator that converts a function taking
any arbitrary set of arguments into a funciton taking
as a single argument a mapping object keyed with the
names of the original arguments</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="module-phyles">
<span id="api-details"></span><h2>3.7. API Details<a class="headerlink" href="#module-phyles" title="Permalink to this headline">¶</a></h2>
<p>phyles: A package to simplify authoring utilites.
Copyright (C) 2013  James C. Stroud
All rights reserved.</p>
<dl class="class">
<dt id="phyles.Schema">
<em class="property">class </em><tt class="descclassname">phyles.</tt><tt class="descname">Schema</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#phyles.Schema" title="Permalink to this definition">¶</a></dt>
<dd><p>An <tt class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></tt> subclass that provides
identity for schemata.</p>
<p>A <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> has an implicit structure and is created by the
<a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a> or <a class="reference internal" href="#phyles.read_schema" title="phyles.read_schema"><tt class="xref py py-func docutils literal"><span class="pre">read_schema()</span></tt></a> functions. See the
documentation in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a> for a detailed explanation.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Creating instances of <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> through its class
constructor (i.e. <tt class="docutils literal"><span class="pre">'__init__'</span></tt>) is not yet advised
or supported and may break forward compatibility.</p>
</div>
<dl class="method">
<dt id="phyles.Schema.read_config">
<tt class="descname">read_config</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#phyles.Schema.read_config" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper for <a class="reference internal" href="#phyles.read_config" title="phyles.read_config"><tt class="xref py py-func docutils literal"><span class="pre">read_config()</span></tt></a> (see documentation
therein).</p>
<p>Comparison of usage with <a class="reference internal" href="#phyles.read_config" title="phyles.read_config"><tt class="xref py py-func docutils literal"><span class="pre">read_config()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phyles</span><span class="o">.</span><span class="n">read_config</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="n">schema</span><span class="o">.</span><span class="n">read_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="phyles.Schema.sample_config">
<tt class="descname">sample_config</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#phyles.Schema.sample_config" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper for <a class="reference internal" href="#phyles.sample_config" title="phyles.sample_config"><tt class="xref py py-func docutils literal"><span class="pre">sample_config()</span></tt></a> (see documentation
therein).</p>
<p>Comparison of usage with <a class="reference internal" href="#phyles.sample_config" title="phyles.sample_config"><tt class="xref py py-func docutils literal"><span class="pre">sample_config()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phyles</span><span class="o">.</span><span class="n">sample_config</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="n">schema</span><span class="o">.</span><span class="n">sample_config</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="phyles.Schema.validate_config">
<tt class="descname">validate_config</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#phyles.Schema.validate_config" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a wrapper for <a class="reference internal" href="#phyles.validate_config" title="phyles.validate_config"><tt class="xref py py-func docutils literal"><span class="pre">validate_config()</span></tt></a> (see documentation
therein).</p>
<p>Comparison of usage with <a class="reference internal" href="#phyles.validate_config" title="phyles.validate_config"><tt class="xref py py-func docutils literal"><span class="pre">validate_config()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">phyles</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="n">schema</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="phyles.Configuration">
<em class="property">class </em><tt class="descclassname">phyles.</tt><tt class="descname">Configuration</tt><big>(</big><em>config=None</em><big>)</big><a class="headerlink" href="#phyles.Configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>An <tt class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></tt> subclass that encapsulates configurations
and also remembers the original input.</p>
<p>A <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a> has a specific structure and is creatd by
<a class="reference internal" href="#phyles.validate_config" title="phyles.validate_config"><tt class="xref py py-func docutils literal"><span class="pre">validate_config()</span></tt></a> or <a class="reference internal" href="#phyles.read_config" title="phyles.read_config"><tt class="xref py py-func docutils literal"><span class="pre">read_config()</span></tt></a> functions, usually
by the latter.  The <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a> class is exposed in
the API purely for purposes of documentation.</p>
<dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt><cite>original</cite>: the original config as an <tt class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></tt>,</dt>
<dd><p class="first">allowing the remembering of user input while
also allowing conversion</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;red&#39;</span><span class="p">:</span> <span class="s">&#39;ff0000&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="s">&#39;green&#39;</span><span class="p">:</span> <span class="s">&#39;00ff00&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="s">&#39;blue&#39;</span><span class="p">:</span> <span class="s">&#39;0000ff&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">({</span><span class="s">&#39;color&#39;</span><span class="p">:</span> <span class="s">&#39;blue&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="s">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;color&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="s">&#39;color&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;0000ff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">original</span><span class="p">[</span><span class="s">&#39;color&#39;</span><span class="p">]</span>
<span class="go">&#39;blue&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Creating instances of <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a> through its
class constructor (i.e. with <tt class="docutils literal"><span class="pre">phyles.Configuration()</span></tt>)
is not yet advised or supported and may break forward
compatibility.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.read_schema">
<tt class="descclassname">phyles.</tt><tt class="descname">read_schema</tt><big>(</big><em>yaml_file</em>, <em>converters=None</em><big>)</big><a class="headerlink" href="#phyles.read_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the schema specified in the file named
in <cite>yaml_file</cite>. This function simply opens
and reads the <cite>yaml_file</cite> before sending
its contents to <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a> to produce
the <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a>.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><cite>yaml_file</cite>: name of a yaml file holding the specification</p>
<dl class="last docutils">
<dt><cite>converters</cite>:</dt>
<dd>a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> of converters keyed by config entry names,
as described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> as described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="phyles.load_schema">
<tt class="descclassname">phyles.</tt><tt class="descname">load_schema</tt><big>(</big><em>spec</em>, <em>converters=None</em><big>)</big><a class="headerlink" href="#phyles.load_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> from the specification, <cite>spec</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the schema specification is in a YAML file,
then use <a class="reference internal" href="#phyles.read_schema" title="phyles.read_schema"><tt class="xref py py-func docutils literal"><span class="pre">phyles.read_schema()</span></tt></a>, which is a
convenience wrapper around <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a>.</p>
</div>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt><cite>spec</cite>:</dt>
<dd><p class="first">Can either be YAML text, a <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of
2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt> with unique first elements,
a mapping object (e.g. <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>),
or <cite>None</cite> (which would be equivalent to
an empty <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>.
If the schema is in a YAML file, then use
<a class="reference internal" href="#phyles.read_schema" title="phyles.read_schema"><tt class="xref py py-func docutils literal"><span class="pre">phyles.read_schema()</span></tt></a>. The values
of the items of <cite>spec</cite> are:</p>
<blockquote>
<div><ol class="arabic simple">
<li>converter</li>
<li>example value</li>
<li>help string</li>
<li>default value (optional)</li>
</ol>
</div></blockquote>
<p>Example YAML specification as a complete YAML file:</p>
<div class="highlight-python"><pre>%YAML 1.2
---
!!omap
- 'pdb model' : [str, my_model.pdb, null]
- 'reset b-facs' : 
      - float
      - -1
      - "New B factor (-1 for no reset)"
      - -1
- 'cell dimensions' : [get_cell, [200, 200, 200], null]</pre>
</div>
<p>The same example as a python specification via a
<tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of 2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt> with unique
first elements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="s">&#39;pdb model&#39;</span><span class="p">,</span>
  <span class="p">[</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;my_model.pdb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">]),</span>
 <span class="p">(</span><span class="s">&#39;reset b-facs&#39;</span><span class="p">,</span>
  <span class="p">[</span><span class="s">&#39;float&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;New B factor (-1 for no reset)&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
 <span class="p">(</span><span class="s">&#39;cell dimensions&#39;</span><span class="p">,</span>
  <span class="p">[</span><span class="n">get_cell</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="bp">None</span><span class="p">])]</span>
</pre></div>
</div>
<p>For completeness, the same example as a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;pdb model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;my_model.pdb&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
 <span class="s">&#39;reset b-facs&#39;</span><span class="p">:</span>
   <span class="p">[</span><span class="s">&#39;float&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;New B factor (-1 for no reset)&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
 <span class="s">&#39;cell dimensions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_cell</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="bp">None</span><span class="p">]}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The python structure (<tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of
2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt>) of this example specification
is simply the result of parsing the YAML with
the <a class="reference external" href="http://pyyaml.org/">PyYAML</a> parser.  Because of isomorphism
between a <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of 2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt>
with unique first elements, <tt class="xref py py-class docutils literal"><span class="pre">OrderedDicts</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">dicts</span></tt>, and other mapping types,
the specification may take any of these forms.</p>
</div>
<p>The following YAML representation of a config conforms to
the preceding schema specification:</p>
<div class="last highlight-python"><pre>pdb model : model.pdb
reset b-facs : 20
cell dimensions : [59, 95, 159]</pre>
</div>
</dd>
<dt><cite>converters</cite>:</dt>
<dd><p class="first">A <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> of <a class="reference external" href="http://en.wikibooks.org/wiki/Python_Programming/">callables</a> keyed by converter name
(which must match the converter names in <cite>spec</cite>), The
callables convert values from the actual config.</p>
<p>Converters that correspond to several native
<a class="reference external" href="http://docs.python.org/2/library/types.html">python types</a> and <a class="reference external" href="http://yaml.org/type/">YAML types</a>
do not need to be explicitly specified. The names
that these converters take in a schema specification
and the corresponding python types produced by these
converters are:</p>
<blockquote>
<div><ul class="simple">
<li><strong>map</strong>: <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a></li>
<li><strong>dict</strong>: <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>
(encoded as a <a class="reference external" href="http://yaml.org/type/dict.html">YAML dict</a>)</li>
<li><strong>omap</strong>: <a class="reference external" href="http://docs.python.org/2/library/collections.html#collections.OrderedDict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">collections.OrderedDict</span></tt></a></li>
<li><strong>odict</strong>: <a class="reference external" href="http://docs.python.org/2/library/collections.html#collections.OrderedDict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">collections.OrderedDict</span></tt></a>
(alias for &#8220;omap&#8221;)</li>
<li><strong>pairs</strong>: <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of 2-<tt class="xref py py-class docutils literal"><span class="pre">tuples</span></tt></li>
<li><strong>set</strong>: <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#set" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">set</span></tt></a></li>
<li><strong>seq</strong>: <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt></li>
<li><strong>list</strong>: <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt>
(encoded as a sequence, see <a class="reference external" href="http://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">list()</span></tt></a>)</li>
<li><strong>tuple</strong>: <tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt>
(encoded as a sequence, see <a class="reference external" href="http://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">tuple()</span></tt></a>)</li>
<li><strong>bool</strong>: <tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt></li>
<li><strong>float</strong>: <tt class="xref py py-class docutils literal"><span class="pre">float</span></tt></li>
<li><strong>int</strong>: <tt class="xref py py-class docutils literal"><span class="pre">int</span></tt></li>
<li><strong>long</strong>: <tt class="xref py py-class docutils literal"><span class="pre">long</span></tt> (encoded as a <a class="reference external" href="http://yaml.org/type/int.html">YAML int</a>)</li>
<li><strong>complex</strong>: <tt class="xref py py-class docutils literal"><span class="pre">complex</span></tt>
(encoded as a sequence of 0 to 2, or as a string
representation, e.g. <tt class="docutils literal"><span class="pre">'3+2j'</span></tt>; see <a class="reference external" href="http://docs.python.org/2/library/functions.html#complex" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">complex()</span></tt></a>)</li>
<li><strong>str</strong>: <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></li>
<li><strong>unicode</strong>: <tt class="xref py py-class docutils literal"><span class="pre">unicode</span></tt></li>
<li><strong>timestamp</strong>: <a class="reference external" href="http://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></tt></a>
(encoded as a <a class="reference external" href="http://yaml.org/type/timestamp.html">YAML timestamp</a>)</li>
<li><strong>slice</strong>: <tt class="xref py py-class docutils literal"><span class="pre">slice</span></tt>
(encoded as a sequence of 1 to 3, see <a class="reference external" href="http://docs.python.org/2/library/functions.html#slice" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">slice()</span></tt></a>)</li>
</ul>
</div></blockquote>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Except where noted, these types are encoded
according to the <a class="reference external" href="http://yaml.org/type/">YAML types</a> specification
in a YAML representation of a config.</p>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A fully constructed schema in the form of a
<a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a>. Most notably, the strings specifying
the converters in the <cite>spec</cite> are replaced by the converters
themselves.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">phyles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">get_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
<span class="go">      return [float(f) for f in cell]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;get_cell&#39;</span> <span class="p">:</span> <span class="n">get_cell</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="go">        %YAML 1.2</span>
<span class="go">        ---</span>
<span class="go">        !!omap</span>
<span class="go">        - &#39;pdb model&#39; : [str, my_model.pdb, null]</span>
<span class="go">        - &#39;reset b-facs&#39; : </span>
<span class="go">              - float</span>
<span class="go">              - -1</span>
<span class="go">              - &quot;New B factor (-1 for no reset)&quot;</span>
<span class="go">              - -1</span>
<span class="go">        - &#39;cell dimensions&#39; : [get_cell, [200, 200, 200], null]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phyles</span><span class="o">.</span><span class="n">load_schema</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">)</span>
<span class="go">Schema([(&#39;pdb model&#39;,</span>
<span class="go">         [&lt;type &#39;str&#39;&gt;, &#39;my_model.pdb&#39;, None]),</span>
<span class="go">        (&#39;reset b-facs&#39;,</span>
<span class="go">         [&lt;type &#39;float&#39;&gt;, -1,</span>
<span class="go">          &#39;New B factor (-1 for no reset)&#39;, -1]),</span>
<span class="go">        (&#39;cell dimensions&#39;,</span>
<span class="go">         [&lt;function get_cell at 0x101d7cf50&gt;,</span>
<span class="go">          [200, 200, 200], None])])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.sample_config">
<tt class="descclassname">phyles.</tt><tt class="descname">sample_config</tt><big>(</big><em>schema</em><big>)</big><a class="headerlink" href="#phyles.sample_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a sample config specification (returned as a <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>)
from the <cite>schema</cite>, as described in <a class="reference internal" href="#phyles.read_schema" title="phyles.read_schema"><tt class="xref py py-func docutils literal"><span class="pre">read_schema()</span></tt></a>.</p>
<p>Items with empty help strings (i.e. <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>) are not included
in the sample config. These may be used for testing, etc.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><cite>schema</cite>: a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a></dd>
<dt>Returns:</dt>
<dd>A <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt> that is useful as a template config specification.
Example values from the schema will be used. Additionally, the help
strings will be inserted as reasonably formatted YAML comments.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">phyles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">get_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
<span class="go">      return [float(f) for f in cell]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;get_cell&#39;</span> <span class="p">:</span> <span class="n">get_cell</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="go">        !!omap</span>
<span class="go">        - &#39;pdb model&#39; : [str, my_model.pdb, null]</span>
<span class="go">        - &#39;reset b-facs&#39; : </span>
<span class="go">              - float</span>
<span class="go">              - -1</span>
<span class="go">              - &quot;New B factor (-1 for no reset)&quot;</span>
<span class="go">              - -1</span>
<span class="go">        - &#39;cell dimensions&#39; : [get_cell, [200, 200, 200], null]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">phyles</span><span class="o">.</span><span class="n">load_schema</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
<span class="go">                                converters=converters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">phyles</span><span class="o">.</span><span class="n">sample_config</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="go">%YAML 1.2</span>
<span class="go">---</span>

<span class="go">pdb model : my_model.pdb</span>

<span class="go"># New B factor (-1 for no reset)</span>
<span class="go">reset b-facs : -1</span>

<span class="go">cell dimensions : [200, 200, 200]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.validate_config">
<tt class="descclassname">phyles.</tt><tt class="descname">validate_config</tt><big>(</big><em>schema</em>, <em>config</em><big>)</big><a class="headerlink" href="#phyles.validate_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a YAML specification for a configuration, <cite>config</cite>,
and uses the <cite>schema</cite> (as described in
<a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a>) for validation, which:</p>
<blockquote>
<div><ol class="arabic simple">
<li>checks for required config entries, raising
a <tt class="xref py py-class docutils literal"><span class="pre">ConfigError</span></tt> if any are missing</li>
<li>ensures that no unrecognized config entries are
present, raising a <tt class="xref py py-class docutils literal"><span class="pre">ConfigError</span></tt> in any such
entries are present</li>
<li>ensures, through the use of converters, that the
values given in the config specification are of
the appropriate types and within accepted limits
(if applicable), raising a <tt class="xref py py-class docutils literal"><span class="pre">ConfigError</span></tt>
if any fail to convert</li>
<li>uses the converters to turn values given in
the configuration into values of the appropriate
types (e.g. the <a class="reference external" href="http://yaml.org/type/str.html">YAML str</a> <tt class="docutils literal"><span class="pre">'1+4j'</span></tt> is converted
into the python <tt class="xref py py-class docutils literal"><span class="pre">complex</span></tt> number <tt class="docutils literal"><span class="pre">(1+4j)</span></tt> if
the converter is <tt class="docutils literal"><span class="pre">'complex'</span></tt>)</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Why is conversion a part of validation?</strong>
Conversion facilitates the end-user&#8217;s working
with a minimal subset of the YAML vocabulary.
In the <tt class="xref py py-class docutils literal"><span class="pre">complex</span></tt> number example above, the
end-user only needs to know how complex numbers are
usually represented (e.g. <tt class="docutils literal"><span class="pre">'1+4j'</span></tt>) and
not what gibbersh like
<tt class="docutils literal"><span class="pre">'!!python/object:__main__.SomeComplexClass'</span></tt> <a class="reference external" href="http://pyyaml.org/wiki/PyYAMLDocumentation#LoadingYAML">means</a>,
where to put it, how to specify its attributes, etc.</p>
</div>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt><cite>config</cite>:</dt>
<dd>a mapping (e.g. <tt class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></tt> or <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>)
of configuration entries</dd>
<dt><cite>schema</cite>:</dt>
<dd>a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> as described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>The converted config as a <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a>.</dd>
<dt>Raises:</dt>
<dd><tt class="xref py py-class docutils literal"><span class="pre">ConfigError</span></tt></dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">phyles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">textwrap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">yaml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">get_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
<span class="go">      return [float(f) for f in cell]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;get_cell&#39;</span> <span class="p">:</span> <span class="n">get_cell</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="go">        %YAML 1.2</span>
<span class="go">        ---</span>
<span class="go">        !!omap</span>
<span class="go">        - &#39;pdb model&#39; : [str, my_model.pdb, null]</span>
<span class="go">        - &#39;reset b-facs&#39; : </span>
<span class="go">              - float</span>
<span class="go">              - -1</span>
<span class="go">              - &quot;New B factor (-1 for no reset)&quot;</span>
<span class="go">              - -1</span>
<span class="go">        - &#39;cell dimensions&#39; : [get_cell, [200, 200, 200], null]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">phyles</span><span class="o">.</span><span class="n">load_schema</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
<span class="go">                                converters=converters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="go">        pdb model : model.pdb</span>
<span class="go">        reset b-facs : 20</span>
<span class="go">        cell dimensions : [59, 95, 159]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span>
<span class="go">{&#39;cell dimensions&#39;: [59, 95, 159],</span>
<span class="go"> &#39;pdb model&#39;: &#39;model.pdb&#39;,</span>
<span class="go"> &#39;reset b-facs&#39;: 20}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phyles</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<span class="go">Configuration([(&#39;pdb model&#39;, &#39;model.pdb&#39;),</span>
<span class="go">               (&#39;reset b-facs&#39;, 20.0),</span>
<span class="go">               (&#39;cell dimensions&#39;, [59.0, 95.0, 159.0])])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.read_config">
<tt class="descclassname">phyles.</tt><tt class="descname">read_config</tt><big>(</big><em>schema</em>, <em>config_file</em><big>)</big><a class="headerlink" href="#phyles.read_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a YAML config file from the the file named
<cite>config_file</cite> and returns the config validated
by <cite>schema</cite>.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt><cite>config_file</cite>:</dt>
<dd><p class="first">YAML file holding the config, for example:</p>
<div class="last highlight-python"><pre>pdb model : model.pdb
reset b-facs : 20
cell dimensions : [59, 95, 159]</pre>
</div>
</dd>
</dl>
<p class="last"><cite>schema</cite>: a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a> as described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></p>
</dd>
<dt>Returns:</dt>
<dd>a <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="phyles.last_made">
<tt class="descclassname">phyles.</tt><tt class="descname">last_made</tt><big>(</big><em>dirpath='.'</em>, <em>suffix=None</em>, <em>depth=0</em><big>)</big><a class="headerlink" href="#phyles.last_made" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the most recently created file in <cite>dirpath</cite>. If provided,
the newest of the files with the given suffix/suffices is returned.
This will recurse to <cite>depth</cite>, with <cite>dirpath</cite> being at depth 0 and
its children directories being at depth 1, etc. Set <cite>depth</cite> to
any value but 0 or a positive integer if recursion should be exauhstive
(e.g. <tt class="docutils literal"><span class="pre">-1</span></tt> or <tt class="docutils literal"><span class="pre">None</span></tt>).</p>
<p>Returns <tt class="docutils literal"><span class="pre">None</span></tt> if no files are found that match <cite>suffix</cite>.</p>
<p>The <cite>suffix</cite> parameter is either a single suffix
(e.g. <tt class="docutils literal"><span class="pre">'.txt'</span></tt>) or a sequence of suffices
(e.g. <tt class="docutils literal"><span class="pre">['.txt',</span> <span class="pre">'.text']</span></tt>).</p>
</dd></dl>

<dl class="function">
<dt id="phyles.wait_exec">
<tt class="descclassname">phyles.</tt><tt class="descname">wait_exec</tt><big>(</big><em>cmd</em>, <em>instr=None</em><big>)</big><a class="headerlink" href="#phyles.wait_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Waits for <cite>cmd</cite> to execute and returns the output
from stdout. The <cite>cmd</cite> follows
the same rules as for python&#8217;s <a class="reference external" href="http://docs.python.org/2/library/popen2.html#popen2.Popen3" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">popen2.Popen3</span></tt></a>.
If <cite>instr</cite> is provided, this string is passed to
the standard input of the child process.</p>
<p>Except for the convenience of passing <cite>instr</cite>, this
funciton is somewhat redundant with pyhon&#8217;s
<a class="reference external" href="http://docs.python.org/2/library/subprocess.html#subprocess.call" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">subprocess.call()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="phyles.doyn">
<tt class="descclassname">phyles.</tt><tt class="descname">doyn</tt><big>(</big><em>msg</em>, <em>cmd=None</em>, <em>exc=&lt;built-in function system&gt;</em>, <em>outfile=None</em><big>)</big><a class="headerlink" href="#phyles.doyn" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference external" href="http://docs.python.org/2/library/functions.html#raw_input" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">raw_input()</span></tt></a> builtin to query the user a
yes or no question. If <cite>cmd</cite> is provided, then
the function specified by <cite>exc</cite> (default <a class="reference external" href="http://docs.python.org/2/library/os.html#os.system" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">os.system()</span></tt></a>)
will be called with the argument <cite>cmd</cite>.</p>
<p>If a file name for <cite>outfile</cite> is provided, then stdout will be
directed to a file of that name.</p>
</dd></dl>

<dl class="function">
<dt id="phyles.banner">
<tt class="descclassname">phyles.</tt><tt class="descname">banner</tt><big>(</big><em>program</em>, <em>version</em>, <em>width=70</em><big>)</big><a class="headerlink" href="#phyles.banner" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <cite>program</cite> and <cite>version</cite> to print a banner to stderr.
The banner will be printed at <cite>width</cite> (default 70).</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><cite>program</cite>: <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></p>
<p><cite>version</cite>: <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></p>
<p class="last"><cite>width</cite>: <tt class="xref py py-class docutils literal"><span class="pre">int</span></tt></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="phyles.usage">
<tt class="descclassname">phyles.</tt><tt class="descname">usage</tt><big>(</big><em>parser</em>, <em>msg=None</em>, <em>width=70</em>, <em>pad=4</em><big>)</big><a class="headerlink" href="#phyles.usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <cite>parser</cite> (<a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a>) to
print the usage. If <cite>msg</cite> (which can be an <tt class="xref py py-class docutils literal"><span class="pre">Exception</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>, etc.) is supplied then it will be printed as an error
message, hopefully in a way that catches the user&#8217;s eye. The usage
message will be formatted at <cite>width</cite> (default 70). The <cite>pad</cite>
is used to add some extra space to the beginning of the error
lines to make them stand out (default 4).</p>
</dd></dl>

<dl class="function">
<dt id="phyles.graceful">
<tt class="descclassname">phyles.</tt><tt class="descname">graceful</tt><big>(</big><em>msg=None</em>, <em>width=70</em>, <em>pad=4</em><big>)</big><a class="headerlink" href="#phyles.graceful" title="Permalink to this definition">¶</a></dt>
<dd><p>Gracefully exits the program with an error message.</p>
<p>The <cite>msg</cite>, <cite>width</cite> and <cite>pad</cite> arguments are the same
as for <a class="reference internal" href="#phyles.usage" title="phyles.usage"><tt class="xref py py-func docutils literal"><span class="pre">usage()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="phyles.get_home_dir">
<tt class="descclassname">phyles.</tt><tt class="descname">get_home_dir</tt><big>(</big><big>)</big><a class="headerlink" href="#phyles.get_home_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the home directory of the account under which
the python program is executed. The home directory
is represented in a manner that is comprehensible
by the host operating system (e.g. <tt class="docutils literal"><span class="pre">C:\something\</span></tt>
for Windows, etc.).</p>
<p>Adapted directly from K. S. Sreeram&#8217;s approach, message
393819 on c.l.python (7/18/2006). I treat this code
as public domain.</p>
</dd></dl>

<dl class="function">
<dt id="phyles.get_data_path">
<tt class="descclassname">phyles.</tt><tt class="descname">get_data_path</tt><big>(</big><em>env_var</em>, <em>package_name</em>, <em>data_dir</em><big>)</big><a class="headerlink" href="#phyles.get_data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path to the data directory. First
it looks for the directory specified in the
<cite>env_var</cite> environment variable and if that directory
does not exists, finds <cite>data_dir</cite> in one of the
following places (in this order):</p>
<blockquote>
<div><ol class="arabic simple">
<li>The package directory (i.e. where the <tt class="docutils literal"><span class="pre">__init.py__</span></tt> is
for the package named by the <cite>package_name</cite> parameter)</li>
<li>If the package is a file, the directory holding
the package file</li>
<li>If frozen, the directory holding the frozen executable</li>
<li>If frozen, the parent directory of the directory
holding the frozen executable</li>
<li>If frozen, the first element of <cite>sys.path</cite></li>
</ol>
</div></blockquote>
<p>Thus, if the package were at <tt class="docutils literal"><span class="pre">/path/to/my_package</span></tt>,
(i.e. with <tt class="docutils literal"><span class="pre">/path/to/my_package/__init__.py</span></tt>),
then a very reasonable place for the data directory would be
<tt class="docutils literal"><span class="pre">/path/to/my_package/package-data/</span></tt>.</p>
<p>The anticipated use of this function is within the package
with which the data files are associated. For this use,
the package name can be found with the global variable
<a class="reference external" href="http://www.python.org/dev/peps/pep-0366/">__package__</a>, which for this example would have the value
<tt class="docutils literal"><span class="pre">'my_package'</span></tt>. E.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pth</span> <span class="o">=</span> <span class="n">get_data_path</span><span class="p">(</span><span class="s">&#39;MYPACKAGEDATA&#39;</span><span class="p">,</span> <span class="n">__package__</span><span class="p">,</span> <span class="s">&#39;package-data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This code is adapted from <cite>_get_data_path()</cite>
from matplotlib <tt class="docutils literal"><span class="pre">__init__.py</span></tt>. Some parts of this code
are most likely subject to the <a class="reference external" href="http://matplotlib.sourceforge.net/users/license.html">matplotlib license</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <cite>env_var</cite> argument can be ignored using
<tt class="docutils literal"><span class="pre">phyles.Undefined</span></tt> because it&#8217;s guaranteed not to
be in <tt class="xref py py-attr docutils literal"><span class="pre">os.environ</span></tt>:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">pth</span> <span class="o">=</span> <span class="n">get_data_path</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">__package__</span><span class="p">,</span> <span class="s">&#39;package-data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The use of <tt class="docutils literal"><span class="pre">'__package__'</span></tt> for <cite>package_name</cite> will fail
in certain circumstances.  For example, if the value of
<tt class="docutils literal"><span class="pre">__name__</span></tt> is <tt class="docutils literal"><span class="pre">'__main__'</span></tt>, then <tt class="docutils literal"><span class="pre">__package__</span></tt>
is usually <tt class="docutils literal"><span class="pre">None</span></tt>. In such cases, it is necessary
to pass the package name explicitly.</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">pth</span> <span class="o">=</span> <span class="n">get_data_path</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="s">&#39;my_package&#39;</span><span class="p">,</span> <span class="s">&#39;package-data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.prune">
<tt class="descclassname">phyles.</tt><tt class="descname">prune</tt><big>(</big><em>patterns</em>, <em>doit=False</em><big>)</big><a class="headerlink" href="#phyles.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively deletes files matching the specified unix style
<cite>patterns</cite>. The <cite>doit</cite> parameter must be explicitly set to
<tt class="docutils literal"><span class="pre">True</span></tt> for the files to actually get deleted, otherwise,
it just logs with <a class="reference external" href="http://docs.python.org/2/library/logging.html#logging.info" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">logging.info()</span></tt></a> what <em>would</em> happen.
Raises a <tt class="xref py py-class docutils literal"><span class="pre">SystemExit</span></tt> if deletion of any file
is unsuccessful (only when <cite>doit</cite> is <tt class="docutils literal"><span class="pre">True</span></tt>).</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">prune</span><span class="p">([</span><span class="s">&#39;*~&#39;</span><span class="p">,</span> <span class="s">&#39;*.pyc&#39;</span><span class="p">],</span> <span class="n">doit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Args:</dt>
<dd><ul class="first last simple">
<li><cite>patterns</cite>: <tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> of unix style pathname patterns</li>
<li><cite>doit</cite>: <tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt></li>
</ul>
</dd>
</dl>
<p>Returns: <tt class="docutils literal"><span class="pre">None</span></tt></p>
<p>Raises: <tt class="xref py py-class docutils literal"><span class="pre">SystemExit</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="phyles.default_argparser">
<tt class="descclassname">phyles.</tt><tt class="descname">default_argparser</tt><big>(</big><big>)</big><a class="headerlink" href="#phyles.default_argparser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a> with
mutually exclusive template (<tt class="docutils literal"><span class="pre">-t</span></tt>, <tt class="docutils literal"><span class="pre">--template</span></tt>)
and config (<tt class="docutils literal"><span class="pre">-c</span></tt>, <tt class="docutils literal"><span class="pre">--config</span></tt>) arguments added. It
also has the override (<tt class="docutils literal"><span class="pre">-o</span></tt>, <tt class="docutils literal"><span class="pre">--override</span></tt>) option
added, to override configuration items on the command line.</p>
<p>The argument to <tt class="docutils literal"><span class="pre">--override</span></tt> should be a valid <a class="reference external" href="http://yaml.org/type/map.html">YAML map</a>
(with the <strong>single</strong> exception that the outermost curly braces
are optional for <a class="reference external" href="http://yaml.org/spec/current.html#id2544175">YAML flow style</a>).  Because YAML relies on
syntactically meaningful whitespace, single quotes should
surround the argument to <tt class="docutils literal"><span class="pre">--override</span></tt>.</p>
<p>The following examples execute a program called
<tt class="docutils literal"><span class="pre">program</span></tt>, overriding <tt class="docutils literal"><span class="pre">opt1</span></tt> and <tt class="docutils literal"><span class="pre">opt2</span></tt>
of the config in the file <tt class="docutils literal"><span class="pre">config.yml</span></tt>
with <tt class="docutils literal"><span class="pre">foo</span></tt> and <tt class="docutils literal"><span class="pre">bar</span></tt>, respctively:</p>
<div class="highlight-python"><pre>program -c config.yml -o 'opt1 : foo, opt2 : bar'</pre>
</div>
<div class="highlight-python"><pre>program -c config.yml -o '{opt1 : foo, opt2 : bar}'</pre>
</div>
<div class="highlight-python"><pre>program -c config.yml -o 'opt1 : foo\nopt2 : bar'</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The latter example illustrates how <a class="reference external" href="http://yaml.org/spec/current.html#id2545757">YAML block style</a>
can be used with <tt class="docutils literal"><span class="pre">--override</span></tt>: a single forward slash
(<tt class="docutils literal"><span class="pre">\</span></tt>) escapes an <tt class="docutils literal"><span class="pre">n</span></tt>, which evaluates to a
so-called &#8220;newline&#8221;. In other words, the YAML that
corresponds to this latter example is:</p>
<div class="highlight-python"><pre>opt1 : foo
opt2 : bar</pre>
</div>
<p>Similarly, other escape sequences can also be used
with <tt class="docutils literal"><span class="pre">--override</span></tt>. For example, the following
overrides an option called <tt class="docutils literal"><span class="pre">sep</span></tt>, setting its value
to the tab character:</p>
<div class="last highlight-python"><pre>program -c config.yml -o 'sep : "\t"'</pre>
</div>
</div>
<p>Returns: <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a></p>
</dd></dl>

<dl class="function">
<dt id="phyles.package_spec">
<tt class="descclassname">phyles.</tt><tt class="descname">package_spec</tt><big>(</big><em>env_var</em>, <em>package_name</em>, <em>data_dir</em>, <em>specfile_name</em><big>)</big><a class="headerlink" href="#phyles.package_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and returns the contents of a schema specification
somewhere in a package as YAML text (described in
<a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a>).</p>
<p>This function pulls out all the stops to find the specification.
It is best to try to give all of <cite>env_var</cite>, <cite>package_name</cite>,
and <cite>data_dir</cite> if they are available to have the best chance
of finding the path to the specification file. See
<a class="reference internal" href="#phyles.get_data_path" title="phyles.get_data_path"><tt class="xref py py-func docutils literal"><span class="pre">get_data_path()</span></tt></a> for a full description.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">The arguments <cite>env_var</cite>, <cite>package_name</cite>, and <cite>data_dir</cite> are
identical to those required in <a class="reference internal" href="#phyles.get_data_path" title="phyles.get_data_path"><tt class="xref py py-func docutils literal"><span class="pre">get_data_path()</span></tt></a>.</p>
<p class="last"><cite>specfile_name</cite>: name of the schema specification file found
within the package contents.</p>
</dd>
<dt>Returns:</dt>
<dd>A YAML string specifying the schema.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="phyles.set_up">
<tt class="descclassname">phyles.</tt><tt class="descname">set_up</tt><big>(</big><em>program</em>, <em>version</em>, <em>spec</em>, <em>converters=None</em>, <em>argparser=None</em><big>)</big><a class="headerlink" href="#phyles.set_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the name of the program (<cite>program</cite>), the <cite>version</cite>
string, the specification for the schema (<cite>spec</cite>;
described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a>), and <cite>converters</cite>
for the schema (also described in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a>),
this function:</p>
<blockquote>
<div><ol class="arabic simple">
<li>sets up the default argparser if the <cite>argparser</cite>
keyword argument is <cite>None</cite> or not provided (see
<a class="reference internal" href="#phyles.default_argparser" title="phyles.default_argparser"><tt class="xref py py-func docutils literal"><span class="pre">default_argparser()</span></tt></a>)</li>
<li>prints the template or banner as appropriate (see
<tt class="xref py py-func docutils literal"><span class="pre">template()</span></tt> and <a class="reference internal" href="#phyles.banner" title="phyles.banner"><tt class="xref py py-func docutils literal"><span class="pre">banner()</span></tt></a>)</li>
<li>creates a schema and uses it to validate the config
(see <tt class="xref py py-func docutils literal"><span class="pre">load_config()</span></tt> and <a class="reference internal" href="#phyles.validate_config" title="phyles.validate_config"><tt class="xref py py-func docutils literal"><span class="pre">validate_config()</span></tt></a>)</li>
<li>overrides items in the config according to the command
line option <tt class="docutils literal"><span class="pre">--override</span></tt> or <tt class="docutils literal"><span class="pre">-o</span></tt> (see
<a class="reference internal" href="#phyles.default_argparser" title="phyles.default_argparser"><tt class="xref py py-func docutils literal"><span class="pre">default_argparser()</span></tt></a> for a description of <tt class="docutils literal"><span class="pre">--override</span></tt>)</li>
<li>exits gracefully with <a class="reference internal" href="#phyles.usage" title="phyles.usage"><tt class="xref py py-func docutils literal"><span class="pre">usage()</span></tt></a> if any problems are
found in the command line arguments of config</li>
<li>returns a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> of the
<a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a>, the parsed command line
arguments, the <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a>, and the <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a>
with keys <tt class="docutils literal"><span class="pre">'argparser'</span></tt>, <tt class="docutils literal"><span class="pre">'args'</span></tt>, <tt class="docutils literal"><span class="pre">'schema'</span></tt>,
<tt class="docutils literal"><span class="pre">'config'</span></tt>, respectively</li>
</ol>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><cite>program</cite>: the program name as a <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></p>
<p><cite>version</cite>: the program version as a <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></p>
<p><cite>spec</cite>: a schema specification as described in
<a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></p>
<p><cite>coverters</cite>: a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> of converters as described
in <a class="reference internal" href="#phyles.load_schema" title="phyles.load_schema"><tt class="xref py py-func docutils literal"><span class="pre">load_schema()</span></tt></a></p>
<p class="last"><cite>argparser</cite>: used as the <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a>
if provided; else the <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a>
returned by <a class="reference internal" href="#phyles.default_argparser" title="phyles.default_argparser"><tt class="xref py py-func docutils literal"><span class="pre">default_argparser()</span></tt></a> is used</p>
</dd>
</dl>
<p>Returns: a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> with the keys:</p>
<blockquote>
<div><ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">'argparser'</span></tt>: <a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.ArgumentParser" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">'args'</span></tt>: the parsed command lines arguments as a 
<a class="reference external" href="http://docs.python.org/2/library/argparse.html#argparse.Namespace" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">argparse.Namespace</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">'schema'</span></tt>: schema for the configuration
as a <a class="reference internal" href="#phyles.Schema" title="phyles.Schema"><tt class="xref py py-class docutils literal"><span class="pre">Schema</span></tt></a></li>
<li><tt class="docutils literal"><span class="pre">'config'</span></tt>: the configuration
as a <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="phyles.run_main">
<tt class="descclassname">phyles.</tt><tt class="descname">run_main</tt><big>(</big><em>main</em>, <em>config</em>, <em>catchall=&lt;class 'phyles._phyles.DummyException'&gt;</em><big>)</big><a class="headerlink" href="#phyles.run_main" title="Permalink to this definition">¶</a></dt>
<dd><p>Trivial convenience function that runs a <cite>main</cite> function
within a try-except block. The <cite>main</cite> function should take
as its sole argument the <cite>config</cite>, which is a mapping object
that holds the configuration (usually a <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a>
object). The <cite>catchall</cite> is an <tt class="xref py py-class docutils literal"><span class="pre">Exception</span></tt> or a
tuple of <tt class="xref py py-class docutils literal"><span class="pre">Exceptions</span></tt>, which if caught will result in a
graceful exit of the program (see <a class="reference internal" href="#phyles.graceful" title="phyles.graceful"><tt class="xref py py-func docutils literal"><span class="pre">graceful()</span></tt></a>).</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><cite>main</cite>: a function, equivalent to the main function of a program</p>
<dl class="docutils">
<dt><cite>config</cite>: a mapping object, usually a <a class="reference internal" href="#phyles.Configuration" title="phyles.Configuration"><tt class="xref py py-class docutils literal"><span class="pre">Configuration</span></tt></a></dt>
<dd>which is generally produced by <a class="reference internal" href="#phyles.validate_config" title="phyles.validate_config"><tt class="xref py py-func docutils literal"><span class="pre">validate_config()</span></tt></a> or
<a class="reference internal" href="#phyles.read_config" title="phyles.read_config"><tt class="xref py py-func docutils literal"><span class="pre">read_config()</span></tt></a></dd>
</dl>
<p class="last"><cite>catchall</cite>: an <tt class="xref py py-class docutils literal"><span class="pre">Exception</span></tt> or a <tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt> of
<tt class="xref py py-class docutils literal"><span class="pre">Exceptions</span></tt></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="phyles.mapify">
<tt class="descclassname">phyles.</tt><tt class="descname">mapify</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#phyles.mapify" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a function <cite>f</cite> with an arbitrary set of arguments
and keyword arguments, a new function is returned that
instead takes as an argument a mapping object (e.g.
a <a class="reference external" href="http://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>) that has as keys the original arguments
and keyword arguments of <cite>f</cite>.</p>
<p>If f has &#8220;kwargs&#8221;, as in (<tt class="docutils literal"><span class="pre">def</span> <span class="pre">f(**kwargs):</span></tt>), then items
in the mapping object that do not correspond to any arguments
or defaults are included in kwargs. See the <tt class="docutils literal"><span class="pre">'extra'</span></tt> key
in the first example in the doctest below.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><ul class="first last simple">
<li><cite>f</cite>:a function</li>
</ul>
</dd>
</dl>
<p>Returns: a function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">amap</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;bob&#39;</span><span class="p">:</span><span class="mi">39</span><span class="p">,</span> <span class="s">&#39;carol&#39;</span><span class="p">:</span><span class="mi">36</span><span class="p">},</span>
<span class="gp">... </span>        <span class="s">&#39;extra&#39;</span><span class="p">:</span> <span class="mi">99</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@mapify</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;a=</span><span class="si">%s</span><span class="s">  (b=</span><span class="si">%s</span><span class="s">  c=</span><span class="si">%s</span><span class="s">) d=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;args are: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">,)</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;kwargs are: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">,)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">amap</span><span class="p">)</span>
<span class="go">a=1  (b=2  c=3) d=42</span>
<span class="go">args are: (7, 8)</span>
<span class="go">kwargs are: {&#39;bob&#39;: 39, &#39;carol&#39;: 36, &#39;extra&#39;: 99}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@mapify</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;a is: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,)</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="n">amap</span><span class="p">)</span>
<span class="go">a is: 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@mapify</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;y is: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">y</span><span class="p">,)</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="s">&quot;args are: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">,)</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="p">(</span><span class="n">amap</span><span class="p">)</span>
<span class="go">y is: 4</span>
<span class="go">args are: (7, 8)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="phyles.get_terminal_size">
<tt class="descclassname">phyles.</tt><tt class="descname">get_terminal_size</tt><big>(</big><big>)</big><a class="headerlink" href="#phyles.get_terminal_size" title="Permalink to this definition">¶</a></dt>
<dd><p>return width and height of console; works on linux,
os x,windows,cygwin(windows)</p>
<p>based on <a class="reference external" href="https://gist.github.com/jtriley/1108174">https://gist.github.com/jtriley/1108174</a>
(originally retrieved from: <a class="reference external" href="http://goo.gl/CcPZh">http://goo.gl/CcPZh</a>)</p>
<p>Returns: 2-<tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt> of <tt class="xref py py-class docutils literal"><span class="pre">int</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="phyles.zipdir">
<tt class="descclassname">phyles.</tt><tt class="descname">zipdir</tt><big>(</big><em>basedir</em>, <em>archivename</em><big>)</big><a class="headerlink" href="#phyles.zipdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses python zipfile package to create a zip archive of
the directory <cite>basedir</cite> and store the archive to
<cite>archivename</cite>.</p>
<p>Virtually unmodified from <a class="reference external" href="http://goo.gl/Ty5k9">http://goo.gl/Ty5k9</a>
except that empty directories aren&#8217;t ignored.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><ul class="first last simple">
<li><cite>basedir</cite>: directory to zip as <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></li>
<li><cite>archivename</cite>: name of zip archive a <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></li>
</ul>
</dd>
</dl>
<p>Returns: <tt class="docutils literal"><span class="pre">None</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="phyles.basic_logger">
<tt class="descclassname">phyles.</tt><tt class="descname">basic_logger</tt><big>(</big><em>name</em>, <em>level=20</em><big>)</big><a class="headerlink" href="#phyles.basic_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference external" href="http://docs.python.org/2/library/logging.html#logging.Logger" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">logging.Logger</span></tt></a> named <cite>name</cite> with
level of <cite>level</cite> (defaults to <cite>logging.INFO</cite>). The format of the
messages is &#8220;%(levelname)s: %(message)s&#8221;.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Phyles API</a><ul>
<li><a class="reference internal" href="#api-overview">3.1. API Overview</a></li>
<li><a class="reference internal" href="#classes-for-configurations-and-schemata">3.2. Classes for Configurations and Schemata</a></li>
<li><a class="reference internal" href="#functions-for-configurations-and-schemata">3.3. Functions for Configurations and Schemata</a></li>
<li><a class="reference internal" href="#functions-for-files-and-directories">3.4. Functions for Files and Directories</a></li>
<li><a class="reference internal" href="#functions-for-user-interaction">3.5. Functions for User Interaction</a></li>
<li><a class="reference internal" href="#functions-for-a-one-size-fits-all-runtime">3.6. Functions for a One-Size-Fits-All Runtime</a></li>
<li><a class="reference internal" href="#module-phyles">3.7. API Details</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">2. Tutorial</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/phyles-api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="2. Tutorial"
             >previous</a> |</li>
        <li><a href="index.html">phyles 0.2.16 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Copyright (c) 2013, James C. Stroud; All rights reserved..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>