<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="ripe.tinyurl">
     <body>

         <div metal:fill-slot="main">
             <tal:def tal:define="urls view/tiny_url_handler">
                 <div id="tinyurl" tal:condition="urls">
                     <h1>TinyURL management screen</h1>
                     <form id="url" method="POST" 
                         tal:attributes="action string: ${context/absolute_url}/ripe-tinyurl">
                         <p>
                             <label>Full URL which you require a TinyURL for:</label>
                                 <input type="text" name="remoteUrl" 
                                     tal:attributes="value urls/url"
                                     id="url" />
                         </p>
                         <p>
                             <label>Hash Length:</label>
                             <select name="hash_length" 
                                 id="hash_length">
                                 <option>4</option>
                                 <option>5</option>
                                 <option>6</option>
                                 <option>7</option>
                                 <option>8</option>
                                 <option>9</option>
                                 <option>10</option>
                             </select>
                         <p>
                         <input type="submit" name="submit" value="Submit" class="tinybtn" />
                     </form>
                     <div id="tinyurl-message" tal:condition="urls/msg">
                         <p tal:content="urls/msg" />
                     </div>
                     <div id="tinyurl-hash" tal:condition="urls/hashid">
                         <p>The shortened URL is <span tal:content="context/absolute_url"></span>/<span tal:content="urls/hashid"></span>
                         </p>    
                     </div>
                     <div id="tinyurl-last-five" tal:condition="urls/links">
                         <h2>Last links added by you</h2>
                         <table class="grid">
                             <tr>
                                 <th>Remote URL</th>
                                 <th>TinyURL</th>
                                 <th></th>
                             </tr>
                             <tr tal:repeat="link urls/links">
                                 <td>
                                     <a tal:attributes="href link/getRemoteUrl" 
                                         tal:content="link/getRemoteUrl"></a>
                                 </td>
                                 <td>
                                     <a tal:attributes="href link/getURL" 
                                         tal:content="link/getURL"></a>
                                 </td>
                                 <td>
                                     <a class="tinybtn link-overlay"
                                         tal:attributes="href string:${link/getURL}/object_rename">Edit</a>
                                 </td>
                             </tr>
                         </table>
                     </div>
                 </div>
             </tal:def>
         </div>

    </body>
</html>
