From: <span tal:replace="structure options/sender | request/sender | here/emailAddress" />
To: <span tal:replace="options/email | request/email" />
Subject: <span tal:replace="string:Invoice ${context/getId} (${context/title})"/>
Content-Type: multipart/mixed; boundary="=_-15981-1169496311-0001-2"
Content-Transfer-Encoding: 7bit

--=_-15981-1169496311-0001-2
Content-Type: text/plain; charset="utf8"
Content-Transfer-Encoding: quoted-printable

Dear <span tal:replace="context/contact | string:Sir/Madam"/>,

Please pay this attached invoice at your nearest convenience and retain it for your tax records.

Regards,
<span tal:replace="python: context.getLedgerProperty('title')"/>

--=_-15981-1169496311-0001-2
Content-Type: text/html; charset="<span tal:replace="here/portal_properties/site_properties/default_charset" />"
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="<span tal:replace="context/getId"/>.html"

<div tal:define="global rendered context/blinvoice_template_html" tal:content="structure rendered"/>

--=_-15981-1169496311-0001-2
Content-Type: application/pdf; name="<span tal:replace="context/getId"/>.pdf"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="<span tal:replace="context/getId"/>.pdf"

<tal:attachment tal:replace="python: context.html2pdf(rendered)"/>

<tal:attachments tal:repeat="attachment context/attachmentsAsAttachments">
--=_-15981-1169496311-0001-2
<tal:email tal:replace="attachment"/>
</tal:attachments>