

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tfasta &mdash; tfasta 0.3.4 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.3.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="tfasta 0.3.4 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">tfasta 0.3.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tfasta">
<h1>tfasta<a class="headerlink" href="#tfasta" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The tfasta python package simplifies working
with fasta, providing functionality
for both reading and writing fasta files.
The &#8220;t&#8221; in &#8220;tfasta&#8221; represents
&#8220;templated&#8221;, which means that fasta parsing is
performed according to pre-defined or user-defined
templates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">fasta_parser</span><span class="p">,</span> <span class="n">T_NR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;cytb.fas&quot;</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">T_NR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;gi&#39;</span><span class="p">]</span>
<span class="go">5524211</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;accession&#39;</span><span class="p">]</span>
<span class="go">AAD44166.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;sequence&#39;</span><span class="p">][:</span><span class="mi">60</span><span class="p">]</span>
<span class="go">LCLYTHIGRNIYYGSYLYSETWNTGIMLLLITMATAFMGYVLPWGQMSFWGATVITNLFS</span>
</pre></div>
</div>
<p>This example parses records that follow the conventions
of the NCBI non-redundant database (nr).</p>
<p>More examples are given below.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Install tfasta with <a class="reference external" href="http://www.pip-installer.org/en/latest/">pip</a> (recommended) or <a class="reference external" href="http://peak.telecommunity.com/DevCenter/EasyInstall">easy_install</a>:</p>
<div class="highlight-python"><pre>sudo pip install tfasta</pre>
</div>
<p>Optionally, download the source files from
<a class="reference external" href="http://pypi.python.org/pypi/tfasta/">http://pypi.python.org/pypi/tfasta/</a>
and run the following commands in the source directory:</p>
<div class="highlight-python"><pre>python setup.py build
sudo python setup.py install</pre>
</div>
</div>
<div class="section" id="home-page-repository">
<h2>Home Page &amp; Repository<a class="headerlink" href="#home-page-repository" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>Home Page: <a class="reference external" href="http://pypi.python.org/pypi/tfasta/">http://pypi.python.org/pypi/tfasta/</a></li>
<li>Documentation: <a class="reference external" href="http://pythonhosted.org/radialx/">http://pythonhosted.org/radialx/</a></li>
<li>Repository: <a class="reference external" href="https://github.com/jcstroud/tfasta/">https://github.com/jcstroud/tfasta/</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reading-fasta-files">
<h3>Reading Fasta Files<a class="headerlink" href="#reading-fasta-files" title="Permalink to this headline">¶</a></h3>
<p>Reading fasta files is performed with the <em>fasta_parser()</em> function.
The following text is the first 2 records of the
file &#8220;<tt class="docutils literal"><span class="pre">short-extended.fas</span></tt>&#8221;:</p>
<div class="highlight-python"><pre>&gt;gi|32033604|ref|ZP_00133915.1|
ATGQVIGTFTVRNDNGLHARPSAVLVQTLKPFAAKVTVENLDRGTAPANAKSTMKVVALG
ASQAHRLRFVAEGEDAQQAIEALAKAFVEGLGESVSFVPAVEDTIEGAAQPQAVESAKNF
ANPTASEPTVEGQVEGTFVIQNEHGLHARPSAVLVNEVKKYNATIVVQNLDRNTQLVSAK
SLMKIVALGVVKGHRLHFVATGDDAQKAIDGIGEAIAAGLGE
&gt;gi|1573424|gb|AAC22107.1|
VEGAVVGTFTIRNEHGLHARPSANLVNEVKKFTSKITMQNLTRESEVVSAKSLMKIVALG
VTQGHRLRFVAEGEDAKQAIESLGKAIANGLGENVSAVPPSEPDTIEIMGDQIHTPAVTE
DDNLPANAIEAVFVIKNEQGLHARPSAILVNEVKKYNASVAVQNLDRNSQLVSAKSLMKI
VALGVVKGTRLRFVATGEEAQQAIDGIGAVIESGLGE</pre>
</div>
<p>Like any other fasta file, <tt class="docutils literal"><span class="pre">short-extended.fas</span></tt> may be parsed
with a single command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">fasta_parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;short-extended.fas&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">gi|32033604|ref|ZP_00133915.1|</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;sequence&#39;</span><span class="p">][:</span><span class="mi">60</span><span class="p">]</span>
<span class="go">ATGQVIGTFTVRNDNGLHARPSAVLVQTLKPFAAKVTVENLDRGTAPANAKSTMKVVALG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">gi|1573424|gb|AAC22107.1|</span>
</pre></div>
</div>
<p>In this example, the <em>fasta_parser()</em> function returns
an iterator of dictionaries (&#8220;<tt class="docutils literal"><span class="pre">fast</span></tt>&#8221;) with two
keys: <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">sequence</span></tt>.
The <tt class="docutils literal"><span class="pre">name</span></tt> key corresponds to all of the plain text after
the fasta format marker &#8220;<tt class="docutils literal"><span class="pre">&gt;</span></tt>&#8221; that marks a new sequence.</p>
</div>
<div class="section" id="iteration">
<h3>Iteration<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h3>
<p>The iterator returned by the <em>fasta_parser()</em> function
may serve in <tt class="docutils literal"><span class="pre">for</span></tt> loops:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">fasta_parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;short-extended.fas&quot;</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">gi|32033604|ref|ZP_00133915.1|</span>
<span class="go">gi|1573424|gb|AAC22107.1|</span>
<span class="go">[...]</span>
</pre></div>
</div>
</div>
<div class="section" id="using-templates">
<h3>Using Templates<a class="headerlink" href="#using-templates" title="Permalink to this headline">¶</a></h3>
<p>tfasta will parse fasta files according to one of several templates
that are written to the conventions of several common fasta
file sources, like swissprot, pdb, nr (the non-redundant database),
and nrblast.</p>
<p>The latter example implicitly uses a the default template
called &#8220;<tt class="docutils literal"><span class="pre">T_DEF</span></tt>&#8221;, yielding
dictionaries with the keys <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">sequence</span></tt>.
The <tt class="docutils literal"><span class="pre">sequence</span></tt> key is universal to all templates.</p>
<p>A complet list of templates (along with their keys) provided by
tfasta are:</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">T_DEF</span></tt> - plain old fasta line</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> - everything after the &#8220;&gt;&#8221;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">T_SWISS</span></tt> - fasta files from swissprot</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">gi_num</span></tt> - between first set of &#8220;|&#8221;s</li>
<li><tt class="docutils literal"><span class="pre">accession</span></tt> - between 3rd and 4th &#8220;|&#8221;</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - after last &#8220;|&#8221;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">T_PDB</span></tt> - the fasta file of the entire pdb</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">idCode</span></tt> - first four characters after &#8220;&gt;&#8221;</li>
<li><tt class="docutils literal"><span class="pre">chainID</span></tt> - any non-whitespace characters after first &#8220;_&#8221;</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> - non-whitespace immediately following first &#8221;:&#8221;</li>
<li><tt class="docutils literal"><span class="pre">numRes</span></tt> - numbers immediatly following first &#8221;:&#8221;</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - stripped characters after numRes</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">T_NR</span></tt> - the protein non-redundant database</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">gi</span></tt> - between first set of &#8220;|&#8221;s</li>
<li><tt class="docutils literal"><span class="pre">accession</span></tt> - between 3rd and 4th &#8220;|&#8221;</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - stripped characters before brackets</li>
<li><tt class="docutils literal"><span class="pre">source</span></tt> - stripped characters inside brackets</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">T_NRBLAST</span></tt> - fasta file produced from blast output of the nr</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">gi</span></tt> - between first set of &#8220;|&#8221;s</li>
<li><tt class="docutils literal"><span class="pre">accession</span></tt> - between 3rd and 4th &#8220;|&#8221;</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>An example using the <tt class="docutils literal"><span class="pre">T_NR</span></tt> template follows.
The nr fasta database has records that look like this:</p>
<div class="highlight-python"><pre>&gt;gi|5524211|gb|AAD44166.1| cytochrome b [Elephas maximus maximus]
LCLYTHIGRNIYYGSYLYSETWNTGIMLLLITMATAFMGYVLPWGQMSFWGATVITNLFSAIPYIGTNLV
EWIWGGFSVDKATLNRFFAFHFILPFTMVALAGVHLTFLHETGSNNPLGLTSDSDKIPFHPYYTIKDFLG
LLILILLLLLLALLSPDMLGDPDNHMPADPLNTPLHIKPEWYFLFAYAILRSVPNKLGGVLALFLSIVIL
GLMPFLHTSKHRSMMLRPLSQALFWTLTMDLLTLTWIGSQPVEYPYTIIGQMASILYFSIILAFLPIAGX
IENY</pre>
</div>
<p>This file, named &#8220;<tt class="docutils literal"><span class="pre">cytb.fas</span></tt>&#8221;, may be parsed using the
tfasta <tt class="docutils literal"><span class="pre">T_NR</span></tt> template:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">fasta_parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;cytb.fas&quot;</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">T_NR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;gi&#39;</span><span class="p">]</span>
<span class="go">5524211</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;accession&#39;</span><span class="p">]</span>
<span class="go">AAD44166.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span>
<span class="go">cytochrome b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;source&#39;</span><span class="p">]</span>
<span class="go">Elephas maximus maximus</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;sequence&#39;</span><span class="p">][:</span><span class="mi">60</span><span class="p">]</span>
<span class="go">LCLYTHIGRNIYYGSYLYSETWNTGIMLLLITMATAFMGYVLPWGQMSFWGATVITNLFS</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-small-fasta-files">
<h3>Reading Small Fasta Files<a class="headerlink" href="#reading-small-fasta-files" title="Permalink to this headline">¶</a></h3>
<p>Some fasta files may be several gigabytes in size. For this reason,
<em>fasta_parser()</em> reads fasta files incrementally by default,
such that only one sequence is read from the file at a time.</p>
<p>It is possible to force tfasta to read entire fasta files
at once by setting the <tt class="docutils literal"><span class="pre">greedy</span></tt> keyword to <tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<blockquote>
<div>fast = fasta_parser(&#8220;cytb.fas&#8221;, template=T_NR, greedy=True)</div></blockquote>
<p>Greedy reading of files is better suited for situations where
the user does not want to keep the file fasta file open
for reading. It is not recommended for large files.</p>
</div>
<div class="section" id="preserving-gaps">
<h3>Preserving Gaps<a class="headerlink" href="#preserving-gaps" title="Permalink to this headline">¶</a></h3>
<p>Some sequences may have gaps (&#8220;-&#8221;) such as those originating
from sequence alignments. To preserve gaps in the sequence
set the <tt class="docutils literal"><span class="pre">dogaps</span></tt> keyword to <tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;alignment.fas&quot;</span><span class="p">,</span> <span class="n">dogaps</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-fasta-strings">
<h3>Reading Fasta Strings<a class="headerlink" href="#reading-fasta-strings" title="Permalink to this headline">¶</a></h3>
<p>Not all fasta will originate from text files.
Often, it is necessary to parse a python <tt class="docutils literal"><span class="pre">str</span></tt> directly
using <em>string_fasta_parser()</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="n">string_fasta_parser</span><span class="p">(</span><span class="n">astr</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">string_fasta_parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">astr</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="go">           &gt; Abeta in a string</span>
<span class="go">           DAEFRHDSGYEVHHQKLVFFAEDVGSNKGAIIGLMVGGVVIA</span>
<span class="go">           &quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast</span> <span class="o">=</span> <span class="n">string_fasta_parser</span><span class="p">(</span><span class="n">astr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">Abeta in a string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;sequence&#39;</span><span class="p">]</span>
<span class="go">DAEFRHDSGYEVHHQKLVFFAEDVGSNKGAIIGLMVGGVVIA</span>
</pre></div>
</div>
<p>The <em>string_fasta_parser()</em> function takes all of the
same arguments as <em>fasta_parser()</em> except for the <tt class="docutils literal"><span class="pre">greedy</span></tt>
keyword argument.</p>
</div>
<div class="section" id="creating-fasta">
<h3>Creating Fasta<a class="headerlink" href="#creating-fasta" title="Permalink to this headline">¶</a></h3>
<p>Fasta formatted text can be created one at a time or in bunches
with the functions <em>make_fasta()</em> and <em>make_fasta_from_dict()</em>.
The following example creates fasta text from a name
and unformatted sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">make_fasta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;OVAX_CHICK GENE X PROTEIN N-Term&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s">      QIKDLLVSSSTDLDTTLVLVNAIYFKGMWK</span>
<span class="gp">... </span><span class="s">      afnaedtrempfhvtkqeskpvqmmcmnnsfnvatlpae</span>
<span class="gp">... </span><span class="s">      KMKILELPFASGDLSMLV</span>
<span class="gp">... </span><span class="s">      &quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">make_fasta</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">&gt;OVAX_CHICK GENE X PROTEIN N-Term</span>
<span class="go">QIKDLLVSSSTDLDTTLVLVNAIYFKGMWKAFNAEDTREMPFHVTKQESK</span>
<span class="go">PVQMMCMNNSFNVATLPAEKMKILELPFASGDLSMLV</span>
</pre></div>
</div>
<p>The default width of a <em>make_fasta()</em> formatted
fasta sequence is 60. In this latter example, the
width is changed to 50 using the <tt class="docutils literal"><span class="pre">width</span></tt> keyword.</p>
<p>This next example creates fasta from an ordered dictionary
(available at <a class="reference external" href="https://pypi.python.org/pypi/ordereddict/">https://pypi.python.org/pypi/ordereddict/</a>
or built in to Python 2.7+):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">make_fasta_from_dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>  <span class="c"># python 2.7+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span> <span class="s">&quot;First 10&quot;</span><span class="p">:</span>  <span class="s">&quot; 1 QIKDLLVSSS&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s">&quot;Second 10&quot;</span><span class="p">:</span> <span class="s">&quot;11 tdldttlvlv&quot;</span> <span class="p">})</span>
<span class="go">print make_fasta_from_dict(od)</span>
<span class="go">&gt;First 10</span>
<span class="go">QIKDLLVSSS</span>
<span class="go">&gt;Second 10</span>
<span class="go">TDLDTTLVLV</span>
</pre></div>
</div>
<p>Using an ordered dictionary is not required, but it does
ensure control over the order of the sequences in the fasta.
Any well-behaved &#8220;mapping object&#8221;, like the built-in <tt class="docutils literal"><span class="pre">dict</span></tt>
will work.</p>
<p>Note that <em>make_fasta()</em> and <em>make_fasta_from_dict()</em>
both ignore all characters except letters and &#8220;-&#8221;.</p>
</div>
<div class="section" id="creating-templates">
<h3>Creating Templates<a class="headerlink" href="#creating-templates" title="Permalink to this headline">¶</a></h3>
<p>The creation of templates uses python regular expressions
to find fields in the first line of a sequence record
within a fasta file (the line that begins with &#8220;&gt;&#8221;).</p>
<p>Each field must be &#8220;saved&#8221; by the regular expression
by wrapping its sub-expression in parentheses. For
example the <tt class="docutils literal"><span class="pre">T_NRBLAST</span></tt> template regular expression is:</p>
<div class="highlight-python"><pre>^&gt;gi\|([^|]*)\|[^|]*\|([^|]*)\|.*$
       ~~~~~           ~~~~~</pre>
</div>
<p>Here, the sub-expressions underscored by <tt class="docutils literal"><span class="pre">~</span></tt> characters
are saved by virtue of the surrounding parentheses.</p>
<p>The keys by which these saved fields are referred in the
dictionaries are given names, in the order that they
occur in the regular expression:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">regex</span> <span class="o">=</span> <span class="s">r&#39;^&gt;gi\|([^|]*)\|[^|]*\|([^|]*)\|.*$&#39;</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;gi&quot;</span><span class="p">,</span> <span class="s">&quot;accession&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to create a template using the <em>FastaTemplate</em>
class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">t_nrblast</span> <span class="o">=</span> <span class="n">FastaTemplate</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the template <tt class="docutils literal"><span class="pre">t_nrblast</span></tt> functions exactly as
the tfasta provided template <tt class="docutils literal"><span class="pre">T_NRBLAST</span></tt>.</p>
<p>Finally, use the template to parse fasta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fasta_parser</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">t_nrblast</span><span class="p">)</span>
</pre></div>
</div>
<p>The following examples shows templating put all together:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tfasta</span> <span class="kn">import</span> <span class="n">fasta_parser</span><span class="p">,</span> <span class="n">FastaTemplate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span> <span class="o">=</span> <span class="s">r&#39;^&gt;gi\|([^|]*)\|[^|]*\|([^|]*)\|.*$&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;gi&quot;</span><span class="p">,</span> <span class="s">&quot;accession&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_nrblast</span> <span class="o">=</span> <span class="n">FastaTemplate</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast</span> <span class="o">=</span> <span class="n">fasta_parser</span><span class="p">(</span><span class="s">&quot;short-extended.fas&quot;</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">t_nrblast</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;accession&#39;</span><span class="p">]</span>
<span class="go">ZP_00133915.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;sequence&#39;</span><span class="p">][:</span><span class="mi">60</span><span class="p">]</span>
<span class="go">ATGQVIGTFTVRNDNGLHARPSAVLVQTLKPFAAKVTVENLDRGTAPANAKSTMKVVALG</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tfasta</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#home-page-repository">Home Page &amp; Repository</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#reading-fasta-files">Reading Fasta Files</a></li>
<li><a class="reference internal" href="#iteration">Iteration</a></li>
<li><a class="reference internal" href="#using-templates">Using Templates</a></li>
<li><a class="reference internal" href="#reading-small-fasta-files">Reading Small Fasta Files</a></li>
<li><a class="reference internal" href="#preserving-gaps">Preserving Gaps</a></li>
<li><a class="reference internal" href="#reading-fasta-strings">Reading Fasta Strings</a></li>
<li><a class="reference internal" href="#creating-fasta">Creating Fasta</a></li>
<li><a class="reference internal" href="#creating-templates">Creating Templates</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">tfasta 0.3.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Copyright (c) 2014, James C. Stroud; All rights reserved..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>