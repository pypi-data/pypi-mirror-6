<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="bastionledger">

  <metal:border fill-slot="top_slot">
    <tal:border define="dummy python:request.set('enable_border',1)" />
  </metal:border>

<body>

    <div metal:fill-slot="main"
       tal:define="utool context/@@plone_portal_state/portal_url">

        <h1 tal:content="context/Title | context/getId" class="documentFirstHeading">
            Title or id
        </h1>

        <tal:byline tal:on-error="string:">
           <div tal:replace="structure provider:plone.belowcontenttitle"/>
        </tal:byline>

        <div class="documentDescription" tal:content="structure context/Description">
            description
        </div>

        <metal:listingmacro define-macro="listing">
        <tal:foldercontents define="folderContents python: list(context.objectValues());
                                    foo python: folderContents.sort();
                                    foo python: folderContents.reverse()">
        <tal:listing condition="folderContents"
                     define="global toLocalizedTime nocall:context/toLocalizedTime;">

           <table summary="" border="0" cellpadding="2" cellspacing="0">
             <tr>
                <td/>
                <td/>
                <td><label>Effective</label></td>
                <td><label>Rate</label></td>
                <td>&nbsp;</td>
                <td><label>Code</label></td>
                <td tal:repeat="d context/dimensions">
                    <label tal:content="d/capitalize"/>
                </td>
              </tr>
              <tr tal:repeat="obj folderContents"
                  tal:attributes="class python: repeat['obj'].odd() and 'odd' or 'even'">

                <tal:block metal:define-macro="listitem"
                    tal:define="url obj/absolute_url;
                                icon python: obj.getIcon(1)">
                   <td>
                       <a href="#" tal:attributes="href url">
                          <img src="" alt=""
                               tal:attributes="src string:${utool}/${icon};alt context/Title" />
                       </a>
                   </td>
                   <td>
                       <a href="#"  tal:attributes="href url"
                          tal:content="obj/Title" />
                   </td>
                   <td tal:content="python: toLocalizedTime(obj.effective_date)"/>
                   <td align="right" tal:content="obj/rate"/>
                   <td>&nbsp;</td>
                   <td tal:content="obj/code"/>
                   <td tal:repeat="d context/dimensions"
                       tal:content="python: getattr(obj,d,'')"/>
		 </tal:block>
            </tr>
          </table>

        </tal:listing>
        
        <p class="discreet"
           tal:condition="not: folderContents" i18n:translate="description_no_items_in_table">
         There are currently no items in this Table.
        </p>

        </tal:foldercontents>
        </metal:listingmacro>

        <div tal:replace="structure provider:plone.belowcontentbody">
           Document actions (print, sendto etc)
        </div>
    </div>

</body>
</html>
