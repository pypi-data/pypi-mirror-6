<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Création du graphique &mdash; documentation EweeStats 0.0dev1</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="documentation EweeStats 0.0dev1" href="index.html" />
    <link rel="next" title="Multithreading" href="tech_multithreading.html" />
    <link rel="prev" title="IHM / IMH" href="tech_ihmimh.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="tech_multithreading.html" title="Multithreading"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="tech_ihmimh.html" title="IHM / IMH"
             accesskey="P">précédent</a> |</li>
        <li><a href="index.html">documentation EweeStats 0.0dev1</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creation-du-graphique">
<h1>Création du graphique<a class="headerlink" href="#creation-du-graphique" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="lecture-des-donnees">
<h2>Lecture des données<a class="headerlink" href="#lecture-des-donnees" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les données sont lues à l&#8217;aide de la fonction io.open et stockées dans des listes. Toutes les données sont relues à chaque nouveau graphique.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">todo:</th><td class="field-body">On pourrait optimiser le programme en ne relisant que les valeurs ajoutées, en se souvenant le numéro de la dernière ligne lue en comptant le nombre de caractères de saut de ligne.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Pour lire les données, on ferait donc</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;data/data_</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">as</span> <span class="n">di</span><span class="p">:</span>
    <span class="n">dataList</span> <span class="o">=</span> <span class="p">([</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">di</span><span class="p">])</span>
</pre></div>
</div>
<p>On se rendra compte que le caractère de saut de ligne est encore là. On utilise donc la fonction rstrip</p>
<dl class="function">
<dt id="str.rstrip">
<tt class="descclassname">str.</tt><tt class="descname">rstrip</tt><big>(</big><big>)</big><a class="headerlink" href="#str.rstrip" title="Lien permanent vers cette définition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Retourne:</th><td class="field-body">copie de la chaîne str avec les espaces et caractères spéciaux supprimés</td>
</tr>
<tr class="field-even field"><th class="field-name">Type retourné:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>ce qui nous donne</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;data/data_</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">as</span> <span class="n">di</span><span class="p">:</span>
    <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">di</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="formatage-des-donnees">
<h2>Formatage des données<a class="headerlink" href="#formatage-des-donnees" title="Lien permanent vers ce titre">¶</a></h2>
<p>pygal attend les antécédents en chaînes de caractères et les images en entiers ou flottants, or les données sont lues comme des chaînes de caractères, il faut donc convertir les images en flottants, à l&#8217;aide de map</p>
<dl class="function">
<dt id="builtins.map">
<tt class="descclassname">builtins.</tt><tt class="descname">map</tt><big>(</big><big>)</big><a class="headerlink" href="#builtins.map" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>map(func, <a href="#id1"><span class="problematic" id="id2">*</span></a>iterables) &#8211;&gt; map object</p>
<p>Make an iterator that computes the function using arguments from
each of the iterables.  Stops when the shortest iterable is exhausted.</p>
</dd></dl>

<p>On ferme ensuite les fichiers avec close :</p>
<dl class="function">
<dt id="f.close">
<tt class="descclassname">f.</tt><tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#f.close" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Ferme le fichier f</p>
</dd></dl>

</div>
<div class="section" id="parametrage-du-graphique">
<h2>Paramétrage du graphique<a class="headerlink" href="#parametrage-du-graphique" title="Lien permanent vers ce titre">¶</a></h2>
<p>On utilise un graphique de type Line</p>
<dl class="class">
<dt id="pygal.Line">
<em class="property">class </em><tt class="descclassname">pygal.</tt><tt class="descname">Line</tt><a class="headerlink" href="#pygal.Line" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>La documentation de <a class="reference external" href="http://pygal.doc">pygal</a> est assez fournie, je ne redétaillerais pas la configuration.</p>
<p>Quand le programme commence à faire le graphique, il supprime l&#8217;ancien, fait le nouveau puis l&#8217;écrit sur le disque, ce qui fait qu&#8217;il y a un laps de temps où il n&#8217;y a plus aucun graphique.
Il faut donc faire un graphique temporaire et un graphique à publier. pygal crée le graphique &#8216;linechart_temps.svg&#8217;, puis on le renomme en &#8216;linechart.svg&#8217; à l&#8217;aide de</p>
<dl class="function">
<dt id="os.rename">
<tt class="descclassname">os.</tt><tt class="descname">rename</tt><big>(</big><em>oldname</em>, <em>newname</em><big>)</big><a class="headerlink" href="#os.rename" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>rename(src, dst, <a href="#id3"><span class="problematic" id="id4">*</span></a>, src_dir_fd=None, dst_dir_fd=None)</p>
<p>Rename a file or directory.</p>
<dl class="docutils">
<dt>If either src_dir_fd or dst_dir_fd is not None, it should be a file</dt>
<dd>descriptor open to a directory, and the respective path string (src or dst)
should be relative; the path will then be relative to that directory.</dd>
<dt>src_dir_fd and dst_dir_fd, may not be implemented on your platform.</dt>
<dd>If they are unavailable, using them will raise a NotImplementedError.</dd>
</dl>
</dd></dl>

<p>On notera qu&#8217;il n&#8217;y a pas besoin de supprimer linechart.svg avant de renommer linechart_temp.svg sur les systèmes Posix. Si le programme doit tourner sous NT, il faudra supprimer linechart.svg avant de renommer linechart_temp.svg.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table des Matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">Création du graphique</a><ul>
<li><a class="reference internal" href="#lecture-des-donnees">Lecture des données</a></li>
<li><a class="reference internal" href="#formatage-des-donnees">Formatage des données</a></li>
<li><a class="reference internal" href="#parametrage-du-graphique">Paramétrage du graphique</a></li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="tech_ihmimh.html"
                        title="Chapitre précédent">IHM / IMH</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="tech_multithreading.html"
                        title="Chapitre suivant">Multithreading</a></p>
  <h3>Cette page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tech_graph.txt"
           rel="nofollow">Montrer la source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Recherche rapide</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="tech_multithreading.html" title="Multithreading"
             >suivant</a> |</li>
        <li class="right" >
          <a href="tech_ihmimh.html" title="IHM / IMH"
             >précédent</a> |</li>
        <li><a href="index.html">documentation EweeStats 0.0dev1</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Gabriel Hondet.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>