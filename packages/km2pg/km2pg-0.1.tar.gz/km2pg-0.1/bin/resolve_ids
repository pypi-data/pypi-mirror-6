#!/usr/bin/env python

import argparse
from km2pg import pgdb, postproc

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="Assign an email to each km event, if possible")
    parser.add_argument('-m', '--host', help="hostname of machine hosting postgres db instance", required=True)
    parser.add_argument('-p', '--port', help="port on which postgres db instance listens", type=int, required=True)
    parser.add_argument('-d', '--dbname', help="name of postgres database", required=True)
    parser.add_argument('-u', '--user', help="postgres username", required=True)
    parser.add_argument('-w', '--passwd', help="postgres password", required=True)
    args = parser.parse_args()
    db = pgdb.DB(host=args.host, port=args.port, user=args.user, password=args.passwd, database=args.dbname)
    db.executemany(postproc.sql_resolve())
