<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>cicero_rest_connection.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>cicero_rest_connection.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>This file defines an abstract base class, CiceroRestABC, and an inheriting
class, CiceroRestConnection. The methods in CiceroRestConnection correspond
to all the endpoints in the Cicero API. These methods use the API request
methods in CiceroRestABC to wrap the API and get data back.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">json</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">simplejson</span> <span class="kn">as</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">cicero_endpoint_constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">cicero_response_classes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">cicero_errors</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">_NETWORK_ERROR</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">Unable to communicate with the Cicero API.</span><span class="se">\n</span><span class="s"></span>
<span class="s"> Please check you are connected to the network. </span><span class="se">\n</span><span class="s"></span>
<span class="s"> More info is below: </span><span class="se">\n</span><span class="s"></span>
<span class="s"> Reason: &quot;&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <h1>CiceroRestABC</h1>
<p>This is an Abstract Base Class for the CiceroRestConnection class. Methods
in CiceroRestConnection for the various API endpoints use the
_compose_request_url() and _submit_request() methods defined here to perform
the mechanics of composing a Cicero API url, requesting it, and parsing
a JSON response.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">CiceroRestABC</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h1>_compose_request_url()</h1>
<p>Given a Cicero API endpoint (defined in cicero_endpoint_constants.py)
and zero or any number of keyword arguments (ie, API search parameters,
enumerated in the Cicero documentation), this method encodes those
arguments/parameters and composes an API request url with endpoint,
user id, token, and parameters.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">_compose_request_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>save id if present and add to the base URL, it is treated differently</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="s">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">object_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span>

            <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span><span class="n">endpoint</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">object_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;?user=&#39;</span> <span class="o">+</span>
                           <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;token=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span>
                           <span class="s">&#39;&amp;f=json&amp;&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">request_url</span> <span class="o">=</span> <span class="p">(</span><span class="n">endpoint</span> <span class="o">+</span> <span class="s">&#39;?user=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;token=&#39;</span> <span class="o">+</span>
                           <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;f=json&amp;&#39;</span><span class="p">)</span>

        <span class="n">query_params</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">request_url</span> <span class="o">+=</span> <span class="n">query_params</span>

        <span class="k">return</span> <span class="n">request_url</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h1>json_to_cicero_object()</h1>
<p>Used in _submit_request() below, this method simply takes JSON from
the Cicero API and puts it in a RootCiceroObject, which parses it out
into the other classes defined in cicero_response_classes.py.</p>
<p>If you would prefer to do your own parsing or processing of responses
from the Cicero API, make your own subclass of CiceroRestConnection
and override this function.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">json_to_cicero_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_response</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">RootCiceroObject</span><span class="p">(</span><span class="n">json_response</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <h1>_submit_request()</h1>
<p>Given a request_url composed with the _compose_request_url() method, this
method requests the URL from the Cicero API and returns the JSON
response as a RootCiceroObject (defined in cicero_response_classes.py)
if successful.</p>
<p>If the Cicero API raises an error (a urllib2.HTTPError),
the resulting JSON (with error message from the API) and the HTTP status
code are returned and raised as a CiceroError (defined in
cicero_errors.py).</p>
<p>If python-cicero cannot communicate with the Cicero API
(a urllib2.URLError), a NetworkError (defined in cicero_errors.py) with
a urllib2.URLError.reason is raised.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">_submit_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_url</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">request_url</span><span class="p">)</span>
        <span class="n">request</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">&#39;User-Agent&#39;</span><span class="p">,</span> <span class="s">&#39;Cicero_Python_Wrapper&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="n">blob</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">json_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_to_cicero_object</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error_blob</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">error_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">error_blob</span><span class="p">)</span>
            <span class="n">error_dict</span><span class="p">[</span><span class="s">&#39;status_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span>
            <span class="k">raise</span> <span class="n">CiceroError</span><span class="p">(</span><span class="n">error_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="n">_NETWORK_ERROR</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h1>_response_from_endpoint()</h1>
<p>Uses the previous two functions (_compose_request_url() and
_submit_request()) to compose a url for Cicero, request it, and
return the API response.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">_response_from_endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compose_request_url</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h1>CiceroRestConnection(username, password)</h1>
<p>This class authenticates with the Cicero API and has methods to support
various Cicero ReST endpoints.</p>
<p><a href="https://cicero.azavea.com/docs/">Cicero API documentation</a></p>
<h2>Class Instantiation and API Authentication</h2>
<p>User authentication and calls to Cicero's /token/new.json endpoint is handled
in the <strong>init</strong> method of this class. If you get an error that
your token has expired, simply recreate/create a new class instance with
your username and password again, or re-execute your object's
<strong>init</strong> method, and the token will be "refreshed".</p>
<p>If you need to, you can access your username, password, numerical
Cicero User ID, or current token with this class's attributes:</p>
<ul>
<li>.username,</li>
<li>.password,</li>
<li>.user_id,</li>
<li>.token</li>
</ul>
<h2>Defined methods, with corresponding Cicero API calls and documentation:</h2>
<ul>
<li>get_official(**kwargs) -
    <a href="https://cicero.azavea.com/docs/official.html">/official</a></li>
<li>get_election_event(**kwargs) -
    <a href="https://cicero.azavea.com/docs/election_event.html">/election_event</a></li>
<li>get_legislative_district(**kwargs) -
    <a href="https://cicero.azavea.com/docs/district.html">/legislative_district</a></li>
<li>get_nonlegislative_district(**kwargs) -
    <a href="https://cicero.azavea.com/docs/district.html">/nonlegislative_district</a></li>
<li>get_map(*kwargs) -
    <a href="https://cicero.azavea.com/docs/map.html">/map</a></li>
<li>get_district_type() -
    <a href="https://cicero.azavea.com/docs/district_type.html">/district_type</a></li>
<li>get_account_credits_remaining() -
    <a href="https://cicero.azavea.com/docs/credits_remaining.html">/account/credits_remaining</a></li>
<li>get_account_usage(first_time="", second_time="") -
    <a href="https://cicero.azavea.com/docs/usage.html">/account/usage</a></li>
<li>get_version() -
    <a href="https://cicero.azavea.com/docs/version.html">/version</a></li>
</ul>
<h2>Queries and Keyword Arguments</h2>
<p>Most methods can take any number of optional keyword arguments (**kwargs).
These are the same as discussed in the Cicero documentation and the
"Arguments allowed in query" listed on each Cicero API endpoint's docs page.
This class will "urlencode" these optional arguments from what they are in
Python to standard URL query string parameters. So, you don't need to worry
about doing that.</p>
<p>Just make sure that they're valid Python arguments, like so:</p>
<ul>
<li>integers=1234 #like Cicero ID's, not enclosed in quotes</li>
<li>strings="Hi I'm a string!" #like addresses, dates, names, booleans, etc</li>
</ul>
<p>Most arguments you use should be strings or integers.</p>
<h2>Location queries</h2>
<p>Location based queries require location information. At a minimum, either
a street address, latitude and longitude (x/y) point, OR a fully-qualified
US, Canadian, or UK zip code and country code. See [the Cicero API docs]
(http://cicero.azavea.com/docs/query_by_location.html#querying-by-address)
for more info.</p>
<h2>Other Queries</h2>
<p>Additionally, the Cicero API allows wildcard, OR, and boolean queries.
(see https://cicero.azavea.com/docs/query.html for more info)
Python does not allow repeated keyword arguments to functions. To query
Cicero with an OR condition (which requires repeated arguments), use one
keyword but place your values in a sequence (a tuple or list), like so:</p>
<ul>
<li>get_official(search_loc="340 N 12th St, Philadelphia, PA, USA",
                 district_type=("STATE_LOWER", "STATE_UPPER"))</li>
</ul>
<p>To query Cicero with a boolean, use a string as you would in a URL, rather
than an actual Python boolean True/False value. Like so:</p>
<ul>
<li>get_election_event(is_by_election="true")</li>
</ul>
<p>Wildcards can be done with an asterisk(s) in the string, like this:</p>
<ul>
<li>get_official(last_name="<em>e</em>ning*")
    #would match "Jennings" and "Penington", for example</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">CiceroRestConnection</span><span class="p">(</span><span class="n">CiceroRestABC</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h1><strong>init</strong>(username, password)</h1>
<p>We initialize the CiceroRestConnection class with a username and
password. These are then encoded as POST data, and POSTED to the
TOKEN_ENDPOINT. The response contains a numerical User ID and a token,
(stored in self.user_id and self.token) which we use for
subsequent calls to the API.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>TODO: add functionality for API keys in addition to tokens</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">login_params</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span>
            <span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s">&#39;password&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span>
        <span class="p">})</span>

        <span class="k">try</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>getting a token is the only POST request in Cicero, so we will
POST the login_params rather than concatenating them to the
TOKEN_ENDPOINT</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">token_request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">TOKEN_ENDPOINT</span><span class="p">,</span> <span class="n">login_params</span><span class="p">)</span>
            <span class="n">token_response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">token_request</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">token_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">token_response</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">token_json</span><span class="p">[</span><span class="s">&#39;user&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">token_json</span><span class="p">[</span><span class="s">&#39;token&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">token_error_blob</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">token_error_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">token_error_blob</span><span class="p">)</span>
            <span class="n">token_error_dict</span><span class="p">[</span><span class="s">&#39;status_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span>
            <span class="k">raise</span> <span class="n">CiceroError</span><span class="p">(</span><span class="n">token_error_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="n">_NETWORK_ERROR</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <h1>get_election_event(**kwargs)</h1>
<p>Queries the Cicero API's election_event endpoint for information
on global election events. See
<a href="https://cicero.azavea.com/docs/election_event.html">the Cicero API documentation</a>
for more info and all valid query arguments.</p>
<p>Currently, calls made to the /election_event endpoint do not consume
credits. Consider it a "beta" feature with all the caveats that implies.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_election_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_from_endpoint</span><span class="p">(</span><span class="n">ELECTION_EVENT_ENDPOINT</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <h1>get_official(**kwargs)</h1>
<p>Queries the Cicero API's Official endpoint based on a search location,
Cicero unique id, or a last name. Queries by id and/or last_name are the
only supported queries that do not require a location.
See <a href="http://cicero.azavea.com/docs/official.html">the Cicero API docs</a>
for more info and all valid query arguments.</p>
<p>The default sorting order for Officials is alphabetical by last_name.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_official</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_from_endpoint</span><span class="p">(</span><span class="n">OFFICIAL_ENDPOINT</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <h1>get_legislative_district(**kwargs)</h1>
<p>Queries the Cicero API's /legislative_district endpoint for legislative
district info based on location, unique id, etc.</p>
<p>See <a href="https://cicero.azavea.com/docs/district.html">the Cicero API docs</a>
for more info and all valid query arguments.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_legislative_district</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_from_endpoint</span><span class="p">(</span><span class="n">LEGISLATIVE_DISTRICT_ENDPOINT</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <h1>get_nonlegislative_district(**kwargs)</h1>
<p>Queries the Cicero API's /nonlegislative_district endpoint for
nonlegislative district info based on location, unique id, etc.</p>
<p>See the <a href="https://cicero.azavea.com/docs/district.html">Cicero API docs</a>
for all valid query parameters.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_nonlegislative_district</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_from_endpoint</span><span class="p">(</span><span class="n">NONLEGISLATIVE_DISTRICT_ENDPOINT</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <h1>get_map(**kwargs)</h1>
<p>Queries the Cicero API's /map endpoint for an image map of a particular
district.</p>
<h2>Image data</h2>
<p>A semi-temporary URL to a hosted map image is always returned, but
will be deleted off Azavea's servers every several days. To return
base64-encoded text image data also (which you can cache indefinitely),
you can use the "include_image_data" query parameter. In Cicero API URLs,
this parameter needs no accompanying value
(ie:
    /map/2664?include_image_data
    or
    /map/STATE_EXEC/US/PA?fill_color=green&amp;include_image_data
).</p>
<p>However, due to how Python's urllib.urlencode() function handles
query parameters, to use the include_image_data parameter with this
Python wrapper, you must add an arbitrary value with include_image_data
as a key in the keyword arguments you pass to get_map().</p>
<p>We recommend:
    get_map(include_image_data=1, ...other arguments here...)
which will produce:
    /map?include_image_data=1&amp;other_arguments_here...
and happens to work just fine with the Cicero API :-)</p>
<h2>More info</h2>
<p>For more information on the /map call and other styling parameters,
see <a href="https://cicero.azavea.com/docs/map.html">the Cicero documentation</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_from_endpoint</span><span class="p">(</span><span class="n">MAP_ENDPOINT</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <h1>get_district_type()</h1>
<p>Queries the Cicero API's /district_type endpoint for more information
on what possible district types are available in the API and their
descriptions. Note not all district types may be available in all
geographic areas.</p>
<p>This API call consumes no credits and uses no arguments.</p>
<p>See <a href="https://cicero.azavea.com/docs/district_type.html">the Cicero API docs</a>
for more info.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_district_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="n">DISTRICT_TYPE_ENDPOINT</span> <span class="o">+</span> <span class="s">&#39;?user=&#39;</span> <span class="o">+</span>
               <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;token=&#39;</span> <span class="o">+</span>
               <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;f=json&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <h1>get_account_credits_remaining()</h1>
<p>Queries the Cicero API's /account/credits_remaining endpoint for information
about how many credits a user account has left, when they expire, and an
user's overdraft limit.</p>
<p>This API call consumes no credits and uses no arguments.</p>
<p>See <a href="https://cicero.azavea.com/docs/credits_remaining.html">the Cicero API docs</a>
for more info.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_account_credits_remaining</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="n">ACCOUNT_CREDITS_REMAINING_ENDPOINT</span> <span class="o">+</span>
               <span class="s">&#39;?user=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span>
               <span class="s">&#39;&amp;token=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&amp;f=json&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <h1>get_account_usage(first_time, second_time)</h1>
<p>Queries the Cicero API's /account/usage endpoint for information about
how many credits a user account has used by month and API call type for
a given period of time.</p>
<p>This API call consumes no credits.</p>
<h2>Time arguments</h2>
<p>The first_time argument is required, but the second_time argument (for
querying usage history over a range of years/months) is optional.
You may pass straight strings or use the keywords. If both time
arguments are used without keywords, the earlier time must come before
the later time. IE, Pythonic rules about arguments apply.</p>
<h3>Examples:</h3>
<pre><code>1. get_account_usage(first_time="YYYY") or get_account_usage("YYYY"):
    will return all available usage history in the given year.
2. get_account_usage(first_time="YYYY-MM") or get_account_usage("YYYY-MM"):
    will return all available usage history in the given month.
3. get_account_usage(first_time="YYYY-MM", second_time="YYYY-MM")
   get_account_usage(first_time="YYYY-MM", second_time="YYYY")
   get_account_usage(first_time="YYYY", second_time="YYYY-MM")
   get_account_usage(first_time="YYYY", second_time="YYYY")
   get_account_usage("2013-01", "2013-05")
   get_account_usage("2012-11", "2013")
   get_account_usage("2012", "2013-05")
   get_account_usage("2012", "2013")
    any of these will return usage history within the given timeframe.
</code></pre>
<p>See <a href="https://cicero.azavea.com/docs/usage.html">the Cicero API docs</a>
for more info.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_account_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_time</span><span class="p">,</span> <span class="n">second_time</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_time</span> <span class="o">+</span> <span class="s">&#39;/to/&#39;</span> <span class="o">+</span> <span class="n">second_time</span>
                <span class="k">if</span> <span class="n">second_time</span>
                <span class="k">else</span> <span class="n">first_time</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="n">ACCOUNT_USAGE_ENDPOINT</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span>
               <span class="s">&#39;?user=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">+</span>
               <span class="s">&#39;&amp;token=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span>
               <span class="s">&#39;&amp;f=json&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <h1>get_version()</h1>
<p>Queries Cicero to determine the current API version being used. Note,
the version that all of the ENDPOINT constants use is hardcoded into
their URLs in the cicero_endpoint_constants.py file.</p>
<p>This API call consumes no credits and uses no arguments.</p>
<p>See <a href="https://cicero.azavea.com/docs/version.html">the Cicero docs</a>
for more info.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">get_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">version_request_url</span> <span class="o">=</span> <span class="n">VERSION_ENDPOINT</span> <span class="o">+</span> <span class="s">&#39;?f=json&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_request</span><span class="p">(</span><span class="n">version_request_url</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
