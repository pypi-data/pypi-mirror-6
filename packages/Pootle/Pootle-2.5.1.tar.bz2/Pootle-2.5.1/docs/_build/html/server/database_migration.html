<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Database Migration &mdash; Pootle 2.5.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Pootle 2.5.1 documentation" href="../index.html" />
    <link rel="up" title="Administering a server" href="index.html" />
    <link rel="next" title="Settings" href="settings.html" />
    <link rel="prev" title="Upgrading" href="upgrading.html" /> 
  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Pootle</a>
        <span class="navbar-text pull-left"><b>2.5.1</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">User&#8217;s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administering a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Pootle API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_docs.html">External documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Database Migration</a><ul>
<li><a class="reference internal" href="#detailed-migration-process">Detailed Migration Process</a></li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="upgrading.html"
         title="previous chapter">&laquo; Upgrading</a></li>
  <li><a href="settings.html"
         title="next chapter">Settings &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="database-migration">
<span id="id1"></span><h1>Database Migration<a class="headerlink" href="#database-migration" title="Permalink to this headline">¶</a></h1>
<p>The default configuration for Pootle uses SQLite which is not really suited for
production use. If you started using SQLite and want to migrate to another
database system such as MySQL or PostgreSQL without recreating existing data,
you can perform a database migration using the steps described on this page.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A database migration is possible since Pootle 2.1.1. It is possible to do
the database migration using the version 2.0.6, which was specifically
added to allow database migration. This migration will only work with
Django 1.2 or later.</p>
</div>
<div class="section" id="detailed-migration-process">
<span id="database-migration-detailed-migration-process"></span><h2>Detailed Migration Process<a class="headerlink" href="#detailed-migration-process" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pootle 2.1.x and 2.5.x database can be very large. Dumping and loading data
will take long and will require lots of RAM. If you have a 2.0 install it
is better to migrate the database first and then upgrade to 2.5, since the
2.0 database is relatively small.</p>
</div>
<p>The steps to migrate between databases are as follows:</p>
<ol class="arabic">
<li><p class="first">Make <strong>complete backups</strong> of all your files, settings and databases.</p>
</li>
<li><p class="first">Ensure that you have:</p>
<ol class="arabic simple">
<li>At least Pootle 2.0.* or Pootle 2.1.*.</li>
<li>At least Django 1.2.0.</li>
</ol>
</li>
<li><p class="first">Don&#8217;t change the version of Pootle at any stage during this process.</p>
</li>
<li><p class="first">Read about how to run <a class="reference internal" href="commands.html"><em>management commands</em></a>.</p>
</li>
<li><p class="first">Stop the Pootle server to avoid data changing while you migrate.</p>
</li>
<li><p class="first">Leave current settings intact.</p>
</li>
<li><p class="first">Dump the data to a JSON file using the <strong class="command">dumpdata</strong> command. Note the
<em class="xref std std-option">-n</em> option.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle dumpdata -n &gt; data.json
</pre></div>
</div>
</li>
<li><p class="first">Create a new database for Pootle.</p>
</li>
<li><p class="first">Change <a class="reference internal" href="settings.html#settings"><em>your settings</em></a> to point at this new database.</p>
</li>
<li><p class="first">Initialize the new database using the <strong class="command">syncdb</strong> command.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sometimes not removing records introduced by <strong class="command">syncdb</strong> can
create problems. So if you experience any failure during
<strong class="command">loaddata</strong> execution that can&#8217;t be solved by any other mean,
then remove all the records from the new database while keeping the
tables intact.</p>
</div>
</li>
<li><p class="first">Load the data from the JSON file in the new database using the
<strong class="command">loaddata</strong> command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle loaddata ./data.json
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you experience any problem during <strong class="command">loaddata</strong> execution, you
may find it helps to instead export the data with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle dumpdata &gt; data.json
</pre></div>
</div>
<p class="last">avoiding the use of <em class="xref std std-option">-n</em> or <em class="xref std std-option">--natural</em> options.</p>
</div>
</li>
<li><p class="first">Restart the server; you should be running under the new database now.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some other problems reported during database migration may be solved by
commenting all signal calls in Pootle code during the database migration
process. If you do so, remember to uncomment them after the migration.</p>
</div>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2004-2014, Translate.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>