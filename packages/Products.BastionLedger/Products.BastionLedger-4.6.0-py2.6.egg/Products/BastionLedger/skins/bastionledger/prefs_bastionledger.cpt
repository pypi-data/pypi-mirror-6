<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="bastionledger">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<div metal:fill-slot="prefs_configlet_main"
     tal:define="tool nocall: context/portal_bastionledger;
                   utool context/@@plone_portal_state/portal_url;">

    <span tal:define="dummy python:request.response.setHeader('pragma','no-cache')" />

    <h1 i18n:translate="bastionledger_control">BastionLedger Control</h1>

    <form name="edit-form" action="" method="post"
          tal:attributes="action string:${here/getId}/${template/getId}">

       <fieldset>
   
          <legend>Configuration</legend>

          <div class="field"
               tal:define="currency request/currency | tool/currency">

            <label for="currency" 
                   i18n:translate="label_currency">Currency</label>

            <div class="formHelp" i18n:translate="help_currency">
               The currency <i>all</i> ledgers will be created with.
            </div>

            <select name="currency">
                <option tal:repeat="c tool/Currencies"
                        tal:content="c"
                        tal:attributes="selected python: c==currency"/>
            </select>

          </div>

          <div class="field"
               tal:define="chart request/chart | tool/chart | nothing"
               tal:condition="chart">

            <label for="chart" 
                   i18n:translate="label_chart">Chart</label>

            <div class="formHelp" i18n:translate="help_chart">
               The chart of accounts <i>all</i> ledgers will be created with.
            </div>

            <select name="chart">
                <option tal:repeat="c tool/availableCharts"
                        tal:content="python: c.split('/')[-1]"
                        tal:attributes="value c;
                                        selected python: c==chart"/>
            </select>

          </div>


          <div class="field"
               tal:define="jurisdictions request/jurisdictions | tool/jurisdictions | nothing"
                           tal:condition="python: jurisdictions is not None">

            <label for="currency" 
                   i18n:translate="label_jurisdictions">Jurisdictions</label>

            <div class="formHelp" i18n:translate="help_currency">
               The country/federal regulatory zone, perhaps with additional state requirements .
            </div>

            <select name="jurisdictions:list">
                <option tal:repeat="j python: tool.availableJurisdictions().keys()"
                        tal:content="j"
                        tal:attributes="selected python: j in jurisdictions"/>
            </select>

          </div>


          <input type="submit" class="context" name="form.button.Currency" value="Change"/>

      </fieldset>

      <table summary="">
        <tr tal:repeat="obj tool/objectValues">
           <td>
              <input type="checkbox" name="ids:list" value="" tal:attributes="value obj/getId"/>
           </td>
           <tal:block tal:define="url obj/absolute_url;
                          icon python: obj.getIcon(1)">
              <td>
                 <a href="#" tal:attributes="href url">
                     <img src="" alt=""
                          tal:attributes="src string:${utool}/${icon};alt context/pretty_title_or_id" />
                 </a>
              </td>
              <td>
                 <a href="#"  tal:attributes="href url" tal:content="obj/pretty_title_or_id" />
              </td>
            </tal:block>
        </tr>
      </table>

      <input type="submit" class="context" name="form.button.Delete" value="Delete"/>

      <input type="hidden" name="form.submitted" value="1" />

    </form>


</div>
</html>
