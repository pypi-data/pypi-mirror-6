

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration of pySAML2 entities &mdash; pysaml2 1.2.0beta documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.0beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pysaml2 1.2.0beta documentation" href="../index.html" />
    <link rel="up" title="How to use PySAML2" href="index.html" />
    <link rel="next" title="Base classes representing basic elements" href="../saml2.html" />
    <link rel="prev" title="How to use PySAML2" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../saml2.html" title="Base classes representing basic elements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="How to use PySAML2"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pysaml2 1.2.0beta documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">How to use PySAML2</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuration-of-pysaml2-entities">
<span id="howto-config"></span><h1>Configuration of pySAML2 entities<a class="headerlink" href="#configuration-of-pysaml2-entities" title="Permalink to this headline">¶</a></h1>
<p>Whether you plan to run a pySAML2 Service Provider, Identity provider or an
attribute authority you have to configure it. The format of the configuration
file is the same disregarding which type of service you plan to run.
What differs is some of the directives.
Below you will find a list of all the used directives in alphabetic order.
The configuration is written as a python module which contains a named
dictionary (&#8220;CONFIG&#8221;) that contains the configuration directives.</p>
<p>The basic structure of the configuration file is therefor like this:</p>
<div class="highlight-python"><pre>from saml2 import BINDING_HTTP_REDIRECT

CONFIG = {
    "entityid" : "http://saml.example.com:saml/idp.xml",
    "name" : "Rolands IdP",
    "service": {
        "idp": {
            "endpoints" : {
                "single_sign_on_service" : [
                        ("http://saml.example.com:saml:8088/sso",
                            BINDING_HTTP_REDIRECT)],
                "single_logout_service": [
                        ("http://saml.example.com:saml:8088/slo",
                            BINDING_HTTP_REDIRECT)]
            },
            ...
        }
    },
    "key_file" : "my.key",
    "cert_file" : "ca.pem",
    "xmlsec_binary" : "/usr/local/bin/xmlsec1",
    "metadata": {
        "local": ["edugain.xml"],
    },
    "attribute_map_dir" : "attributemaps",
    ...
}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can build the metadata file for your services directly from the
configuration.The make_metadata.py script in the pySAML2 tools directory
will do that for you.</p>
</div>
<div class="section" id="configuration-directives">
<h2>Configuration directives<a class="headerlink" href="#configuration-directives" title="Permalink to this headline">¶</a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#general-directives" id="id1">General directives</a><ul>
<li><a class="reference internal" href="#attribute-map-dir" id="id2">attribute_map_dir</a></li>
<li><a class="reference internal" href="#cert-file" id="id3">cert_file</a></li>
<li><a class="reference internal" href="#contact-person" id="id4">contact_person</a></li>
<li><a class="reference internal" href="#debug" id="id5">debug</a></li>
<li><a class="reference internal" href="#entityid" id="id6">entityid</a></li>
<li><a class="reference internal" href="#key-file" id="id7">key_file</a></li>
<li><a class="reference internal" href="#metadata" id="id8">metadata</a></li>
<li><a class="reference internal" href="#organization" id="id9">organization</a></li>
<li><a class="reference internal" href="#service" id="id10">service</a></li>
<li><a class="reference internal" href="#timeslack" id="id11">timeslack</a></li>
<li><a class="reference internal" href="#xmlsec-binary" id="id12">xmlsec_binary</a></li>
<li><a class="reference internal" href="#valid-for" id="id13">valid_for</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specific-directives" id="id14">Specific directives</a><ul>
<li><a class="reference internal" href="#idp-aa" id="id15">idp/aa</a><ul>
<li><a class="reference internal" href="#policy" id="id16">policy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sp" id="id17">sp</a><ul>
<li><a class="reference internal" href="#authn-requests-signed" id="id18">authn_requests_signed</a></li>
<li><a class="reference internal" href="#idp" id="id19">idp</a></li>
<li><a class="reference internal" href="#optional-attributes" id="id20">optional_attributes</a></li>
<li><a class="reference internal" href="#required-attributes" id="id21">required_attributes</a></li>
<li><a class="reference internal" href="#want-assertions-signed" id="id22">want_assertions_signed</a></li>
</ul>
</li>
<li><a class="reference internal" href="#idp-aa-sp" id="id23">idp/aa/sp</a><ul>
<li><a class="reference internal" href="#endpoints" id="id24">endpoints</a></li>
<li><a class="reference internal" href="#logout-requests-signed" id="id25">logout_requests_signed</a></li>
<li><a class="reference internal" href="#subject-data" id="id26">subject_data</a></li>
<li><a class="reference internal" href="#virtual-organization" id="id27">virtual_organization</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#complete-example" id="id28">Complete example</a></li>
</ul>
</div>
<div class="section" id="general-directives">
<h3><a class="toc-backref" href="#id1">General directives</a><a class="headerlink" href="#general-directives" title="Permalink to this headline">¶</a></h3>
<div class="section" id="attribute-map-dir">
<h4><a class="toc-backref" href="#id2">attribute_map_dir</a><a class="headerlink" href="#attribute-map-dir" title="Permalink to this headline">¶</a></h4>
<p>Format:</p>
<div class="highlight-python"><pre>"attribute_map_dir": "attribute-maps"</pre>
</div>
<p>Points to a directory which has the attribute maps in Python modules.
A typical map file will looks like this:</p>
<div class="highlight-python"><pre>MAP = {
    "identifier": "urn:oasis:names:tc:SAML:2.0:attrname-format:basic",
    "fro": {
        'urn:mace:dir:attribute-def:aRecord': 'aRecord',
        'urn:mace:dir:attribute-def:aliasedEntryName': 'aliasedEntryName',
        'urn:mace:dir:attribute-def:aliasedObjectName': 'aliasedObjectName',
        'urn:mace:dir:attribute-def:associatedDomain': 'associatedDomain',
        'urn:mace:dir:attribute-def:associatedName': 'associatedName',
        ...
        },
    "to": {
        'aRecord': 'urn:mace:dir:attribute-def:aRecord',
        'aliasedEntryName': 'urn:mace:dir:attribute-def:aliasedEntryName',
        'aliasedObjectName': 'urn:mace:dir:attribute-def:aliasedObjectName',
        'associatedDomain': 'urn:mace:dir:attribute-def:associatedDomain',
        'associatedName': 'urn:mace:dir:attribute-def:associatedName',
        ...
    }
}</pre>
</div>
<p>The attribute map module contains a MAP dictionary with three items.  The
<cite>identifier</cite> item is the name-format you expect to support.
The <em>to</em> and <em>fro</em> sub-dictionaries then contain the mapping between the names.</p>
<p>As you see the format is again a python dictionary where the key is the
name to convert from and the value is the name to convert to.</p>
<p>Since <em>to</em> in most cases are the inverse of the <em>fro</em> file, the
software allowes you to only specify one of them and it will
automatically create the other.</p>
</div>
<div class="section" id="cert-file">
<h4><a class="toc-backref" href="#id3">cert_file</a><a class="headerlink" href="#cert-file" title="Permalink to this headline">¶</a></h4>
<p>Format:</p>
<div class="highlight-python"><pre>cert_file: "cert.pem"</pre>
</div>
<p>This is the public part of the service private/public key pair.
<em>cert_file</em> must be a PEM formatted certificate chain file.</p>
</div>
<div class="section" id="contact-person">
<h4><a class="toc-backref" href="#id4">contact_person</a><a class="headerlink" href="#contact-person" title="Permalink to this headline">¶</a></h4>
<p>This is only used by <em>make_metadata.py</em> when it constructs the metadata for
the service described by the configuration file.
This is where you described who can be contacted if questions arises
about the service or if support is needed. The possible types are according to
the standard <strong>technical</strong>, <strong>support</strong>, <strong>administrative</strong>, <strong>billing</strong>
and <strong>other</strong>.:</p>
<div class="highlight-python"><pre>contact_person: [{
    "givenname": "Derek",
    "surname": "Jeter",
    "company": "Example Co.",
    "mail": ["jeter@example.com"],
    "type": "technical",
},{
    "givenname": "Joe",
    "surname": "Girardi",
    "company": "Example Co.",
    "mail": "girardi@example.com",
    "type": "administrative",
}]</pre>
</div>
</div>
<div class="section" id="debug">
<h4><a class="toc-backref" href="#id5">debug</a><a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h4>
<p>Format:</p>
<div class="highlight-python"><pre>debug: 1</pre>
</div>
<p>Whether debug information should be sent to the log file.</p>
</div>
<div class="section" id="entityid">
<h4><a class="toc-backref" href="#id6">entityid</a><a class="headerlink" href="#entityid" title="Permalink to this headline">¶</a></h4>
<p>Format:</p>
<div class="highlight-python"><pre>entityid: "http://saml.example.com/sp"</pre>
</div>
<p>The globally unique identifier of the entity.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is a recommendation that the entityid should point to a real
webpage where the metadata for the entity can be found.</p>
</div>
</div>
<div class="section" id="key-file">
<h4><a class="toc-backref" href="#id7">key_file</a><a class="headerlink" href="#key-file" title="Permalink to this headline">¶</a></h4>
<p>Format:</p>
<div class="highlight-python"><pre>key_file: "key.pem"</pre>
</div>
<p><em>key_file</em> is the name of a PEM formatted file that contains the private key
of the service. This is presently used both to encrypt/sign assertions and as
client key in a HTTPS session.</p>
</div>
<div class="section" id="metadata">
<h4><a class="toc-backref" href="#id8">metadata</a><a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h4>
<p>Contains a list of places where metadata can be found. This can be either
a file accessible on the server the service runs on or somewhere on the net.:</p>
<div class="highlight-python"><pre>"metadata" : {
    "local": [
        "metadata.xml", "vo_metadata.xml"
        ],
    "remote": [
        {
            "url":"https://kalmar2.org/simplesaml/module.php/aggregator/?id=kalmarcentral2&amp;set=saml2",
            "cert":"kalmar2.cert"
        }],
},</pre>
</div>
<p>The above configuration means that the service should read two local
metadata files and on top of that load one from the net. To verify the
authenticity of the file downloaded from the net the local copy of the
public key should be used.
This public key must be acquired by some out-of-band method.</p>
</div>
<div class="section" id="organization">
<h4><a class="toc-backref" href="#id9">organization</a><a class="headerlink" href="#organization" title="Permalink to this headline">¶</a></h4>
<p>Only used by <em>make_metadata.py</em>.
Where you describe the organization responsible for the service.:</p>
<div class="highlight-python"><pre>"organization": {
    "name": [("Example Company","en"), ("Exempel AB","se")],
    "display_name": ["Exempel AB"],
    "url": [("http://example.com","en"),("http://exempel.se","se")],
}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can specify the language of the name, or the language used on
the webpage, by entering a tuple, instead of a simple string,
where the second part is the language code. If you don&#8217;t specify a
language the default is &#8220;en&#8221; (English).</p>
</div>
</div>
<div class="section" id="service">
<h4><a class="toc-backref" href="#id10">service</a><a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h4>
<p>Which services the server will provide, those are combinations of &#8220;idp&#8221;,&#8221;sp&#8221;
and &#8220;aa&#8221;.
So if a server is a Service Provider (SP) then the configuration
could look something like this:</p>
<div class="highlight-python"><pre>"service": {
    "sp":{
        "name" : "Rolands SP",
        "endpoints":{
            "assertion_consumer_service": ["http://localhost:8087/"],
            "single_logout_service" : [("http://localhost:8087/slo",
                           'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect')],
        },
        "required_attributes": ["surname", "givenname", "edupersonaffiliation"],
        "optional_attributes": ["title"],
        "idp": {
            "urn:mace:umu.se:saml:roland:idp": None,
        },
    }
},</pre>
</div>
<p>There are two options common to all services: &#8216;name&#8217; and &#8216;endpoints&#8217;.
The remaining options are specific to one or the other of the service types.
Which one is specified along side the name of the option</p>
</div>
<div class="section" id="timeslack">
<h4><a class="toc-backref" href="#id11">timeslack</a><a class="headerlink" href="#timeslack" title="Permalink to this headline">¶</a></h4>
<p>If your computer and another computer that you are communicating with are not
in synch regarding the computer clock. Then you here can state how big a
difference you are prepared to accept.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This will indiscriminately effect all time comparisons.
Hence your server my accept a statement that in fact is to old.</p>
</div>
</div>
<div class="section" id="xmlsec-binary">
<h4><a class="toc-backref" href="#id12">xmlsec_binary</a><a class="headerlink" href="#xmlsec-binary" title="Permalink to this headline">¶</a></h4>
<p>Presently xmlsec1 binaries are used for all the signing and encryption stuff.
This option defines where the binary is situated.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"xmlsec_binary": "/usr/local/bin/xmlsec1",</pre>
</div>
</div>
<div class="section" id="valid-for">
<h4><a class="toc-backref" href="#id13">valid_for</a><a class="headerlink" href="#valid-for" title="Permalink to this headline">¶</a></h4>
<p>How many <em>hours</em> this configuration is expected to be accurate.:</p>
<div class="highlight-python"><pre>"valid_for": 24</pre>
</div>
<p>This of course is only used by <em>make_metadata.py</em>.
The server will not stop working when this amount of time has elapsed :-).</p>
</div>
</div>
<div class="section" id="specific-directives">
<h3><a class="toc-backref" href="#id14">Specific directives</a><a class="headerlink" href="#specific-directives" title="Permalink to this headline">¶</a></h3>
<p>Directives that are specific to a certain type of service.</p>
<div class="section" id="idp-aa">
<h4><a class="toc-backref" href="#id15">idp/aa</a><a class="headerlink" href="#idp-aa" title="Permalink to this headline">¶</a></h4>
<p>Directives that are specific to an IdP or AA service instance</p>
<div class="section" id="policy">
<h5><a class="toc-backref" href="#id16">policy</a><a class="headerlink" href="#policy" title="Permalink to this headline">¶</a></h5>
<p>If the server is an IdP and/or an AA then there might be reasons to do things
differently depending on who is asking; this is where that is specified.
The keys are &#8216;default&#8217; and SP entity identifiers, default is used whenever
there is no entry for a specific SP. The reasoning is also that if there is
no default and only SP entity identifiers as keys, then the server will only
except connections from the specified SPs.
An example might be:</p>
<div class="highlight-python"><pre>"service": {
    "idp": {
        "policy": {
            "default": {
                "lifetime": {"minutes":15},
                "attribute_restrictions": None, # means all I have
                "name_form": "urn:oasis:names:tc:SAML:2.0:attrname-format:uri"
            },
            "urn:mace:example.com:saml:roland:sp": {
                "lifetime": {"minutes": 5},
                "attribute_restrictions":{
                    "givenName": None,
                    "surName": None,
                }
            }
        }
    }
}</pre>
</div>
<dl class="docutils">
<dt><em>lifetime</em></dt>
<dd>is the maximum amount of time before the information should be
regarded as stale. In an Assertion this is represented in the NotOnOrAfter
attribute.</dd>
<dt><em>attribute_restrictions</em></dt>
<dd>By default there is no restrictions as to which attributes should be
return. Instead all the attributes and values that is gathered by the
database backends will be returned if nothing else is stated.
In the example above the SP with the entity identifier
&#8220;<a class="reference external" href="urn:mace:umu.se:saml:roland:sp">urn:mace:umu.se:saml:roland:sp</a>&#8221;
has an attribute restriction: only the attributes
&#8216;givenName&#8217; and &#8216;surName&#8217; are to be returned. There is no limitations as to
what values on these attributes that can be returned.</dd>
<dt><em>name_form</em></dt>
<dd>Which name-form that should be used when sending assertions.</dd>
</dl>
<p>If restrictions on values are deemed necessary those are represented by
regular expressions.:</p>
<div class="highlight-python"><pre>"service": {
    "aa": {
        "policy": {
            "urn:mace:umu.se:saml:roland:sp": {
                "lifetime": {"minutes": 5},
                "attribute_restrictions":{
                     "mail": [".*\.umu\.se$"],
                }
            }
        }
    }
}</pre>
</div>
<p>Here only mail addresses that ends with &#8221;.umu.se&#8221; will be returned.</p>
</div>
</div>
<div class="section" id="sp">
<h4><a class="toc-backref" href="#id17">sp</a><a class="headerlink" href="#sp" title="Permalink to this headline">¶</a></h4>
<p>Directives specific to SP instances</p>
<div class="section" id="authn-requests-signed">
<h5><a class="toc-backref" href="#id18">authn_requests_signed</a><a class="headerlink" href="#authn-requests-signed" title="Permalink to this headline">¶</a></h5>
<p>Indicates if the Authentication Requests sent by this SP should be signed
by default. This can be overriden by application code for a specific call.</p>
<p>This set the AuthnRequestsSigned attribute of the SPSSODescriptor node.
of the metadata so the IdP will know this SP preference.</p>
<p>Valid values are &#8220;true&#8221; or &#8220;false&#8221;. Default value is &#8220;false&#8221;.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "authn_assertions_signed": "true",
    }
}</pre>
</div>
</div>
<div class="section" id="idp">
<h5><a class="toc-backref" href="#id19">idp</a><a class="headerlink" href="#idp" title="Permalink to this headline">¶</a></h5>
<p>Defines the set of IdPs that this SP is allowed to use. If not all the IdPs in
the metadata is allowed, then the value is expected to be a list with entity
identifiers for the allowed IdPs.
A typical configuration, when the allowed set of IdPs are limited, would look
something like this:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "idp": ["urn:mace:umu.se:saml:roland:idp"],
    }
}</pre>
</div>
<p>In this case the SP has only one IdP it can use.</p>
<p>If all IdPs present in the metadata loaded this directive must be left out.</p>
</div>
<div class="section" id="optional-attributes">
<h5><a class="toc-backref" href="#id20">optional_attributes</a><a class="headerlink" href="#optional-attributes" title="Permalink to this headline">¶</a></h5>
<p>Attributes that this SP would like to receive from IdPs.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "optional_attributes": ["title"],
    }
}</pre>
</div>
<p>Since the attribute names used here are the user friendly ones an attribute map
must exist, so that the server can use the full name when communicating
with other servers.</p>
</div>
<div class="section" id="required-attributes">
<h5><a class="toc-backref" href="#id21">required_attributes</a><a class="headerlink" href="#required-attributes" title="Permalink to this headline">¶</a></h5>
<p>Attributes that this SP demands to receive from IdPs.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "required_attributes": ["surname", "givenName", "mail"],
    }
}</pre>
</div>
<p>Again as for <em>optional_attributes</em> the names given are expected to be
the user friendly names.</p>
</div>
<div class="section" id="want-assertions-signed">
<h5><a class="toc-backref" href="#id22">want_assertions_signed</a><a class="headerlink" href="#want-assertions-signed" title="Permalink to this headline">¶</a></h5>
<p>Indicates if this SP wants the IdP to send the assertions signed. This
set the WantAssertionsSigned attribute of the SPSSODescriptor node.
of the metadata so the IdP will know this SP preference.</p>
<p>Valid values are &#8220;true&#8221; or &#8220;false&#8221;. Default value is &#8220;true&#8221;.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "want_assertions_signed": "true",
    }
}</pre>
</div>
</div>
</div>
<div class="section" id="idp-aa-sp">
<h4><a class="toc-backref" href="#id23">idp/aa/sp</a><a class="headerlink" href="#idp-aa-sp" title="Permalink to this headline">¶</a></h4>
<p>If the configuration is covering both two or three different service types
(like if one server is actually acting as both an IdP and a SP) then in some
cases you might want to have these below different for the different services.</p>
<div class="section" id="endpoints">
<h5><a class="toc-backref" href="#id24">endpoints</a><a class="headerlink" href="#endpoints" title="Permalink to this headline">¶</a></h5>
<p>Where the endpoints for the services provided are.
This directive has as value a dictionary with one of the following keys:</p>
<ul class="simple">
<li>artifact_resolution_service (aa, idp and sp)</li>
<li>assertion_consumer_service (sp)</li>
<li>assertion_id_request_service (aa, idp)</li>
<li>attribute_service (aa)</li>
<li>manage_name_id_service (aa, idp)</li>
<li>name_id_mapping_service (idp)</li>
<li>single_logout_service (aa, idp, sp)</li>
<li>single_sign_on_service (idp)</li>
</ul>
<p>The values per service is a list of tuples containing endpoint and binding
type.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service":
    "idp": {
        "endpoints" : {
            "single_sign_on_service" : [
                    ("http://localhost:8088/sso", BINDING_HTTP_REDIRECT)],
            "single_logout_service": [
                    ("http://localhost:8088/slo", BINDING_HTTP_REDIRECT)]
        },
    },
},</pre>
</div>
</div>
<div class="section" id="logout-requests-signed">
<h5><a class="toc-backref" href="#id25">logout_requests_signed</a><a class="headerlink" href="#logout-requests-signed" title="Permalink to this headline">¶</a></h5>
<p>Indicates if this entity will sign the Logout Requests originated from it.</p>
<p>This can be overriden by application code for a specific call.</p>
<p>Valid values are &#8220;true&#8221; or &#8220;false&#8221;. Default value is &#8220;false&#8221;</p>
<p>Example:</p>
<div class="highlight-python"><pre>"service": {
    "sp": {
        "logout_requests_signed": "true",
    }
}</pre>
</div>
</div>
<div class="section" id="subject-data">
<h5><a class="toc-backref" href="#id26">subject_data</a><a class="headerlink" href="#subject-data" title="Permalink to this headline">¶</a></h5>
<p>The name of a database where the map between a local identifier and
a distributed identifier is kept. By default this is a shelve database.
So if you just specify name, then a shelve database with that name
is created. On the other hand if you specify a tuple then the first
element in the tuple specifise which type of database you want to use
and the second element is the address of the database.</p>
<p>Example:</p>
<div class="highlight-python"><pre>"subject_data": "./idp.subject.db",</pre>
</div>
<p>or if you want to use for instance memcache:</p>
<div class="highlight-python"><pre>"subject_data": ("memcached", "localhost:12121"),</pre>
</div>
<p><em>shelve</em> and <em>memcached</em> are the only database types that are presently
supported.</p>
</div>
<div class="section" id="virtual-organization">
<h5><a class="toc-backref" href="#id27">virtual_organization</a><a class="headerlink" href="#virtual-organization" title="Permalink to this headline">¶</a></h5>
<p>Gives information about common identifiers for virtual_organizations:</p>
<div class="highlight-python"><pre>"virtual_organization" : {
    "urn:mace:example.com:it:tek":{
        "nameid_format" : "urn:oid:1.3.6.1.4.1.1466.115.121.1.15-NameID",
        "common_identifier": "umuselin",
    }
},</pre>
</div>
<p>Keys in this dictionary are the identifiers for the virtual organizations.
The arguments per organization is &#8216;nameid_format&#8217; and &#8216;common_identifier&#8217;.
Useful if all the IdPs and AAs that are involved in a virtual organization
have common attribute values for users that are part of the VO.</p>
</div>
</div>
</div>
<div class="section" id="complete-example">
<h3><a class="toc-backref" href="#id28">Complete example</a><a class="headerlink" href="#complete-example" title="Permalink to this headline">¶</a></h3>
<p>We start with a simple but fairly complete Service provider configuration:</p>
<div class="highlight-python"><pre>from saml2 import BINDING_HTTP_REDIRECT

CONFIG = {
    "entityid" : "http://example.com/sp/metadata.xml",
    "service": {
        "sp":{
            "name" : "Example SP",
            "endpoints":{
                "assertion_consumer_service": ["http://example.com/sp"],
                "single_logout_service" : [("http://example.com/sp/slo",
                                            BINDING_HTTP_REDIRECT)],
            },
        }
    },
    "key_file" : "./mykey.pem",
    "cert_file" : "./mycert.pem",
    "xmlsec_binary" : "/usr/local/bin/xmlsec1",
    "attribute_map_dir": "./attributemaps",
    "metadata": {
        "local": ["idp.xml"]
    }
    "organization": {
        "display_name":["Example identities"]
    }
    "contact_person": [{
        "givenname": "Roland",
        "surname": "Hedberg",
        "phone": "+46 90510",
        "mail": "roland@example.com",
        "type": "technical",
        }]
}</pre>
</div>
<p>This is the typical setup for a SP.
A metadata file to load is <em>always</em> needed, but it can of course be
containing anything from 1 up to many entity descriptions.</p>
<hr class="docutils" />
<p>A slightly more complex configuration:</p>
<div class="highlight-python"><pre>from saml2 import BINDING_HTTP_REDIRECT

CONFIG = {
    "entityid" : "http://sp.example.com/metadata.xml",
    "service": {
        "sp":{
            "name" : "Example SP",
            "endpoints":{
                "assertion_consumer_service": ["http://sp.example.com/"],
                "single_logout_service" : [("http://sp.example.com/slo",
                               BINDING_HTTP_REDIRECT)],
            },
            "subject_data": ("memcached", "localhost:12121"),
            "virtual_organization" : {
                "urn:mace:example.com:it:tek":{
                    "nameid_format" : "urn:oid:1.3.6.1.4.1.1466.115.121.1.15-NameID",
                    "common_identifier": "eduPersonPrincipalName",
                }
            },
        }
    },
    "key_file" : "./mykey.pem",
    "cert_file" : "./mycert.pem",
    "xmlsec_binary" : "/usr/local/bin/xmlsec1",
    "metadata" : {
        "local": ["example.xml"],
        "remote": [{
            "url":"https://kalmar2.org/simplesaml/module.php/aggregator/?id=kalmarcentral2&amp;set=saml2",
            "cert":"kalmar2.pem"}]
    },
    "attribute_maps" : "attributemaps",
    "organization": {
        "display_name":["Example identities"]
    }
    "contact_person": [{
        "givenname": "Roland",
        "surname": "Hedberg",
        "phone": "+46 90510",
        "mail": "roland@example.com",
        "type": "technical",
        }]
}</pre>
</div>
<p>Uses metadata files, both local and remote, and will talk to whatever
IdP that appears in any of the metadata files.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuration of pySAML2 entities</a><ul>
<li><a class="reference internal" href="#configuration-directives">Configuration directives</a><ul>
<li><a class="reference internal" href="#general-directives">General directives</a><ul>
<li><a class="reference internal" href="#attribute-map-dir">attribute_map_dir</a></li>
<li><a class="reference internal" href="#cert-file">cert_file</a></li>
<li><a class="reference internal" href="#contact-person">contact_person</a></li>
<li><a class="reference internal" href="#debug">debug</a></li>
<li><a class="reference internal" href="#entityid">entityid</a></li>
<li><a class="reference internal" href="#key-file">key_file</a></li>
<li><a class="reference internal" href="#metadata">metadata</a></li>
<li><a class="reference internal" href="#organization">organization</a></li>
<li><a class="reference internal" href="#service">service</a></li>
<li><a class="reference internal" href="#timeslack">timeslack</a></li>
<li><a class="reference internal" href="#xmlsec-binary">xmlsec_binary</a></li>
<li><a class="reference internal" href="#valid-for">valid_for</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specific-directives">Specific directives</a><ul>
<li><a class="reference internal" href="#idp-aa">idp/aa</a><ul>
<li><a class="reference internal" href="#policy">policy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sp">sp</a><ul>
<li><a class="reference internal" href="#authn-requests-signed">authn_requests_signed</a></li>
<li><a class="reference internal" href="#idp">idp</a></li>
<li><a class="reference internal" href="#optional-attributes">optional_attributes</a></li>
<li><a class="reference internal" href="#required-attributes">required_attributes</a></li>
<li><a class="reference internal" href="#want-assertions-signed">want_assertions_signed</a></li>
</ul>
</li>
<li><a class="reference internal" href="#idp-aa-sp">idp/aa/sp</a><ul>
<li><a class="reference internal" href="#endpoints">endpoints</a></li>
<li><a class="reference internal" href="#logout-requests-signed">logout_requests_signed</a></li>
<li><a class="reference internal" href="#subject-data">subject_data</a></li>
<li><a class="reference internal" href="#virtual-organization">virtual_organization</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#complete-example">Complete example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">How to use PySAML2</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../saml2.html"
                        title="next chapter">Base classes representing basic elements</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/howto/config.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../saml2.html" title="Base classes representing basic elements"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="How to use PySAML2"
             >previous</a> |</li>
        <li><a href="../index.html">pysaml2 1.2.0beta documentation</a> &raquo;</li>
          <li><a href="index.html" >How to use PySAML2</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2011, Roland Hedberg.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>