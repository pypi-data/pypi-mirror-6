<html tal:replace="structure context/manage_page_header"/>

<script type="text/javascript">
<!-- 

isSelected = false;

function toggleSelect() {
  if (isSelected == false) {
    for (i = 0; i < document.objectItems.length; i++)
      document.objectItems.elements[i].checked = true ;
    isSelected = true;
    document.objectItems.selectButton.value = "Deselect All";
    return isSelected;
  }
  else {
    for (i = 0; i < document.objectItems.length; i++)
      document.objectItems.elements[i].checked = false ;
    isSelected = false;
    document.objectItems.selectButton.value = "Select All";
    return isSelected;       
  }
}

//-->
</script>

    <span tal:replace="structure context/manage_tabs"/>

    <table width="100%" cellpadding="5" cellspacing="0" border="0"
           tal:define="now python:DateTime(); 
                       calendar_date request/form/date | now;
                       payroll_date python: context.getPayrollDay(calendar_date);
                       payroll python:context.getPayroll(payroll_date)">
      <tr>
         <td valign="top" width="25%">
             <table border="0" cellpadding="2" cellspacing="0" height="100%">
                <tr><td valign="top" tal:content="structure context/display_calendar"/></tr>
                <tr><td>&nbsp;</td></tr>
             </table>
         </td>
         <td valign="top" align="left">

               <div class="form-label">
                   Payroll For Week Ending <span tal:content="python:payroll_date.strftime('%A %B %d, %Y')"/>
               </div>


             <form action="" name="objectItems" 
                   tal:attributes="action request/URL1" method="post">

               <table border="0" cellpadding="3" cellspacing="0" width="100%">
                  <tr class="list-header">
                      <td width="16">&nbsp;</td>
                      <td width="40">&nbsp;</td>
                      <td width="40%"  class="list-item">Employee</td>
                      <td width="20%" class="list-item">Started</td>
                      <td width="15%" class="list-item">Timesheet</td>
                      <td width="15%" class="list-item">Payroll</td>
                  </tr>
                  <div tal:repeat="employee python: context.accountValues(status='open')">
                    <tr tal:define="timesheet_status python: employee.getTimesheetStatus(payroll_date)">
                      <td class="list-item">
                         <input type="checkbox" name="ids:list" value="" tal:attributes="value employee/getId">
                      </td>
                      <td class="list-item"><img src="" tal:attributes="src employee/icon"/></td>
                      <td class="list-item">
                         <a href="" tal:attributes="href string:${employee/getId}/manage_workspace"  
                                  tal:content="employee/title"/>
                      </td>
                      <td class="list-item" tal:content="python: employee.start_day.strftime('%Y/%m/%d')"/>
                      <td class="list-item" tal:content="timesheet_status"/>
                      <td class="list-item" tal:content="python: payroll.has_key(employee.getId()) and 'run' or 'not run'"/>
                    </tr>
                  </div>
               </table>
                    <input type="submit" class="context" name="manage_payEmployees:method" value=" Pay "/>
                    <input class="stand-alone" type="submit" name="selectButton" value="Select All"
                           onClick="toggleSelect(); return false" />
                    <input type="hidden" name="effective:date" value="" tal:attributes="value payroll_date">
             </form>

         </td>
      </tr>
    </table>

<html tal:replace="structure context/manage_page_footer"/>
