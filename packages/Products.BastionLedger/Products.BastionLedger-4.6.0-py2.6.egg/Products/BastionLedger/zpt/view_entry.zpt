<html tal:replace="structure context/manage_page_header"/>
     <span tal:replace="structure context/manage_tabs"/>

      <br/>

      <table cellspacing="0" cellpadding="2" border="0" 
             tal:define="txn context/blTransaction">
           <tr>
                  <td class="form-label">Id</td>
                  <td class="form-element">
                     <a href="" tal:condition="nocall: txn"
                        tal:attributes="href string:${txn/absolute_url}/manage_workspace"
                        tal:content="context/getId"/>
                     <span tal:condition="python: not txn" tal:replace="context/getId"/>
                   </td>
           </tr>
           <tr>
                  <td class="form-label">Effective Date</td>
                  <td class="form-element" 
                      tal:content="python: context.meta_type=='BLControlEntry' and context.lastTransactionDate() or context.effective()"/>
           </tr>
           <tr>
                  <td class="form-label">Description</td>
                  <td class="form-element" tal:content="context/title" tal:on-error="string:"/>
           </tr>
           <tr>
                  <td class="form-label">Account</td>
                  <td class="form-element" tal:define="account context/blAccount">
                      <span tal:replace="context/accountId"/>
                      <a href="" tal:condition="nocall: account" 
                         tal:attributes="href string:${account/absolute_url}/manage_workspace"
                         tal:content="account/prettyTitle"/>
                      <span tal:condition="python: not account" tal:replace="context/account"/>
                  </td>
           </tr>
           <tr>
                  <td class="form-label">Amount</td>
                  <td class="form-element" tal:content="context/amount" tal:on-error="string:"/>
           </tr>
           <tr tal:define="ref context/reference" tal:condition="python: ref">
                  <td class="form-label">Reference</td>
                  <td class="form-element" tal:define="anchor python: getattr(ref, 'meta_type', None)">
                      <span tal:condition="not: anchor" tal:content="ref"/>
                      <a tal:condition="anchor" tal:content="ref/getId"
                         tal:attributes="href python: '%s/manage_workspace' % ref.absolute_url(1)"/>
                  </td>
           </tr>
           <tr tal:define="ledger context/blLedger">
                  <td class="form-label">Ledger</td>
                  <td class="form-element">
                      <a href="" tal:attributes="href string: ${ledger/absolute_url}/manage_workspace"
                                 tal:content="ledger/getId"/>
                  </td>
           </tr>
           <tr tal:condition="nocall: txn">
                  <td class="form-label">Transaction</td>
                  <td class="form-element">
                      <a href="" tal:attributes="href string: ${txn/absolute_url}/manage_workspace"
                                 tal:content="txn/getId"/>
                  </td>
           </tr>
           <tr tal:condition="context/fx_rate | nothing">
                  <td class="form-label">FX Conversion Rate</td>
                  <td class="form-element" tal:content="context/fx_rate"/>
           </tr>
           <tr tal:condition="context/posted_amount | nothing">
                  <td class="form-label">Posted Amount</td>
                  <td class="form-element" tal:content="context/posted_amount"/>
           </tr>
           <tr>
                  <td class="form-label">Status</td>
                  <td class="form-element" tal:content="context/status"/>
           </tr>
      </table>

<html tal:replace="structure context/manage_page_footer"/>




