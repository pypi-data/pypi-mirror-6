<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="bastionledger">
 
<body>
  <div metal:fill-slot="main"
       tal:define="errors options/state/getErrors;
                   utool context/@@plone_portal_state/portal_url;
                   periods context/getTimesheetSlots">
      <h1><img src="" alt="" tal:define="icon python:context.getIcon(1)" 
               tal:attributes="src string:${utool}/${icon}">Timesheet Configuration</h1>

       <form name="edit" action="" method="post"
            tal:attributes="action string:${context/getId}/${template/getId}">
    
           <fieldset>
              <legend>Settings</legend>

            <div tal:define="error errors/timesheet_day|nothing;
                             timesheet_day request/timesheet_day | context/timesheet_day"
                 tal:attributes="class python:error and 'field error' or 'field'">

               <label for="timesheet_day" 
                      i18n:translate="label_timesheet_day">Timesheet Day</label>

               <span class="fieldRequired" title="Required"
                     i18n:attributes="title"
                     i18n:translate="label_required">(Required)</span>

               <div tal:content="error">Validation error output</div>

               <div class="formHelp" i18n:translate="help_timesheet_day">
                    The day of week which timesheets are to be submitted, and payroll run
               </div>

               <select name="timesheet_day">
                   <option tal:repeat="dow context/selectDayOfWeek"
                           tal:content="dow"
                           tal:attributes="selected python: timesheet_day==dow and  1 or 0"/>
               </select>

             </div>

            <div tal:define="error errors/timesheets_required|nothing;
                             timesheets_required request/timesheets_required | context/timesheets_required | nothing"
                 tal:attributes="class python:error and 'field error' or 'field'">

               <label for="timesheets_required" 
                      i18n:translate="label_timesheets_required">Timesheets Required</label>

               <span class="fieldRequired" title="Required"
                     i18n:attributes="title"
                     i18n:translate="label_required">(Required)</span>

               <div tal:content="error">Validation error output</div>

               <div class="formHelp" i18n:translate="help_timesheets_required">
                     Whether or not employees <b>must</b> submit a timesheet in order for their payroll to be run. Salaried
                     staff may not need to submit a timesheet.
               </div>

               <input type="checkbox" name="timesheets_required:boolean" value="1"
                      tal:attributes="checked python:timesheets_required and 1 or 0; "/>

             </div>

              <input class="context" type="submit" name="form.button.Settings" value=" Change "/>

           </fieldset>

           <fieldset>
              <legend>Periods</legend>

              <table cellpadding="2" cellspacing="0" summary="">
                 <tr>
                     <th/>
                     <th/>
                     <th/>
                     <th>Ratio</th>
                     <th>Min Hrs</th>
                     <th>Max Hrs</th>
                     <th/>
                     <th tal:repeat="day context/selectDayOfWeek" tal:content="python: day[:3]"/>
                 </tr>
                 <tr tal:repeat="period periods">
                     <td><input type="checkbox" name="ids:list" value="" 
                                tal:attributes="value period/getId"/></td>
                     <td><img src="" alt="period" tal:define="icon python: period.getIcon(1)"
                              tal:attributes="src string:${utool}/${icon}"/></td>
                     <td><input type="hidden" name="period.id:records" value="" 
                                tal:attributes="value period/getId"/>
                         <input type="text" name="period.title:records" size="20" 
                                tal:attributes="value period/title"/></td>
                     <td align="center">
                         <input type="text" name="period.ratio:records" size="4" 
                                tal:attributes="value period/ratio"/>
                     </td>
                     <td align="center">
                         <input type="text" name="period.min_hrs:records" size="4"
                                tal:attributes="value period/min_hrs"/>
                     </td>
                     <td align="center">
                         <input type="text" name="period.max_hrs:records" size="4"
                                tal:attributes="value period/max_hrs"/>
                     </td>
                     <td/>
                     <td align="center" tal:repeat="default period/defaults">
                         <input type="text" name="period.defaults:list:records" size="4"
                                tal:attributes="value default"/>
                     </td>
                 </tr>
                 <tr>
                     <td colspan="14">
                         <input class="context" type="submit" name="form.button.Delete" value=" Delete "/>
                         <input class="context" type="submit" name="form.button.Change" value=" Change "/>
                     </td>
                 </tr>
                 <tr>
                     <td></td>
                     <td></td>
                     <td><input type="text" name="title" size="20"/></td>
                     <td align="center">
                         <input type="text" name="ratio" size="4" value="1.0"/>
                     </td>
                     <td align="center">
                         <input type="text" name="min_hrs" size="4" value="0"/>
                     </td>
                     <td align="center">
                         <input type="text" name="max_hrs" size="4" value="0"/>
                     </td>
                     <td/>
                     <td align="center" tal:repeat="default context/selectDayOfWeek">
                         <input type="text" name="defaults:list" size="4"
                                value="0"/>
                     </td>
                     <td>
                         <input class="context" type="submit" name="form.button.Add" value=" Add "/>
                     </td>
                  </tr>
              </table>

          </fieldset>

            <input type="hidden" name="form.submitted" value="1"/>


      </form>

      <div tal:replace="structure provider:plone.belowcontentbody">
           Document actions (print, sendto etc)
      </div>

  </div>
 
</body>
</html>
