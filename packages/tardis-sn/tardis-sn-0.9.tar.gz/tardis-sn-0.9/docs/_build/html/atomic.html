

<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Atomic Data &mdash; TARDIS v0.9.dev692</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-2.2.1.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-responsive-2.2.1.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.dev692',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/bootstrap-2.2.1.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/tardis_logo.ico"/>
    <link rel="top" title="TARDIS v0.9.dev692" href="index.html" />
    <link rel="next" title="Plasma" href="plasma.html" />
    <link rel="prev" title="Graphical User Interface" href="gui.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
  
  <a href="http://github.com/wkerzendorf/tardis"><img style="position: fixed; top: 0px; right: 0; border: 0; z-index: 100000;image-orientation: 90deg;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub"/></a>

<div class="container">
  
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="brand" href="index.html">TARDIS</a>
      <span class="navbar-text pull-left"><b>0.9.dev692</b></span>

      <div class="nav-collapse">
        <ul class="nav">
          <li class="divider-vertical"></li>
          
            <li class="dropdown">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">Graphical User Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Atomic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="plasma.html">Plasma</a></li>
<li class="toctree-l1"><a class="reference internal" href="montecarlo.html">Radiative Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>
</ul>
</li>
            <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Atomic Data</a><ul>
<li><a class="reference internal" href="#hdf5-dataset">HDF5 Dataset</a><ul>
<li><a class="reference internal" href="#basic-atomic-data">Basic Atomic Data</a></li>
<li><a class="reference internal" href="#ionization-data">Ionization Data</a></li>
<li><a class="reference internal" href="#levels-data">Levels Data</a></li>
<li><a class="reference internal" href="#lines-data">Lines Data</a></li>
<li><a class="reference internal" href="#macro-atom-data">Macro Atom Data</a></li>
<li><a class="reference internal" href="#macro-atom-references">Macro Atom References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-atom-data-class">The Atom Data Class</a></li>
<li><a class="reference internal" href="#indexing-fun">Indexing fun</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          
          
            
  <li><a href="gui.html"
         title="previous chapter">&laquo; Graphical User Interface</a></li>
  <li><a href="plasma.html"
         title="next chapter">Plasma &raquo;</a></li>
          
          
            <li></li>
          
        </ul>

        
          
<form class="navbar-search pull-right" style="margin-bottom:-3px;" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        
      </div>
    </div>
  </div>

  
  <div class="section" id="atomic-data">
<span id="id1"></span><h1>Atomic Data<a class="headerlink" href="#atomic-data" title="Permalink to this headline">¶</a></h1>
<p>The atomic data for tardis is stored in <a class="reference external" href="http://www.h5py.org/">hdf5 files</a>. TARDIS ships with a
relatively simple atomic dataset which only contains silicon lines and levels. TARDIS also has a full atomic dataset which contains
the complete Kurucz dataset (<a class="reference external" href="http://kurucz.harvard.edu/LINELISTS/GFALL/">http://kurucz.harvard.edu/LINELISTS/GFALL/</a>). This full dataset also contains recombination
coefficients from the ground state (<span class="math">\(\zeta-\textrm{factor}\)</span> used in <a class="reference internal" href="plasma_doc/nebular_plasma.html#calc-zeta-label"><em>Calculating Zeta</em></a>) and data for calculating the
branching or macro atom line interaction (<em class="xref std std-ref">macroatom</em>).</p>
<div class="section" id="hdf5-dataset">
<h2>HDF5 Dataset<a class="headerlink" href="#hdf5-dataset" title="Permalink to this headline">¶</a></h2>
<p>As mentioned previously, all atomic data is stored in <a class="reference external" href="http://www.h5py.org/">hdf5 files</a>  which contain tables
that include mass, ionization, levels and lines data. The atom data that ships with TARDIS is located in data/atom</p>
<p>The dataset <tt class="docutils literal"><span class="pre">basic_atom_set</span></tt> contains the Atomic Number, Symbol of the elements and average mass of the elements.</p>
<div class="section" id="basic-atomic-data">
<h3>Basic Atomic Data<a class="headerlink" href="#basic-atomic-data" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="49%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number</td>
<td>Atomic Number (e.g. He = 2)</td>
<td>z</td>
</tr>
<tr class="row-odd"><td>symbol</td>
<td>Symbol (e.g. He, Fe, Ca, etc.)</td>
<td>None</td>
</tr>
<tr class="row-even"><td>mass</td>
<td>Average mass of atom</td>
<td>u</td>
</tr>
</tbody>
</table>
<p>The ionization data is stored in <tt class="docutils literal"><span class="pre">ionization_data</span></tt>.</p>
</div>
<div class="section" id="ionization-data">
<h3>Ionization Data<a class="headerlink" href="#ionization-data" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="47%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>ionization_energy</td>
<td>Ionization Energy of atom</td>
<td>eV</td>
</tr>
</tbody>
</table>
<p>The levels data is stored in <tt class="docutils literal"><span class="pre">levels_data</span></tt>.</p>
</div>
<div class="section" id="levels-data">
<h3>Levels Data<a class="headerlink" href="#levels-data" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="47%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>level_number</td>
<td>Level Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>energy</td>
<td>Energy of a particular level</td>
<td>eV</td>
</tr>
<tr class="row-even"><td>g</td>
<td>&nbsp;</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>metastable</td>
<td>&nbsp;</td>
<td>bool</td>
</tr>
</tbody>
</table>
<p>All lines are stored in <tt class="docutils literal"><span class="pre">lines_data</span></tt>.</p>
</div>
<div class="section" id="lines-data">
<h3>Lines Data<a class="headerlink" href="#lines-data" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="47%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>wavelength</td>
<td>Waveslength</td>
<td>angstrom</td>
</tr>
<tr class="row-odd"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>f_ul</td>
<td>Upper level probability</td>
<td>1</td>
</tr>
<tr class="row-even"><td>f_lu</td>
<td>Lower level probability</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>level_id_lower</td>
<td>Upper level id</td>
<td>1</td>
</tr>
<tr class="row-even"><td>level_id_upper</td>
<td>Lower level id</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The next three datasets are only contained in the full dataset available upon request from the authors.</p>
<p>The factor correcting for photo-ionization from excited levels (needed in <a class="reference internal" href="plasma_doc/nebular_plasma.html#calc-zeta-label"><em>Calculating Zeta</em></a>) is stored in the dataset <tt class="docutils literal"><span class="pre">zeta_data</span></tt>.
The data is stored in a special way as one large <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.8)"><tt class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></tt></a> where the first two columns are Atomic Number and Ion
Number. All further columns are the <span class="math">\(\zeta-\textrm{factors}\)</span> for different temperatures. The temperatures are stored
in the attribute <tt class="docutils literal"><span class="pre">t_rads</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="47%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>T_XXXX</td>
<td>Temperature for column</td>
<td>K</td>
</tr>
<tr class="row-odd"><td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="row-even"><td>T_XXXX</td>
<td>Temperature for column</td>
<td>K</td>
</tr>
</tbody>
</table>
<p>There are two datasets for using the macro atom and branching line interactions. The <tt class="docutils literal"><span class="pre">macro_atom_data</span></tt> and <tt class="docutils literal"><span class="pre">macro_atom_references</span></tt>:</p>
<p>The <tt class="docutils literal"><span class="pre">macro_atom_data</span></tt> contains blocks of transition probabilities, several indices and flags. The Transition Type flag
has three states -1 for downwards emitting, 0 for downwards internal and 1 for upwards internal (for more explanations please
refer to <em class="xref std std-ref">macroatom</em>)</p>
</div>
<div class="section" id="macro-atom-data">
<h3>Macro Atom Data<a class="headerlink" href="#macro-atom-data" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="46%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>source_level_number</td>
<td>Source Level Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>destination_level_number</td>
<td>Destination Level Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>transition_type</td>
<td>Transition Type</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>transition_probability</td>
<td>Transition Probability</td>
<td>1</td>
</tr>
<tr class="row-even"><td>transition_line_id</td>
<td>Transition Line ID</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Here&#8217;s the structure of the probability block. The atomic number, ion number and source level number are the same
within each block, the destination level number the transition type and transition probability are changing.
The transition probabilities are only part of the final probability and will be changed during the calculation.
For details on the macro atom please refer to <em class="xref std std-ref">macroatom</em>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="9%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="20%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Atomic Number</th>
<th class="head">Ion Number</th>
<th class="head">Source Level Number</th>
<th class="head">Destination Level Number</th>
<th class="head">Transition Type</th>
<th class="head">Transition probabilities</th>
<th class="head">Transition Line ID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>1</sub></td>
<td>-1</td>
<td>P<sub>emission down</sub> 1</td>
<td>k<sub>1</sub></td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>2</sub></td>
<td>-1</td>
<td>P<sub>emission down</sub> 2</td>
<td>k<sub>2</sub></td>
</tr>
<tr class="row-even"><td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>n</sub></td>
<td>-1</td>
<td>P<sub>emission down</sub> n</td>
<td>k<sub>n</sub></td>
</tr>
<tr class="row-even"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>1</sub></td>
<td>0</td>
<td>P<sub>internal down</sub> 1</td>
<td>k<sub>1</sub></td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>2</sub></td>
<td>0</td>
<td>P<sub>internal down</sub> 2</td>
<td>k<sub>2</sub></td>
</tr>
<tr class="row-even"><td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>n</sub></td>
<td>0</td>
<td>P<sub>internal down</sub> n</td>
<td>k<sub>n</sub></td>
</tr>
<tr class="row-even"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>1</sub></td>
<td>1</td>
<td>P<sub>internal up</sub>   1</td>
<td>k<sub>1</sub></td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>2</sub></td>
<td>1</td>
<td>P<sub>internal up</sub>   2</td>
<td>k<sub>2</sub></td>
</tr>
<tr class="row-even"><td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="row-odd"><td>Z<sub>1</sub></td>
<td>I<sub>1</sub></td>
<td>i<sub>1</sub></td>
<td>j<sub>n</sub></td>
<td>1</td>
<td>P<sub>internal up</sub>   n</td>
<td>k<sub>n</sub></td>
</tr>
</tbody>
</table>
<p>The <tt class="docutils literal"><span class="pre">macro_references</span></tt> dataset contains the numbers for each block:</p>
</div>
<div class="section" id="macro-atom-references">
<h3>Macro Atom References<a class="headerlink" href="#macro-atom-references" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="46%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
<th class="head">Unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atomic_number(z)</td>
<td>Atomic Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ion_number</td>
<td>Ion Number</td>
<td>1</td>
</tr>
<tr class="row-even"><td>source_level_number</td>
<td>Source Level Number</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>count_down</td>
<td>Number of down transitions</td>
<td>1</td>
</tr>
<tr class="row-even"><td>count_up</td>
<td>Number of up transitions</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>count_total</td>
<td>Total number of transitions</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="the-atom-data-class">
<h2>The Atom Data Class<a class="headerlink" href="#the-atom-data-class" title="Permalink to this headline">¶</a></h2>
<p>Atom Data is stored inside TARDIS in the <tt class="xref py py-class docutils literal"><span class="pre">AtomData</span></tt>-class. The class method <tt class="xref py py-func docutils literal"><span class="pre">AtomData.from_hdf5()</span></tt> will
instantiate a new <cite>AtomData</cite>-class from an HDF5 file. If none is given it will automatically
take the default HDF5-dataset shipped with TARDIS. A second function <tt class="xref py py-func docutils literal"><span class="pre">AtomData.prepare_atom_data()</span></tt>
will cut the levels and lines data to only the required atoms and ions. In addition, it will create the intricate system
of references needed by macro atom or branching line interactions.</p>
</div>
<div class="section" id="indexing-fun">
<h2>Indexing fun<a class="headerlink" href="#indexing-fun" title="Permalink to this headline">¶</a></h2>
<p>The main problem with the atomic data is indexing. Most of these references require multiple numbers, e.g. atomic number,
ion number and level number. The <a href="#id3"><span class="problematic" id="id4">:py:module:`pandas`</span></a>-framework provides the ideal functions to accomplish this. In TARDIS we extensively
use <tt class="xref py py-class docutils literal"><span class="pre">pandas.MultiIndex</span></tt>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.Series.html#pandas.Series" title="(in pandas v0.13.0-258-g8497e0b)"><tt class="xref py py-class docutils literal"><span class="pre">pandas.Series</span></tt></a> and <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.13.0-258-g8497e0b)"><tt class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></tt></a></p>
<p>TO BE BETTER DOCUMENTED ...</p>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, TARDIS team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>