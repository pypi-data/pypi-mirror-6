<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Upgrading &mdash; Pootle 2.5.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Pootle 2.5.1 documentation" href="../index.html" />
    <link rel="up" title="Administering a server" href="index.html" />
    <link rel="next" title="Database Migration" href="database_migration.html" />
    <link rel="prev" title="Running under a Web Server" href="web.html" /> 
  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Pootle</a>
        <span class="navbar-text pull-left"><b>2.5.1</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">User&#8217;s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administering a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Pootle API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_docs.html">External documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Upgrading</a><ul>
<li><a class="reference internal" href="#checklist">Checklist</a></li>
<li><a class="reference internal" href="#performing-the-database-upgrade">Performing the Database Upgrade</a><ul>
<li><a class="reference internal" href="#simplified-database-upgrade">Simplified database upgrade</a></li>
<li><a class="reference internal" href="#step-by-step-database-upgrade">Step by step database upgrade</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-changes">Custom Changes</a></li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="web.html"
         title="previous chapter">&laquo; Running under a Web Server</a></li>
  <li><a href="database_migration.html"
         title="next chapter">Database Migration &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="upgrading">
<span id="id1"></span><h1>Upgrading<a class="headerlink" href="#upgrading" title="Permalink to this headline">¶</a></h1>
<p>Here are some points to take into account while performing Pootle
upgrades.</p>
<div class="section" id="checklist">
<span id="upgrading-checklist"></span><h2>Checklist<a class="headerlink" href="#checklist" title="Permalink to this headline">¶</a></h2>
<p>Before upgrading Pootle to a newer version, make sure to go through this
checklist.</p>
<ul>
<li><p class="first">Familiarize yourself with <a class="reference internal" href="../changelog.html"><em>important changes</em></a> in
Pootle over the versions.</p>
</li>
<li><p class="first">If you want to change databases, which might be needed when upgrading from
Pootle 1.x to Pootle 2.x, or from Pootle 2.0.x to 2.1.x, then have a look at
the <a class="reference internal" href="database_migration.html"><em>database migration</em></a> page first, although some
of the issues on this page could still be relevant.</p>
</li>
<li><p class="first">Check the <a class="reference internal" href="installation.html"><em>installation</em></a> instructions for the newer
version, and ensure that you have all the dependencies for the newer version.</p>
</li>
<li><p class="first">Always make backups of all your translation files (your whole
<a class="reference internal" href="settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>) and your custom settings file. You can synchronize
all your translation files with the database using the <a class="reference internal" href="commands.html#commands-sync-stores"><em>sync_stores</em></a> command before you make your backups.</p>
</li>
<li><p class="first">Make a backup of your complete database using the appropriate <em>dump</em>
command for your database system. For example <strong class="command">mysqldump</strong> for MySQL,
or <strong class="command">pg_dump</strong> for PostgreSQL.</p>
</li>
<li><p class="first">If you are upgrading from a version of Pootle that uses <em>localsettings.py</em>
then you want to make sure your configuration file is read when Pootle
starts. For more information, read about <a class="reference internal" href="settings.html#settings-customizing"><em>customizing settings</em></a>.</p>
</li>
<li><p class="first">You might want to look for any new <a class="reference internal" href="settings.html#settings-available"><em>available settings</em></a> in the new version that you might want to
configure.</p>
</li>
<li><p class="first">After a successful upgrade, consider clearing your cache. For users of
memcached it is enough to restart memcached. For users of the default
database cache, you can drop the <tt class="docutils literal"><span class="pre">pootlecache</span></tt> table and recreate it
with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle createcachetable pootlecache
</pre></div>
</div>
</li>
<li><p class="first">Finally run the <a class="reference internal" href="commands.html#commands-collectstatic"><em>collectstatic</em></a> and
<a class="reference internal" href="commands.html#commands-assets"><em>assets build</em></a> commands to update the static assets:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle collectstatic --clear --noinput
<span class="nv">$ </span>pootle assets build
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="performing-the-database-upgrade">
<span id="upgrading-database"></span><h2>Performing the Database Upgrade<a class="headerlink" href="#performing-the-database-upgrade" title="Permalink to this headline">¶</a></h2>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5.1.</span></p>
</div>
<p>Once you have the new code configured to in your server using the correct
settings file, you will be ready to run the database schema and data
upgrade procedure.</p>
<p>Since the database upgrade procedures have been growing in complexity in the
last releases it was necessary to provide a simple way to upgrade Pootle using
a single command. The old procedure is still available, mostly for debugging
failing upgrades, but the new procedure is now the preferred one.</p>
<div class="section" id="simplified-database-upgrade">
<span id="upgrading-simplified-upgrade"></span><h3>Simplified database upgrade<a class="headerlink" href="#simplified-database-upgrade" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Always make database backups before running any upgrades.</p>
</div>
<p>This is now the preferred way to upgrade the database.</p>
<p>The procedure is easy, just run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle setup
</pre></div>
</div>
</div>
<div class="section" id="step-by-step-database-upgrade">
<span id="upgrading-detailed-upgrade"></span><h3>Step by step database upgrade<a class="headerlink" href="#step-by-step-database-upgrade" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Always make database backups before running any upgrades.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use this procedure only if the <a class="reference internal" href="#upgrading-simplified-upgrade"><em>Simplified database upgrade</em></a> procedure doesn&#8217;t work for you.</p>
</div>
<p>The step by step database upgrade procedure lets you control the upgrade
process and tweak it. This is useful for debugging purposes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you are upgrading from a Pootle version older than 2.5.0, you will need
an extra step at the beginning (before running <tt class="docutils literal"><span class="pre">syncdb</span> <span class="pre">--noinput</span></tt>):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle updatedb
</pre></div>
</div>
<p class="last">The <a class="reference internal" href="commands.html#commands-updatedb"><em>updatedb command</em></a> upgrades the database schema
to the state of Pootle 2.5.0. This is necessary due to the changes made to
the database schema migration mechanisms after the 2.5.0 release.</p>
</div>
<p>In the first step, the syncdb command will create any missing database tables
that don&#8217;t require any migrations:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle syncdb --noinput
</pre></div>
</div>
<p>For this specific version (Pootle 2.5.1), and due to Pootle&#8217;s transitioning to
South, you will need to run a fake migration action in order to let South know
which is your current database schema. You can execute the fake migration by
running the following commands:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle migrate pootle_app --fake 0001
<span class="nv">$ </span>pootle migrate pootle_language --fake 0001
<span class="nv">$ </span>pootle migrate pootle_notifications --fake 0001
<span class="nv">$ </span>pootle migrate pootle_profile --fake 0001
<span class="nv">$ </span>pootle migrate pootle_project --fake 0001
<span class="nv">$ </span>pootle migrate pootle_statistics --fake 0001
<span class="nv">$ </span>pootle migrate pootle_store --fake 0001
<span class="nv">$ </span>pootle migrate pootle_translationproject --fake 0001
<span class="nv">$ </span>pootle migrate staticpages --fake 0001
</pre></div>
</div>
<p>The next step will perform any pending schema migrations. You can read more
about the <a class="reference external" href="http://south.readthedocs.org/en/latest/commands.html#commands" title="(in South v0.8)"><em class="xref std std-ref">migrate command</em></a> in South&#8217;s documentation.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle migrate
</pre></div>
</div>
<p>Lastly, the <a class="reference internal" href="commands.html#commands-upgrade"><em>upgrade command</em></a> will perform any extra
operations needed by Pootle to finish the upgrade and will record the current
code build versions for Pootle and the Translate Toolkit. Before running this
command please check if you are interested on running it using any of its
available flags.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle upgrade
</pre></div>
</div>
</div>
</div>
<div class="section" id="custom-changes">
<span id="upgrading-custom-changes"></span><h2>Custom Changes<a class="headerlink" href="#custom-changes" title="Permalink to this headline">¶</a></h2>
<p>If you made any changes to Pootle code, templates or styling, you will want to
ensure that your upgraded Pootle contains those changes.  How hard that is will
depend entirely on the details of these changes.</p>
<p>Changes made to the base template are likely to work fine, but changes to
details will need individual inspection to see if they can apply
cleanly or have to be reimplemented on the new version of Pootle.</p>
<p>Since Pootle 2.5 <a class="reference internal" href="../developers/customization.html"><em>customization of style sheets and templates</em></a> have become much easier to seperate from the
standard code.  If you are migrating to Pootle 2.5+ then use this opportunity
to move your code to the correct customization locations.</p>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2004-2014, Translate.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>