<html tal:replace="structure context/manage_page_header"
      tal:define="global status request/form/status | string:unsent"/>

<script type="text/javascript">
<!--
isSelected = false;

function toggleSelect() {
  if (isSelected == false) {
    for (i = 0; i < document.labels.length; i++)
      if (document.labels.elements[i].name == "ids:list")
          document.labels.elements[i].checked = true ;
    isSelected = true;
    document.labels.selectButton.value = "Deselect All";
  }
  else {
    for (i = 0; i < document.labels.length; i++)
      if (document.labels.elements[i].name == "ids:list") 
         document.labels.elements[i].checked = false ;
    isSelected = false;
    document.labels.selectButton.value = "Select All";
  }
  return isSelected;
}

<!-- this is work in progress ... -->
function toggleLabels() {
    for (i=0; i < document.labels.length; i++)
        if (document.labels.elements[i].name == "ids:list")
           if (document.labels.elements[i].checked)
	      for (j=0; j < document.labels.labelpos0.length; j++)
                document.labels.labelpos0[j].disabled = false;
           else
	      for (j=0; j < document.labels.labelpos0.length; j++)
                document.labels.labelpos0[j].disabled = true;
    return false;
}
//-->
</script>

    <span tal:replace="structure container/manage_tabs"/>

       <br/>

       <form name="statuses" action="manage_main" method="post">
       <table>
         <tr>
            <td class="form-label">Show:</td>
            <td class="form-element">
               <input type="radio" name="status" value="unsent" onclick="document.statuses.submit()"
                      tal:attributes="checked python: status=='unsent' and 1 or 0">Unsent
            </td>
            <td class="form-element">
               <input type="radio" name="status" value="delivering" onclick="document.statuses.submit()"
                      tal:attributes="checked python: status=='delivering' and 1 or 0">Dispatched
            </td>
            <td class="form-element">
               <input type="radio" name="status" value="delivered"  onclick="document.statuses.submit()"
                      tal:attributes="checked python: status=='delivered' and 1 or 0">Delivered</td>
            <td class="form-element">
               <input type="radio" name="status" value="cancelled"  onclick="document.statuses.submit()"
                      tal:attributes="checked python: status=='cancelled' and 1 or 0">Cancelled</td>
         </tr>
       </table>
       </form>

       <form name="labels" action="" method="post" tal:attributes="action request/URL1"
             tal:define="dispatchables python: context(status=status)"
             tal:condition="dispatchables">
          <table border="0" cellpadding="2" cellspacing="0" 
                 tal:define="entries python: map(lambda x: x.getObject(), dispatchables)"
		 tal:condition="entries">
            <tr class="list-header">
               <td width="16"  class="list-item">&nbsp;</td>
               <td width="25"  class="list-item">&nbsp;</td>
               <td class="list-item">Request</td>
               <td class="list-item">Order</td>
               <td class="list-item">Label</td>
               <td class="list-item">Label Pos</td>
            </tr>
            <tr class="row-hilite" tal:repeat="req entries"
                tal:attributes="class python: repeat['req'].index % 2 and 'row-normal' or 'row-hilite'">
               <td class="list-item" width="16" valign="top">
                   <input type="checkbox" name="shiptoaddress.id:records" value="" 
                          tal:attributes="value req/id" 
                          onclick="toggleLabels">
               </td>
               <td class="list-item" valign="top">
                  <a href="" tal:attributes="href string:${req/id}/manage_workspace">
                     <img src="" alt="" border="0"
                          tal:attributes="src req/icon"/>
                  </a>
               </td>
               <td class="list-item" valign="top">
                  <a href="" tal:attributes="href string:${req/id}/manage_workspace" tal:content="req/id"/>
               </td>
               <div tal:omit-tag=""  tal:define="order req/order">
                  <td class="list-item"  valign="top">
                      <a href="" tal:attributes="href string:/${order/absolute_url}/manage_workspace"
                         tal:content="order/contact | order/title_or_id"/>
                  </td>
                  <td class="list-item"  valign="top">
                    <textarea name="shiptoaddress.addr:records" rows="4" cols="30" 
                              tal:define="label request/shiptoaddress | string:${order/contact}
${order/shiptoaddress}"
                              tal:content="label"/>
                  </td>
               </div>
               <td class="list-item" valign="top">
                   <table>
                     <tr tal:repeat="row python:range(0,context.label_rows)">
                        <td tal:repeat="col python:range(0,context.label_cols)">
                           <input type="radio" name="labelpos" value="" 
                                  tal:define="pos python:row * context.label_cols + col"
                                  tal:attributes="value string:${req/id},${pos};
                                                  name  string:labelpos${repeat/req/index};
                                                  checked python: repeat['req'].index == pos"/>
                        </td>
                     </tr>
                   </table>

               </td>
            </tr>
            <tr>
               <td colspan="5" class="form-element">
                   <input type="submit"  value="  Delete   " name="manage_delObjects:method"/>
                   <input type="submit"  value="  Cancel   " name="manage_cancel:method"
                          tal:condition="python: status != 'cancelled'"/>
                   <input type="submit"  value=" Dispatch  " name="manage_dispatch:method"
                          tal:condition="python: status == 'unsent'"/>
                   <input type="submit"  value="  Print    " name="dispatch_labels:method"/>
                   <input type="submit" name="selectButton" value="Select All" onClick="toggleSelect(); return false"/>
               </td>
           </tr>
         </table>
       </form>

<html tal:replace="structure context/manage_page_footer"/>





