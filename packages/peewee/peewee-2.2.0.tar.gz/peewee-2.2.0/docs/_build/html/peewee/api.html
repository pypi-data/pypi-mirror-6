<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API Reference &mdash; peewee 2.1.6 documentation</title>
    
    <link rel="stylesheet" href="../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="peewee 2.1.6 documentation" href="../index.html" />
    <link rel="next" title="Playhouse, a collection of addons" href="playhouse.html" />
    <link rel="prev" title="Databases" href="database.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="../_static/small_flask.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="playhouse.html" title="Playhouse, a collection of addons"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="database.html" title="Databases"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">peewee 2.1.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="expressions">
<span id="expressions-api"></span><h2>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">¶</a></h2>
<p>Peewee was designed to provide a simple, expressive, and pythonic way of executing
queries.  This section will provide a quick overview of some common types of expressions.</p>
<p>There are two primary types of objects that can be composed to create expressions:</p>
<ul class="simple">
<li><a class="reference internal" href="#Field" title="Field"><tt class="xref py py-class docutils literal"><span class="pre">Field</span></tt></a> instances</li>
<li>SQL aggregations and functions using <a class="reference internal" href="#fn" title="fn"><tt class="xref py py-class docutils literal"><span class="pre">fn</span></tt></a></li>
</ul>
<p>We will assume a simple &#8220;User&#8221; model with fields for username and other things.
It looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>
    <span class="n">is_admin</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">()</span>
    <span class="n">is_active</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">()</span>
    <span class="n">last_login</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">login_count</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">failed_logins</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">()</span>
</pre></div>
</div>
<p>Comparisons use the <a class="reference internal" href="querying.html#column-lookups"><em>Column lookups</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># username is equal to &#39;charlie&#39;</span>
<span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="s">&#39;charlie&#39;</span>

<span class="c"># user has logged in less than 5 times</span>
<span class="n">User</span><span class="o">.</span><span class="n">login_count</span> <span class="o">&lt;</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Comparisons can be combined using bitwise &#8220;and&#8221; and &#8220;or&#8221;.  Operator precedence
is controlled by python and comparisons can be nested to an arbitrary depth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># user is both and admin and has logged in today</span>
<span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">is_admin</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">last_login</span> <span class="o">&gt;=</span> <span class="n">today</span><span class="p">)</span>

<span class="c"># user&#39;s username is either charlie or charles</span>
<span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="s">&#39;charlie&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="s">&#39;charles&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparisons can be used with functions as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># user&#39;s username starts with a &#39;g&#39; or a &#39;G&#39;:</span>
<span class="n">fn</span><span class="o">.</span><span class="n">Lower</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">Substr</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="s">&#39;g&#39;</span>
</pre></div>
</div>
<p>We can do some fairly interesting things, as expressions can be compared against
other expressions.  Expressions also support arithmetic operations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># users who entered the incorrect more than half the time and have logged</span>
<span class="c"># in at least 10 times</span>
<span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">failed_logins</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">login_count</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">login_count</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Expressions allow us to do atomic updates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># when a user logs in we want to increment their login count:</span>
<span class="n">User</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">login_count</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">login_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">)</span>
</pre></div>
</div>
<p>Expressions can be used in all parts of a query, so experiment!</p>
</div>
<div class="section" id="models">
<span id="model-api"></span><h2>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Model">
<em class="property">class </em><tt class="descname">Model</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Models provide a 1-to-1 mapping to database tables.  Subclasses of
<tt class="docutils literal"><span class="pre">Model</span></tt> declare any number of <a class="reference internal" href="#Field" title="Field"><tt class="xref py py-class docutils literal"><span class="pre">Field</span></tt></a> instances as class
attributes.  These fields correspond to columns on the table.</p>
<p>Table-level operations, such as select/update/insert/delete queries, are
implemented as classmethods.  Row-level operations such as saving or
deleting individual instances are implemented as instancemethods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> &#8211; Initialize the model, assigning the given key/values to the
appropriate fields.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>
    <span class="n">join_date</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">is_admin</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">()</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;charlie&#39;</span><span class="p">,</span> <span class="n">is_admin</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="Model.select">
<em class="property">classmethod </em><tt class="descname">select</tt><big>(</big><em>*selection</em><big>)</big><a class="headerlink" href="#Model.select" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>selection</strong> &#8211; a list of model classes, field instances, functions
or <a class="reference internal" href="querying.html#expressions"><em>expressions</em></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a <a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> for the given <tt class="docutils literal"><span class="pre">Model</span></tt></td>
</tr>
</tbody>
</table>
<p>Examples of selecting all columns (default):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<p>Example of selecting all columns on <tt class="docutils literal"><span class="pre">Tweet</span></tt> <em>and</em> the parent model,
<tt class="docutils literal"><span class="pre">User</span></tt>.  When the <tt class="docutils literal"><span class="pre">user</span></tt> foreign key is accessed on a <tt class="docutils literal"><span class="pre">Tweet</span></tt>
instance no additional query will be needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">Tweet</span>
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">Tweet</span><span class="p">,</span> <span class="n">User</span><span class="p">)</span>
  <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
  <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">created_date</span><span class="o">.</span><span class="n">desc</span><span class="p">()))</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.update">
<em class="property">classmethod </em><tt class="descname">update</tt><big>(</big><em>**update</em><big>)</big><a class="headerlink" href="#Model.update" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>update</strong> &#8211; mapping of field-name to expression</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">an <a class="reference internal" href="#UpdateQuery" title="UpdateQuery"><tt class="xref py py-class docutils literal"><span class="pre">UpdateQuery</span></tt></a> for the given <tt class="docutils literal"><span class="pre">Model</span></tt></td>
</tr>
</tbody>
</table>
<p>Example showing users being marked inactive if their registration
expired:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">registration_expired</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># execute the query, updating the database.</span>
</pre></div>
</div>
<p>Example showing an atomic update:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">q</span> <span class="o">=</span> <span class="n">PageView</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="n">PageView</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">PageView</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="n">url</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># execute the query, updating the database.</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.insert">
<em class="property">classmethod </em><tt class="descname">insert</tt><big>(</big><em>**insert</em><big>)</big><a class="headerlink" href="#Model.insert" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>insert</strong> &#8211; mapping of field-name to expression</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">an <a class="reference internal" href="#InsertQuery" title="InsertQuery"><tt class="xref py py-class docutils literal"><span class="pre">InsertQuery</span></tt></a> for the given <tt class="docutils literal"><span class="pre">Model</span></tt></td>
</tr>
</tbody>
</table>
<p>Example showing creation of a new user:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">registration_expired</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># perform the insert.</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.delete">
<em class="property">classmethod </em><tt class="descname">delete</tt><big>(</big><big>)</big><a class="headerlink" href="#Model.delete" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a <a class="reference internal" href="#DeleteQuery" title="DeleteQuery"><tt class="xref py py-class docutils literal"><span class="pre">DeleteQuery</span></tt></a> for the given <tt class="docutils literal"><span class="pre">Model</span></tt></td>
</tr>
</tbody>
</table>
<p>Example showing the deletion of all inactive users:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># remove the rows</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method performs a delete on the <em>entire table</em>.  To delete a
single instance, see <a class="reference internal" href="#Model.delete_instance" title="Model.delete_instance"><tt class="xref py py-meth docutils literal"><span class="pre">Model.delete_instance()</span></tt></a>.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.raw">
<em class="property">classmethod </em><tt class="descname">raw</tt><big>(</big><em>sql</em>, <em>*params</em><big>)</big><a class="headerlink" href="#Model.raw" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; a string SQL expression</li>
<li><strong>params</strong> &#8211; any number of parameters to interpolate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#RawQuery" title="RawQuery"><tt class="xref py py-class docutils literal"><span class="pre">RawQuery</span></tt></a> for the given <tt class="docutils literal"><span class="pre">Model</span></tt></p>
</td>
</tr>
</tbody>
</table>
<p>Example selecting rows from the User table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s">&#39;select id, username from users&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Generally the use of <tt class="docutils literal"><span class="pre">raw</span></tt> is reserved for those cases where you
can significantly optimize a select query.  It is useful for select
queries since it will return instances of the model.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.create">
<em class="property">classmethod </em><tt class="descname">create</tt><big>(</big><em>**attributes</em><big>)</big><a class="headerlink" href="#Model.create" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>attributes</strong> &#8211; key/value pairs of model attributes</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a model instance with the provided attributes</td>
</tr>
</tbody>
</table>
<p>Example showing the creation of a user (a row will be added to the
database):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The create() method is a shorthand for instantiate-then-save.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.get">
<em class="property">classmethod </em><tt class="descname">get</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#Model.get" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; a list of query expressions, e.g. <tt class="docutils literal"><span class="pre">User.username</span> <span class="pre">==</span> <span class="pre">'foo'</span></tt></li>
<li><strong>kwargs</strong> &#8211; a mapping of column + lookup to value, e.g. &#8220;age__gt=55&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> instance or raises <tt class="docutils literal"><span class="pre">DoesNotExist</span></tt> exception</p>
</td>
</tr>
</tbody>
</table>
<p>Get a single row from the database that matches the given query.
Raises a <tt class="docutils literal"><span class="pre">&lt;model-class&gt;.DoesNotExist</span></tt> if no rows are returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">password</span> <span class="o">==</span> <span class="n">password</span><span class="p">)</span>
</pre></div>
</div>
<p>This method is also exposed via the <a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a>, though it
takes no parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">active</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">users</span> <span class="o">=</span> <span class="n">active</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">password</span> <span class="o">==</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">get()</span></tt> method is shorthand for selecting with a limit of 1. It
has the added behavior of raising an exception when no matching row is
found.  If more than one row is found, the first row returned by the
database cursor will be used.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">the &#8220;kwargs&#8221; style syntax is provided for compatibility with
version 1.0.  The expression-style syntax is preferable.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.get_or_create">
<em class="property">classmethod </em><tt class="descname">get_or_create</tt><big>(</big><em>**attributes</em><big>)</big><a class="headerlink" href="#Model.get_or_create" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span>Deprecated since version 2.0: </span>Because this relies of &#8220;django-style&#8221; expressions, it has been deprecated
as of 2.0.  Use <a class="reference internal" href="#Model.get" title="Model.get"><tt class="xref py py-meth docutils literal"><span class="pre">Model.get()</span></tt></a> and <a class="reference internal" href="#Model.create" title="Model.create"><tt class="xref py py-meth docutils literal"><span class="pre">Model.create()</span></tt></a> explicitly.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>attributes</strong> &#8211; key/value pairs of model attributes</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> instance</td>
</tr>
</tbody>
</table>
<p>Get the instance with the given attributes set.  If the instance
does not exist it will be created.</p>
<p>Example showing get/create an object cached in the database:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">CachedObj</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">some_val</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.filter">
<em class="property">classmethod </em><tt class="descname">filter</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#Model.filter" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span>Deprecated since version 2.0: </span>Use <a class="reference internal" href="#Model.select" title="Model.select"><tt class="xref py py-class docutils literal"><span class="pre">select</span></tt></a> instead.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; a list of <tt class="xref py py-class docutils literal"><span class="pre">DQ</span></tt> or expression objects</li>
<li><strong>kwargs</strong> &#8211; a mapping of column + lookup to value, e.g. &#8220;age__gt=55&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> with appropriate <tt class="docutils literal"><span class="pre">WHERE</span></tt> clauses</p>
</td>
</tr>
</tbody>
</table>
<p>Provides a django-like syntax for building a query. The key difference
between <a class="reference internal" href="#Model.filter" title="Model.filter"><tt class="xref py py-meth docutils literal"><span class="pre">filter()</span></tt></a> and <tt class="xref py py-meth docutils literal"><span class="pre">SelectQuery.where()</span></tt>
is that <a class="reference internal" href="#Model.filter" title="Model.filter"><tt class="xref py py-meth docutils literal"><span class="pre">filter()</span></tt></a> supports traversing joins using
django&#8217;s &#8220;double-underscore&#8221; syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__title</span><span class="o">=</span><span class="s">&#39;Some Blog&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.alias">
<em class="property">classmethod </em><tt class="descname">alias</tt><big>(</big><big>)</big><a class="headerlink" href="#Model.alias" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ModelAlias</span></tt> instance</td>
</tr>
</tbody>
</table>
<p>The alias() method is used to build queries that use self-joins.</p>
<p>Example:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="go">Parent = Category.alias()</span>
<span class="go">sq = (Category</span>
<span class="go">  .select(Category, Parent)</span>
<span class="go">  .join(Parent, on=(Category.parent == Parent.id))</span>
<span class="go">  .where(Parent.name == &#39;parent category&#39;))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must explicitly specify which columns to join on</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.create_table">
<em class="property">classmethod </em><tt class="descname">create_table</tt><big>(</big><span class="optional">[</span><em>fail_silently=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Model.create_table" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fail_silently</strong> (<em>bool</em>) &#8211; If set to <tt class="docutils literal"><span class="pre">True</span></tt>, the method will check
for the existence of the table before attempting to create.</td>
</tr>
</tbody>
</table>
<p>Create the table for the given model.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">database</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">SomeModel</span><span class="o">.</span><span class="n">create_table</span><span class="p">()</span>  <span class="c"># Execute the create table query.</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.drop_table">
<em class="property">classmethod </em><tt class="descname">drop_table</tt><big>(</big><span class="optional">[</span><em>fail_silently=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Model.drop_table" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fail_silently</strong> (<em>bool</em>) &#8211; If set to <tt class="docutils literal"><span class="pre">True</span></tt>, the query will check for
the existence of the table before attempting to remove.</td>
</tr>
</tbody>
</table>
<p>Drop the table for the given model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cascading deletes are not handled by this method, nor is the
removal of any constraints.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="Model.table_exists">
<em class="property">classmethod </em><tt class="descname">table_exists</tt><big>(</big><big>)</big><a class="headerlink" href="#Model.table_exists" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Boolean whether the table for this model exists in the database</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Model.save">
<tt class="descname">save</tt><big>(</big><span class="optional">[</span><em>force_insert=False</em><span class="optional">[</span>, <em>only=None</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#Model.save" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>force_insert</strong> (<em>bool</em>) &#8211; Whether to force execution of an insert</li>
<li><strong>only</strong> (<em>list</em>) &#8211; A list of fields to persist &#8211; when supplied, only the given
fields will be persisted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Save the given instance, creating or updating depending on whether it has a
primary key.  If <tt class="docutils literal"><span class="pre">force_insert=True</span></tt> an <tt class="docutils literal"><span class="pre">INSERT</span></tt> will be issued regardless
of whether or not the primary key exists.</p>
<p>Example showing saving a model instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">()</span>
<span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">&#39;some-user&#39;</span>  <span class="c"># does not touch the database</span>
<span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>  <span class="c"># change is persisted to the db</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Model.delete_instance">
<tt class="descname">delete_instance</tt><big>(</big><span class="optional">[</span><em>recursive=False</em><span class="optional">[</span>, <em>delete_nullable=False</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#Model.delete_instance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>recursive</strong> &#8211; Delete this instance and anything that depends on it,
optionally updating those that have nullable dependencies</li>
<li><strong>delete_nullable</strong> &#8211; If doing a recursive delete, delete all dependent
objects regardless of whether it could be updated to NULL</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Delete the given instance.  Any foreign keys set to cascade on
delete will be deleted automatically.  For more programmatic control,
you can call with recursive=True, which will delete any non-nullable
related models (those that <em>are</em> nullable will be set to NULL).  If you
wish to delete all dependencies regardless of whether they are nullable,
set <tt class="docutils literal"><span class="pre">delete_nullable=True</span></tt>.</p>
<p>example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">some_obj</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">()</span>  <span class="c"># it is gone forever</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Model.dependencies">
<tt class="descname">dependencies</tt><big>(</big><span class="optional">[</span><em>search_nullable=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Model.dependencies" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>search_nullable</strong> (<em>bool</em>) &#8211; Search models related via a nullable foreign key</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Generator expression yielding queries and foreign key fields</td>
</tr>
</tbody>
</table>
<p>Generate a list of queries of dependent models.  Yields a 2-tuple containing
the query and corresponding foreign key field.  Useful for searching dependencies
of a model, i.e. things that would be orphaned in the event of a delete.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fields">
<span id="fields-api"></span><h2>Fields<a class="headerlink" href="#fields" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Field">
<em class="property">class </em><tt class="descname">Field</tt><big>(</big><em>null=False</em>, <em>index=False</em>, <em>unique=False</em>, <em>verbose_name=None</em>, <em>help_text=None</em>, <em>db_column=None</em>, <em>default=None</em>, <em>choices=None</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#Field" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class from which all other field types extend.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>null</strong> (<em>bool</em>) &#8211; whether this column can accept <tt class="docutils literal"><span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">NULL</span></tt> values</li>
<li><strong>index</strong> (<em>bool</em>) &#8211; whether to create an index for this column when creating the table</li>
<li><strong>unique</strong> (<em>bool</em>) &#8211; whether to create a unique index for this column when creating the table</li>
<li><strong>verbose_name</strong> (<em>string</em>) &#8211; specify a &#8220;verbose name&#8221; for this field, useful for metadata purposes</li>
<li><strong>help_text</strong> (<em>string</em>) &#8211; specify some instruction text for the usage/meaning of this field</li>
<li><strong>db_column</strong> (<em>string</em>) &#8211; column name to use for underlying storage, useful for compatibility with legacy databases</li>
<li><strong>default</strong> &#8211; a value to use as an uninitialized default</li>
<li><strong>choices</strong> &#8211; an iterable of 2-tuples mapping <tt class="docutils literal"><span class="pre">value</span></tt> to <tt class="docutils literal"><span class="pre">display</span></tt></li>
<li><strong>primary_key</strong> (<em>bool</em>) &#8211; whether to use this as the primary key for the table</li>
<li><strong>sequence</strong> (<em>string</em>) &#8211; name of sequence (if backend supports it)</li>
<li><strong>kwargs</strong> &#8211; named attributes containing values that may pertain to specific field subclasses, such as &#8220;max_length&#8221; or &#8220;decimal_places&#8221;</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<tt class="descname">db_field = '&lt;some field type&gt;'</tt></dt>
<dd><p>Attribute used to map this field to a column type, e.g. &#8220;string&#8221; or &#8220;datetime&#8221;</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">template = '%(column_type)s'</tt></dt>
<dd><p>A template for generating the SQL for this field</p>
</dd></dl>

<dl class="attribute">
<dt id="Field._is_bound">
<tt class="descname">_is_bound</tt><a class="headerlink" href="#Field._is_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean flag indicating if the field is attached to a model class.</p>
</dd></dl>

<dl class="attribute">
<dt id="Field.model_class">
<tt class="descname">model_class</tt><a class="headerlink" href="#Field.model_class" title="Permalink to this definition">¶</a></dt>
<dd><p>The model the field belongs to. <em>Only applies to bound fields.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="Field.name">
<tt class="descname">name</tt><a class="headerlink" href="#Field.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the field. <em>Only applies to bound fields.</em></p>
</dd></dl>

<dl class="method">
<dt id="Field.db_value">
<tt class="descname">db_value</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#Field.db_value" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> &#8211; python data type to prep for storage in the database</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">converted python datatype</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Field.python_value">
<tt class="descname">python_value</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#Field.python_value" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> &#8211; data coming from the backend storage</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">python data type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Field.coerce">
<tt class="descname">coerce</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#Field.coerce" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is a shorthand that is used, by default, by both <tt class="docutils literal"><span class="pre">db_value</span></tt> and
<tt class="docutils literal"><span class="pre">python_value</span></tt>.  You can usually get away with just implementing this.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> &#8211; arbitrary data from app or backend</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">python data type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Field.field_attributes">
<tt class="descname">field_attributes</tt><big>(</big><big>)</big><a class="headerlink" href="#Field.field_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is responsible for return a dictionary containing the default
field attributes for the column, e.g. <tt class="docutils literal"><span class="pre">{'max_length':</span> <span class="pre">255}</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a python dictionary</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Field.between">
<tt class="descname">between</tt><big>(</big><em>low</em>, <em>high</em><big>)</big><a class="headerlink" href="#Field.between" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an expression suitable for performing &#8220;BETWEEN&#8221; queries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">an <tt class="docutils literal"><span class="pre">Expression</span></tt> object.</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># select employees making between $50 and $60</span>
<span class="n">Employee</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Employee</span><span class="o">.</span><span class="n">salary</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="IntegerField">
<em class="property">class </em><tt class="descname">IntegerField</tt><a class="headerlink" href="#IntegerField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: integers</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'int'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="BigIntegerField">
<em class="property">class </em><tt class="descname">BigIntegerField</tt><a class="headerlink" href="#BigIntegerField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: big integers</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'bigint'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="PrimaryKeyField">
<em class="property">class </em><tt class="descname">PrimaryKeyField</tt><a class="headerlink" href="#PrimaryKeyField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: auto-incrementing integer fields suitable for use as primary key.</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'primary_key'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="FloatField">
<em class="property">class </em><tt class="descname">FloatField</tt><a class="headerlink" href="#FloatField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: floating-point numbers</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'float'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="DoubleField">
<em class="property">class </em><tt class="descname">DoubleField</tt><a class="headerlink" href="#DoubleField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: double-precision floating-point numbers</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'double'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="DecimalField">
<em class="property">class </em><tt class="descname">DecimalField</tt><a class="headerlink" href="#DecimalField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: decimal numbers, using python standard library <tt class="docutils literal"><span class="pre">Decimal</span></tt> objects</p>
<p>Additional attributes and values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">max_digits</span></tt></td>
<td><tt class="docutils literal"><span class="pre">10</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">decimal_places</span></tt></td>
<td><tt class="docutils literal"><span class="pre">5</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">auto_round</span></tt></td>
<td><tt class="docutils literal"><span class="pre">False</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rounding</span></tt></td>
<td><tt class="docutils literal"><span class="pre">decimal.DefaultContext.rounding</span></tt></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'decimal'</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">template = '%(column_type)s(%(max_digits)d, %(decimal_places)d)'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CharField">
<em class="property">class </em><tt class="descname">CharField</tt><a class="headerlink" href="#CharField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: small strings (0-255 bytes)</p>
<p>Additional attributes and values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">max_length</span></tt></td>
<td><tt class="docutils literal"><span class="pre">255</span></tt></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'string'</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">template = '%(column_type)s(%(max_length)s)'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="TextField">
<em class="property">class </em><tt class="descname">TextField</tt><a class="headerlink" href="#TextField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: arbitrarily large strings</p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'text'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="DateTimeField">
<em class="property">class </em><tt class="descname">DateTimeField</tt><a class="headerlink" href="#DateTimeField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: python <tt class="docutils literal"><span class="pre">datetime.datetime</span></tt> instances</p>
<p>Accepts a special parameter <tt class="docutils literal"><span class="pre">formats</span></tt>, which contains a list of formats
the datetime can be encoded with.  The default behavior is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S.</span><span class="si">%f</span><span class="s">&#39;</span> <span class="c"># year-month-day hour-minute-second.microsecond</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&#39;</span> <span class="c"># year-month-day hour-minute-second</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span> <span class="c"># year-month-day</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the incoming value does not match a format, it will be returned as-is</p>
</div>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'datetime'</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="DateTimeField.year">
<tt class="descname">year</tt><a class="headerlink" href="#DateTimeField.year" title="Permalink to this definition">¶</a></dt>
<dd><p>An expression suitable for extracting the year, for example to retrieve
all blog posts from 2013:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Blog</span><span class="o">.</span><span class="n">pub_date</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2013</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="DateTimeField.month">
<tt class="descname">month</tt><a class="headerlink" href="#DateTimeField.month" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateTimeField.year" title="DateTimeField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract month.</p>
</dd></dl>

<dl class="attribute">
<dt id="DateTimeField.day">
<tt class="descname">day</tt><a class="headerlink" href="#DateTimeField.day" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateTimeField.year" title="DateTimeField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract day.</p>
</dd></dl>

<dl class="attribute">
<dt id="DateTimeField.hour">
<tt class="descname">hour</tt><a class="headerlink" href="#DateTimeField.hour" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateTimeField.year" title="DateTimeField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract hour.</p>
</dd></dl>

<dl class="attribute">
<dt id="DateTimeField.minute">
<tt class="descname">minute</tt><a class="headerlink" href="#DateTimeField.minute" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateTimeField.year" title="DateTimeField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract minute.</p>
</dd></dl>

<dl class="attribute">
<dt id="DateTimeField.second">
<tt class="descname">second</tt><a class="headerlink" href="#DateTimeField.second" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateTimeField.year" title="DateTimeField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract second..</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="DateField">
<em class="property">class </em><tt class="descname">DateField</tt><a class="headerlink" href="#DateField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: python <tt class="docutils literal"><span class="pre">datetime.date</span></tt> instances</p>
<p>Accepts a special parameter <tt class="docutils literal"><span class="pre">formats</span></tt>, which contains a list of formats
the date can be encoded with.  The default behavior is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span> <span class="c"># year-month-day</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&#39;</span> <span class="c"># year-month-day hour-minute-second</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S.</span><span class="si">%f</span><span class="s">&#39;</span> <span class="c"># year-month-day hour-minute-second.microsecond</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the incoming value does not match a format, it will be returned as-is</p>
</div>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'date'</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="DateField.year">
<tt class="descname">year</tt><a class="headerlink" href="#DateField.year" title="Permalink to this definition">¶</a></dt>
<dd><p>An expression suitable for extracting the year, for example to retrieve
all people born in 1980:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Person</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Person</span><span class="o">.</span><span class="n">dob</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">1983</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="DateField.month">
<tt class="descname">month</tt><a class="headerlink" href="#DateField.month" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateField.year" title="DateField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract month.</p>
</dd></dl>

<dl class="attribute">
<dt id="DateField.day">
<tt class="descname">day</tt><a class="headerlink" href="#DateField.day" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#DateField.year" title="DateField.year"><tt class="xref py py-attr docutils literal"><span class="pre">year</span></tt></a>, except extract day.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="TimeField">
<em class="property">class </em><tt class="descname">TimeField</tt><a class="headerlink" href="#TimeField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: python <tt class="docutils literal"><span class="pre">datetime.time</span></tt> instances</p>
<p>Accepts a special parameter <tt class="docutils literal"><span class="pre">formats</span></tt>, which contains a list of formats
the time can be encoded with.  The default behavior is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;%H:%M:%S.</span><span class="si">%f</span><span class="s">&#39;</span> <span class="c"># hour:minute:second.microsecond</span>
<span class="s">&#39;%H:%M:%S&#39;</span> <span class="c"># hour:minute:second</span>
<span class="s">&#39;%H:%M&#39;</span> <span class="c"># hour:minute</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S.</span><span class="si">%f</span><span class="s">&#39;</span> <span class="c"># year-month-day hour-minute-second.microsecond</span>
<span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&#39;</span> <span class="c"># year-month-day hour-minute-second</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the incoming value does not match a format, it will be returned as-is</p>
</div>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'time'</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="TimeField.hour">
<tt class="descname">hour</tt><a class="headerlink" href="#TimeField.hour" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the hour from a time, for example to retreive all events
occurring in the evening:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Event</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="TimeField.minute">
<tt class="descname">minute</tt><a class="headerlink" href="#TimeField.minute" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#TimeField.hour" title="TimeField.hour"><tt class="xref py py-attr docutils literal"><span class="pre">hour</span></tt></a>, except extract minute.</p>
</dd></dl>

<dl class="attribute">
<dt id="TimeField.second">
<tt class="descname">second</tt><a class="headerlink" href="#TimeField.second" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#TimeField.hour" title="TimeField.hour"><tt class="xref py py-attr docutils literal"><span class="pre">hour</span></tt></a>, except extract second..</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="BooleanField">
<em class="property">class </em><tt class="descname">BooleanField</tt><a class="headerlink" href="#BooleanField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: <tt class="docutils literal"><span class="pre">True</span></tt> / <tt class="docutils literal"><span class="pre">False</span></tt></p>
<dl class="attribute">
<dt>
<tt class="descname">db_field = 'bool'</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ForeignKeyField">
<em class="property">class </em><tt class="descname">ForeignKeyField</tt><big>(</big><em>rel_model</em><span class="optional">[</span>, <em>related_name=None</em><span class="optional">[</span>, <em>cascade=False</em><span class="optional">[</span>, <em>...</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#ForeignKeyField" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores: relationship to another model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rel_model</strong> &#8211; related <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> class or the string &#8216;self&#8217; if declaring
a self-referential foreign key</li>
<li><strong>related_name</strong> (<em>string</em>) &#8211; attribute to expose on related model</li>
<li><strong>cascade</strong> (<em>bool</em>) &#8211; set up foreign key to do cascading deletes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Tweet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;tweets&#39;</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>

<span class="c"># &quot;user&quot; attribute</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">some_tweet</span><span class="o">.</span><span class="n">user</span>
<span class="o">&lt;</span><span class="n">User</span><span class="p">:</span> <span class="n">charlie</span><span class="o">&gt;</span>

<span class="c"># &quot;tweets&quot; related name attribute</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">charlie</span><span class="o">.</span><span class="n">tweets</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">print</span> <span class="n">tweet</span><span class="o">.</span><span class="n">content</span>
<span class="n">Some</span> <span class="n">tweet</span>
<span class="n">Another</span> <span class="n">tweet</span>
<span class="n">Yet</span> <span class="n">another</span> <span class="n">tweet</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Foreign keys do not have a particular <tt class="docutils literal"><span class="pre">db_field</span></tt> as they will
take their field type depending on the type of primary key on the model they are
related to.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="CompositeKey">
<em class="property">class </em><tt class="descname">CompositeKey</tt><big>(</big><em>*fields</em><big>)</big><a class="headerlink" href="#CompositeKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a composite primary key for a model.  Unlike the other fields, a
composite key is defined in the model&#8217;s <tt class="docutils literal"><span class="pre">Meta</span></tt> class after the fields
have been defined.  It takes as parameters the string names of the fields
to use as the primary key:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BlogTagThrough</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;tags&#39;</span><span class="p">)</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Tag</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;blogs&#39;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">primary_key</span> <span class="o">=</span> <span class="n">CompositeKey</span><span class="p">(</span><span class="s">&#39;blog&#39;</span><span class="p">,</span> <span class="s">&#39;tag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="query-types">
<span id="id1"></span><h2>Query Types<a class="headerlink" href="#query-types" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Query">
<em class="property">class </em><tt class="descname">Query</tt><a class="headerlink" href="#Query" title="Permalink to this definition">¶</a></dt>
<dd><p>The parent class from which all other query classes are drived.</p>
<dl class="method">
<dt id="Query.where">
<tt class="descname">where</tt><big>(</big><em>*expressions</em><big>)</big><a class="headerlink" href="#Query.where" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>expressions</strong> &#8211; a list of one or more <a class="reference internal" href="querying.html#expressions"><em>expressions</em></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a <a class="reference internal" href="#Query" title="Query"><tt class="xref py py-class docutils literal"><span class="pre">Query</span></tt></a> instance</td>
</tr>
</tbody>
</table>
<p>Example selection users where the username is equal to &#8216;somebody&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="s">&#39;somebody&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Example selecting tweets made by users who are either editors or administrators:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">is_editor</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span> <span class="o">|</span>
    <span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">is_admin</span> <span class="o">==</span> <span class="bp">True</span><span class="p">))</span>
</pre></div>
</div>
<p>Example of deleting tweets by users who are no longer active:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dq</span> <span class="o">=</span> <span class="n">DeleteQuery</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">Tweet</span><span class="o">.</span><span class="n">user</span> <span class="o">&lt;&lt;</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">False</span><span class="p">))</span>
<span class="n">dq</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># perform the delete query</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="xref py py-meth docutils literal"><span class="pre">where()</span></tt> calls are chainable.  Multiple calls will
be &#8220;AND&#8221;-ed together.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Query.join">
<tt class="descname">join</tt><big>(</big><em>model</em>, <em>join_type=None</em>, <em>on=None</em><big>)</big><a class="headerlink" href="#Query.join" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> &#8211; the model to join on.  there must be a <a class="reference internal" href="#ForeignKeyField" title="ForeignKeyField"><tt class="xref py py-class docutils literal"><span class="pre">ForeignKeyField</span></tt></a> between
the current <tt class="docutils literal"><span class="pre">query</span> <span class="pre">context</span></tt> and the model passed in.</li>
<li><strong>join_type</strong> &#8211; allows the type of <tt class="docutils literal"><span class="pre">JOIN</span></tt> used to be specified explicitly,
one of <tt class="docutils literal"><span class="pre">JOIN_INNER</span></tt>, <tt class="docutils literal"><span class="pre">JOIN_LEFT_OUTER</span></tt>, <tt class="docutils literal"><span class="pre">JOIN_FULL</span></tt></li>
<li><strong>on</strong> &#8211; if multiple foreign keys exist between two models, this parameter
is the ForeignKeyField to join on.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#Query" title="Query"><tt class="xref py py-class docutils literal"><span class="pre">Query</span></tt></a> instance</p>
</td>
</tr>
</tbody>
</table>
<p>Generate a <tt class="docutils literal"><span class="pre">JOIN</span></tt> clause from the current <tt class="docutils literal"><span class="pre">query</span> <span class="pre">context</span></tt> to the <tt class="docutils literal"><span class="pre">model</span></tt> passed
in, and establishes <tt class="docutils literal"><span class="pre">model</span></tt> as the new <tt class="docutils literal"><span class="pre">query</span> <span class="pre">context</span></tt>.</p>
<p>Example selecting tweets and joining on user in order to restrict to
only those tweets made by &#8220;admin&#8221; users:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">is_admin</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Example selecting users and joining on a particular foreign key field.
See the <a class="reference internal" href="example.html#example-app"><em>example app</em></a> for a real-life usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Relationship</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">Relationship</span><span class="o">.</span><span class="n">to_user</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Query.switch">
<tt class="descname">switch</tt><big>(</big><em>model</em><big>)</big><a class="headerlink" href="#Query.switch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model</strong> &#8211; model to switch the <tt class="docutils literal"><span class="pre">query</span> <span class="pre">context</span></tt> to.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a clone of the query with a new query context</td>
</tr>
</tbody>
</table>
<p>Switches the <tt class="docutils literal"><span class="pre">query</span> <span class="pre">context</span></tt> to the given model.  Raises an exception if the
model has not been selected or joined on previously.  Useful for performing
multiple joins from a single table.</p>
<p>The following example selects from blog and joins on both entry and user:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Entry</span><span class="p">)</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Query.filter">
<tt class="descname">filter</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#Query.filter" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span>Deprecated since version 2.0: </span>Use instead <a class="reference internal" href="#Query.where" title="Query.where"><tt class="xref py py-meth docutils literal"><span class="pre">Query.where()</span></tt></a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; a list of <tt class="xref py py-class docutils literal"><span class="pre">DQ</span></tt> or <tt class="xref py py-class docutils literal"><span class="pre">Node</span></tt> objects</li>
<li><strong>kwargs</strong> &#8211; a mapping of column + lookup to value, e.g. &#8220;age__gt=55&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> with appropriate <tt class="docutils literal"><span class="pre">WHERE</span></tt> clauses</p>
</td>
</tr>
</tbody>
</table>
<p>Provides a django-like syntax for building a query. The key difference
between <a class="reference internal" href="#Model.filter" title="Model.filter"><tt class="xref py py-meth docutils literal"><span class="pre">filter()</span></tt></a> and <tt class="xref py py-meth docutils literal"><span class="pre">SelectQuery.where()</span></tt>
is that <a class="reference internal" href="#Model.filter" title="Model.filter"><tt class="xref py py-meth docutils literal"><span class="pre">filter()</span></tt></a> supports traversing joins using
django&#8217;s &#8220;double-underscore&#8221; syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__title</span><span class="o">=</span><span class="s">&#39;Some Blog&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This method is chainable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">base_q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">some_user</span> <span class="o">=</span> <span class="n">base_q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;charlie&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method is provided for compatibility with peewee 1.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Query.alias">
<tt class="descname">alias</tt><big>(</big><em>alias=None</em><big>)</big><a class="headerlink" href="#Query.alias" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alias</strong> (<em>str</em>) &#8211; A string to alias the result of this query</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a Query instance</td>
</tr>
</tbody>
</table>
<p>Assign an alias to given query, which can be used as part of a subquery.</p>
</dd></dl>

<dl class="method">
<dt id="Query.sql">
<tt class="descname">sql</tt><big>(</big><big>)</big><a class="headerlink" href="#Query.sql" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a 2-tuple containing the appropriate SQL query and a tuple of parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Query.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#Query.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given query</p>
</dd></dl>

<dl class="method">
<dt id="Query.scalar">
<tt class="descname">scalar</tt><big>(</big><span class="optional">[</span><em>as_tuple=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Query.scalar" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>as_tuple</strong> (<em>bool</em>) &#8211; return the row as a tuple or a single value</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">the resulting row, either as a single value or tuple</td>
</tr>
</tbody>
</table>
<p>Provide a way to retrieve single values from select queries, for instance
when performing an aggregation.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">PageView</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">Distinct</span><span class="p">(</span><span class="n">PageView</span><span class="o">.</span><span class="n">url</span><span class="p">)))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">100 # &lt;-- there are 100 distinct URLs in the pageview table</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="SelectQuery">
<em class="property">class </em><tt class="descname">SelectQuery</tt><big>(</big><em>model</em>, <em>*selection</em><big>)</big><a class="headerlink" href="#SelectQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>By far the most complex of the query classes available in peewee. It supports
all clauses commonly associated with select queries.</p>
<p>Methods on the select query can be chained together.</p>
<p><tt class="docutils literal"><span class="pre">SelectQuery</span></tt> implements an <a class="reference internal" href="#SelectQuery.__iter__" title="SelectQuery.__iter__"><tt class="xref py py-meth docutils literal"><span class="pre">__iter__()</span></tt></a> method, allowing it to be iterated
to return model instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> &#8211; a <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> class to perform query on</li>
<li><strong>selection</strong> &#8211; a list of models, fields, functions or expressions</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If no selection is provided, it will default to all the fields of the given
model.</p>
<p>Example selecting some user instances from the database.  Only the <tt class="docutils literal"><span class="pre">id</span></tt>
and <tt class="docutils literal"><span class="pre">username</span></tt> columns are selected.  When iterated, will return instances
of the <tt class="docutils literal"><span class="pre">User</span></tt> model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">sq</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span>
</pre></div>
</div>
<p>Example selecting users and additionally the number of tweets made by the user.
The <tt class="docutils literal"><span class="pre">User</span></tt> instances returned will have an additional attribute, &#8216;count&#8217;, that
corresponds to the number of tweets made:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">SelectQuery</span><span class="p">(</span>
    <span class="n">User</span><span class="p">,</span> <span class="n">User</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="SelectQuery.group_by">
<tt class="descname">group_by</tt><big>(</big><em>*clauses</em><big>)</big><a class="headerlink" href="#SelectQuery.group_by" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>clauses</strong> &#8211; a list of expressions, which can be model classes or individual field instances</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Group by one or more columns.  If a model class is provided, all the fields
on that model class will be used.</p>
<p>Example selecting users, joining on tweets, and grouping by the user so
a count of tweets can be calculated for each user:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">User</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.having">
<tt class="descname">having</tt><big>(</big><em>*expressions</em><big>)</big><a class="headerlink" href="#SelectQuery.having" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>expressions</strong> &#8211; a list of one or more <a class="reference internal" href="querying.html#expressions"><em>expressions</em></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Here is the above example selecting users and tweet counts, but restricting
the results to those users who have created 100 or more tweets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">User</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="o">.</span><span class="n">having</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.order_by">
<tt class="descname">order_by</tt><big>(</big><em>*clauses</em><big>)</big><a class="headerlink" href="#SelectQuery.order_by" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>clauses</strong> &#8211; a list of fields, calls to <tt class="docutils literal"><span class="pre">field.[asc|desc]()</span></tt> or one or more <a class="reference internal" href="querying.html#expressions"><em>expressions</em></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Example of ordering users by username:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<p>Example of selecting tweets and ordering them first by user, then newest
first:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Tweet</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span>
    <span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">Tweet</span><span class="o">.</span><span class="n">created_date</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
</pre></div>
</div>
<p>A more complex example ordering users by the number of tweets made (greatest
to least), then ordered by username in the event of a tie:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tweet_ct</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">Count</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">User</span>
    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">tweet_ct</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">tweet_ct</span><span class="o">.</span><span class="n">desc</span><span class="p">(),</span> <span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.limit">
<tt class="descname">limit</tt><big>(</big><em>num</em><big>)</big><a class="headerlink" href="#SelectQuery.limit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>int</em>) &#8211; limit results to <tt class="docutils literal"><span class="pre">num</span></tt> rows</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.offset">
<tt class="descname">offset</tt><big>(</big><em>num</em><big>)</big><a class="headerlink" href="#SelectQuery.offset" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>int</em>) &#8211; offset results by <tt class="docutils literal"><span class="pre">num</span></tt> rows</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.paginate">
<tt class="descname">paginate</tt><big>(</big><em>page_num</em>, <em>paginate_by=20</em><big>)</big><a class="headerlink" href="#SelectQuery.paginate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>page_num</strong> &#8211; a 1-based page number to use for paginating results</li>
<li><strong>paginate_by</strong> &#8211; number of results to return per-page</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>Shorthand for applying a <tt class="docutils literal"><span class="pre">LIMIT</span></tt> and <tt class="docutils literal"><span class="pre">OFFSET</span></tt> to the query.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span><span class="p">)</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c"># get users 41-60</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.distinct">
<tt class="descname">distinct</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.distinct" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>indicates that this query should only return distinct rows.  results in a
<tt class="docutils literal"><span class="pre">SELECT</span> <span class="pre">DISTINCT</span></tt> query.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.for_update">
<tt class="descname">for_update</tt><big>(</big><span class="optional">[</span><em>for_update=True</em><span class="optional">[</span>, <em>nowait=False</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#SelectQuery.for_update" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Indicate that this query should lock rows for update.  If <tt class="docutils literal"><span class="pre">nowait</span></tt> is
<tt class="docutils literal"><span class="pre">True</span></tt> then the database will raise an <tt class="docutils literal"><span class="pre">OperationalError</span></tt> if it
cannot obtain the lock.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.naive">
<tt class="descname">naive</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.naive" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Flag this query indicating it should only attempt to reconstruct a single model
instance for every row returned by the cursor.  If multiple tables were queried,
the columns returned are patched directly onto the single model instance.</p>
<p>Generally this method is useful for speeding up the time needed to construct
model instances given a database cursor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this can provide a significant speed improvement when doing simple
iteration over a large result set.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.iterator">
<tt class="descname">iterator</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.iterator" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="docutils literal"><span class="pre">iterable</span></tt></td>
</tr>
</tbody>
</table>
<p>By default peewee will cache rows returned by the cursor.  This is to
prevent things like multiple iterations, slicing and indexing from
triggering extra queries.  When you are iterating over a large number
of rows, however, this cache can take up a lot of memory. Using <tt class="docutils literal"><span class="pre">iterator()</span></tt>
will save memory by not storing all the returned model instances.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># iterate over large number of rows.</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">Stats</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">iterator</span><span class="p">():</span>
    <span class="c"># do something.</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.tuples">
<tt class="descname">tuples</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.tuples" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Flag this query indicating it should simply return raw tuples from the cursor.
This method is useful when you either do not want or do not need full model
instances.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.dicts">
<tt class="descname">dicts</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.dicts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Flag this query indicating it should simply return dictionaries from the cursor.
This method is useful when you either do not want or do not need full model
instances.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.annotate">
<tt class="descname">annotate</tt><big>(</big><em>related_model</em>, <em>aggregation=None</em><big>)</big><a class="headerlink" href="#SelectQuery.annotate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>related_model</strong> &#8211; related <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> on which to perform aggregation,
must be linked by <a class="reference internal" href="#ForeignKeyField" title="ForeignKeyField"><tt class="xref py py-class docutils literal"><span class="pre">ForeignKeyField</span></tt></a>.</li>
<li><strong>aggregation</strong> &#8211; the type of aggregation to use, e.g. <tt class="docutils literal"><span class="pre">fn.Count(Tweet.id).alias('count')</span></tt></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>Annotate a query with an aggregation performed on a related model, for example,
&#8220;get a list of users with the number of tweets for each&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">aggregation</span></tt> is None, it will default to <tt class="docutils literal"><span class="pre">fn.Count(related_model.id).alias('count')</span></tt>
but can be anything:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">user_latest</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Tweet</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="n">Max</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">created_date</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s">&#39;latest&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If the <tt class="docutils literal"><span class="pre">ForeignKeyField</span></tt> is <tt class="docutils literal"><span class="pre">nullable</span></tt>, then a <tt class="docutils literal"><span class="pre">LEFT</span> <span class="pre">OUTER</span></tt> join
may need to be used:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Tweet</span><span class="p">,</span> <span class="n">JOIN_LEFT_OUTER</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.aggregate">
<tt class="descname">aggregate</tt><big>(</big><em>aggregation</em><big>)</big><a class="headerlink" href="#SelectQuery.aggregate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>aggregation</strong> &#8211; a function specifying what aggregation to perform, for
example <tt class="docutils literal"><span class="pre">fn.Max(Tweet.created_date)</span></tt>.</td>
</tr>
</tbody>
</table>
<p>Method to look at an aggregate of rows using a given function and
return a scalar value, such as the count of all rows or the average
value of a particular column.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.count">
<tt class="descname">count</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.count" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">an integer representing the number of rows in the current query</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sq</span> <span class="o">=</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="n">Tweet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sq</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">45  # number of tweets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sq</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">DELETED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sq</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">3  # number of tweets that are marked as deleted</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.wrapped_count">
<tt class="descname">wrapped_count</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.wrapped_count" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">an integer representing the number of rows in the current query</td>
</tr>
</tbody>
</table>
<p>Wrap the count query in a subquery.  Additional overhead but will give
correct counts when performing <tt class="docutils literal"><span class="pre">DISTINCT</span></tt> queries or those with <tt class="docutils literal"><span class="pre">GROUP</span> <span class="pre">BY</span></tt>
clauses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#SelectQuery.count" title="SelectQuery.count"><tt class="xref py py-meth docutils literal"><span class="pre">count()</span></tt></a> will automatically default to <a class="reference internal" href="#SelectQuery.wrapped_count" title="SelectQuery.wrapped_count"><tt class="xref py py-meth docutils literal"><span class="pre">wrapped_count()</span></tt></a>
in the event the query is distinct or has a grouping.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.exists">
<tt class="descname">exists</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.exists" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">boolean whether the current query will return any rows.  uses an
optimized lookup, so use this rather than <a class="reference internal" href="#SelectQuery.get" title="SelectQuery.get"><tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt></a>.</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sq</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">sq</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">,</span> <span class="n">User</span><span class="o">.</span><span class="n">password</span> <span class="o">==</span> <span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">authenticated</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.get">
<tt class="descname">get</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.get" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> instance or raises <tt class="docutils literal"><span class="pre">DoesNotExist</span></tt> exception</td>
</tr>
</tbody>
</table>
<p>Get a single row from the database that matches the given query.  Raises a
<tt class="docutils literal"><span class="pre">&lt;model-class&gt;.DoesNotExist</span></tt> if no rows are returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">active</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">active</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
<p>This method is also exposed via the <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> api, in which case it
accepts arguments that are translated to the where clause:</p>
<blockquote>
<div>user = User.get(User.active == True, User.username == username)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.first">
<tt class="descname">first</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.first" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> instance or <tt class="docutils literal"><span class="pre">None</span></tt> if no results</td>
</tr>
</tbody>
</table>
<p>Fetch the first row from a query. The result will be cached in case the entire
query result-set should be iterated later.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">QueryResultWrapper</span></tt></td>
</tr>
</tbody>
</table>
<p>Executes the query and returns a <tt class="xref py py-class docutils literal"><span class="pre">QueryResultWrapper</span></tt> for iterating over
the result set.  The results are managed internally by the query and whenever
a clause is added that would possibly alter the result set, the query is
marked for re-execution.</p>
</dd></dl>

<dl class="method">
<dt id="SelectQuery.__iter__">
<tt class="descname">__iter__</tt><big>(</big><big>)</big><a class="headerlink" href="#SelectQuery.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the query and returns populated model instances:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="UpdateQuery">
<em class="property">class </em><tt class="descname">UpdateQuery</tt><big>(</big><em>model</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#UpdateQuery" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> &#8211; <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> class on which to perform update</li>
<li><strong>kwargs</strong> &#8211; mapping of field/value pairs containing columns and values to update</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example in which users are marked inactive if their registration expired:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">uq</span> <span class="o">=</span> <span class="n">UpdateQuery</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">registration_expired</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">uq</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># Perform the actual update</span>
</pre></div>
</div>
<p>Example of an atomic update:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">atomic_update</span> <span class="o">=</span> <span class="n">UpdateQuery</span><span class="p">(</span><span class="n">PageCount</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">PageCount</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">PageCount</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="n">url</span><span class="p">)</span>
<span class="n">atomic_update</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># will perform the actual update</span>
</pre></div>
</div>
<dl class="method">
<dt id="UpdateQuery.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#UpdateQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Number of rows updated</td>
</tr>
</tbody>
</table>
<p>Performs the query</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="InsertQuery">
<em class="property">class </em><tt class="descname">InsertQuery</tt><big>(</big><em>model</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#InsertQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an <tt class="docutils literal"><span class="pre">InsertQuery</span></tt> instance for the given model where kwargs is a
dictionary of field name to value:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">iq</span> <span class="o">=</span> <span class="n">InsertQuery</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iq</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>  <span class="c"># insert new row and return primary key</span>
<span class="go">2L</span>
</pre></div>
</div>
<dl class="method">
<dt id="InsertQuery.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#InsertQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">primary key of the new row</td>
</tr>
</tbody>
</table>
<p>Performs the query</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="DeleteQuery">
<em class="property">class </em><tt class="descname">DeleteQuery</tt><a class="headerlink" href="#DeleteQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <tt class="docutils literal"><span class="pre">DeleteQuery</span></tt> instance for the given model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DeleteQuery will <em>not</em> traverse foreign keys or ensure that constraints
are obeyed, so use it with care.</p>
</div>
<p>Example deleting users whose account is inactive:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dq</span> <span class="o">=</span> <span class="n">DeleteQuery</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="DeleteQuery.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#DeleteQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Number of rows deleted</td>
</tr>
</tbody>
</table>
<p>Performs the query</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="RawQuery">
<em class="property">class </em><tt class="descname">RawQuery</tt><a class="headerlink" href="#RawQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows execution of an arbitrary query and returns instances
of the model via a <tt class="xref py py-class docutils literal"><span class="pre">QueryResultsWrapper</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Generally you will only need this for executing highly optimized SELECT
queries.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you are executing a parameterized query, you must use the correct
interpolation string for your database.  SQLite uses <tt class="docutils literal"><span class="pre">'?'</span></tt> and most others
use <tt class="docutils literal"><span class="pre">'%s'</span></tt>.</p>
</div>
<p>Example selecting users with a given username:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rq</span> <span class="o">=</span> <span class="n">RawQuery</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="s">&#39;SELECT * FROM users WHERE username = ?&#39;</span><span class="p">,</span> <span class="s">&#39;admin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">rq</span><span class="o">.</span><span class="n">execute</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">obj</span>
<span class="go">&lt;User: admin&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="RawQuery.tuples">
<tt class="descname">tuples</tt><big>(</big><big>)</big><a class="headerlink" href="#RawQuery.tuples" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#RawQuery" title="RawQuery"><tt class="xref py py-class docutils literal"><span class="pre">RawQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Flag this query indicating it should simply return raw tuples from the cursor.
This method is useful when you either do not want or do not need full model
instances.</p>
</dd></dl>

<dl class="method">
<dt id="RawQuery.dicts">
<tt class="descname">dicts</tt><big>(</big><big>)</big><a class="headerlink" href="#RawQuery.dicts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#RawQuery" title="RawQuery"><tt class="xref py py-class docutils literal"><span class="pre">RawQuery</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Flag this query indicating it should simply return raw dicts from the cursor.
This method is useful when you either do not want or do not need full model
instances.</p>
</dd></dl>

<dl class="method">
<dt id="RawQuery.execute">
<tt class="descname">execute</tt><big>(</big><big>)</big><a class="headerlink" href="#RawQuery.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a <tt class="xref py py-class docutils literal"><span class="pre">QueryResultWrapper</span></tt> for iterating over the result set.  The results are instances of the given model.</td>
</tr>
</tbody>
</table>
<p>Performs the query</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="prefetch">
<tt class="descname">prefetch</tt><big>(</big><em>sq</em>, <em>*subqueries</em><big>)</big><a class="headerlink" href="#prefetch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sq</strong> &#8211; <a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> instance</li>
<li><strong>subqueries</strong> &#8211; one or more <a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> instances to prefetch for <tt class="docutils literal"><span class="pre">sq</span></tt>. You
can also pass models, but they will be converted into SelectQueries.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> with related instances pre-populated</p>
</td>
</tr>
</tbody>
</table>
<p>Pre-fetch the appropriate instances from the subqueries and apply them to
their corresponding parent row in the outer query. This function will eagerly
load the related instances specified in the subqueries. This is a technique used
to save doing O(n) queries for n rows, and rather is O(k) queries for <em>k</em>
subqueries.</p>
<p>For example, consider you have a list of users and want to display all their
tweets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># let&#39;s impost some small restrictions on our queries</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">tweets</span> <span class="o">=</span> <span class="n">Tweet</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Tweet</span><span class="o">.</span><span class="n">published</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>

<span class="c"># this will perform 2 queries</span>
<span class="n">users_pf</span> <span class="o">=</span> <span class="n">prefetch</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">tweets</span><span class="p">)</span>

<span class="c"># now we can:</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users_pf</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span>
    <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">tweets_prefetch</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;- &#39;</span><span class="p">,</span> <span class="n">tweet</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
<p>You can prefetch an arbitrary number of items.  For instance, suppose we have
a photo site, User -&gt; Photo -&gt; (Comments, Tags).  That is, users can post photos,
and these photos can have tags and comments on them.  If we wanted to fetch a
list of users, all their photos, and all the comments and tags on the photos:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
<span class="n">published_photos</span> <span class="o">=</span> <span class="n">Photo</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Photo</span><span class="o">.</span><span class="n">published</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">published_comments</span> <span class="o">=</span> <span class="n">Comment</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">Comment</span><span class="o">.</span><span class="n">is_spam</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">Comment</span><span class="o">.</span><span class="n">num_flags</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">))</span>

<span class="c"># note that we are just passing the Tag model -- it will be converted</span>
<span class="c"># to a query automatically</span>
<span class="n">users_pf</span> <span class="o">=</span> <span class="n">prefetch</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">published_photos</span><span class="p">,</span> <span class="n">published_comments</span><span class="p">,</span> <span class="n">Tag</span><span class="p">)</span>

<span class="c"># now we can iterate users, photos, and comments/tags</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users_pf</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">photo</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">photo_set_prefetch</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">photo</span><span class="o">.</span><span class="n">comment_set_prefetch</span><span class="p">:</span>
            <span class="c"># ...</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">photo</span><span class="o">.</span><span class="n">tag_set_prefetch</span><span class="p">:</span>
            <span class="c"># ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Subqueries must be related by foreign key and can be arbitrarily deep</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><a class="reference internal" href="#prefetch" title="prefetch"><tt class="xref py py-func docutils literal"><span class="pre">prefetch()</span></tt></a> can use up lots of RAM when the result set is large,
and will not warn you if you are doing something dangerous, so it is up
to you to know when to use it.  Additionally, because of the semantics of
subquerying, there may be some cases when prefetch does not act as you
expect (for instnace, when applying a <tt class="docutils literal"><span class="pre">LIMIT</span></tt> to subqueries, but there
may be others) &#8211; please report anything you think is a bug to <a class="reference external" href="https://github.com/coleifer/peewee/issues">github</a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="database-and-its-subclasses">
<h2>Database and its subclasses<a class="headerlink" href="#database-and-its-subclasses" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Database">
<em class="property">class </em><tt class="descname">Database</tt><big>(</big><em>database</em><span class="optional">[</span>, <em>threadlocals=False</em><span class="optional">[</span>, <em>autocommit=True</em><span class="optional">[</span>, <em>fields=None</em><span class="optional">[</span>, <em>ops=None</em><span class="optional">[</span>, <em>**connect_kwargs</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>database</strong> &#8211; the name of the database (or filename if using sqlite)</li>
<li><strong>threadlocals</strong> &#8211; whether to store connections in a threadlocal</li>
<li><strong>autocommit</strong> &#8211; automatically commit every query executed by calling <tt class="xref py py-meth docutils literal"><span class="pre">execute()</span></tt></li>
<li><strong>fields</strong> (<em>dict</em>) &#8211; a mapping of <tt class="xref py py-attr docutils literal"><span class="pre">db_field</span></tt> to database column type, e.g. &#8216;string&#8217; =&gt; &#8216;varchar&#8217;</li>
<li><strong>ops</strong> (<em>dict</em>) &#8211; a mapping of operations understood by the querycompiler to expressions</li>
<li><strong>connect_kwargs</strong> &#8211; any arbitrary parameters to pass to the database driver when connecting</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if your database name is not known when the class is declared, you can pass
<tt class="docutils literal"><span class="pre">None</span></tt> in as the database name which will mark the database as &#8220;deferred&#8221;
and any attempt to connect while in this state will raise an exception.  To
initialize your database, call the <a class="reference internal" href="#Database.init" title="Database.init"><tt class="xref py py-meth docutils literal"><span class="pre">Database.init()</span></tt></a> method with
the database name</p>
</div>
<p>A high-level api for working with the supported database engines.  <tt class="docutils literal"><span class="pre">Database</span></tt>
provides a wrapper around some of the functions performed by the <tt class="docutils literal"><span class="pre">Adapter</span></tt>,
in addition providing support for:</p>
<ul class="simple">
<li>execution of SQL queries</li>
<li>creating and dropping tables and indexes</li>
</ul>
<dl class="attribute">
<dt>
<tt class="descname">commit_select = False</tt></dt>
<dd><p>Whether to issue a commit after executing a select query.  With some engines
can prevent implicit transactions from piling up.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">compiler_class = QueryCompiler</tt></dt>
<dd><p>A class suitable for compiling queries</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">field_overrides = {}</tt></dt>
<dd><p>A mapping of field types to database column types, e.g. <tt class="docutils literal"><span class="pre">{'primary_key':</span> <span class="pre">'SERIAL'}</span></tt></p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">for_update = False</tt></dt>
<dd><p>Whether the given backend supports selecting rows for update</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">interpolation = '?'</tt></dt>
<dd><p>The string used by the driver to interpolate query parameters</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">op_overrides = {}</tt></dt>
<dd><p>A mapping of operation codes to string operations, e.g. <tt class="docutils literal"><span class="pre">{OP_LIKE:</span> <span class="pre">'LIKE</span> <span class="pre">BINARY'}</span></tt></p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">quote_char = '&quot;'</tt></dt>
<dd><p>The string used by the driver to quote names</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">reserved_tables = []</tt></dt>
<dd><p>Table names that are reserved by the backend &#8211; if encountered in the
application a warning will be issued.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">sequences = False</tt></dt>
<dd><p>Whether the given backend supports sequences</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">subquery_delete_same_table = True</tt></dt>
<dd><p>Whether the given backend supports deleting rows using a subquery
that selects from the same table</p>
</dd></dl>

<dl class="method">
<dt id="Database.init">
<tt class="descname">init</tt><big>(</big><em>database</em><span class="optional">[</span>, <em>**connect_kwargs</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database.init" title="Permalink to this definition">¶</a></dt>
<dd><p>If the database was instantiated with <tt class="docutils literal"><span class="pre">database=None</span></tt>, the database is said to be in
a &#8216;deferred&#8217; state (see <a class="reference internal" href="cookbook.html#deferring-initialization"><em>notes</em></a>) &#8211; if this is the case,
you can initialize it at any time by calling the <tt class="docutils literal"><span class="pre">init</span></tt> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>database</strong> &#8211; the name of the database (or filename if using sqlite)</li>
<li><strong>connect_kwargs</strong> &#8211; any arbitrary parameters to pass to the database driver when connecting</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.connect">
<tt class="descname">connect</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Establishes a connection to the database</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you initialized with <tt class="docutils literal"><span class="pre">threadlocals=True</span></tt>, then this will store
the connection inside a threadlocal, ensuring that connections are not
shared across threads.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the connection to the database (if one is open)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you initialized with <tt class="docutils literal"><span class="pre">threadlocals=True</span></tt>, only a connection local
to the calling thread will be closed.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.get_conn">
<tt class="descname">get_conn</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.get_conn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a connection to the database, creates one if does not exist</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.get_cursor">
<tt class="descname">get_cursor</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.get_cursor" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a cursor for executing queries</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.last_insert_id">
<tt class="descname">last_insert_id</tt><big>(</big><em>cursor</em>, <em>model</em><big>)</big><a class="headerlink" href="#Database.last_insert_id" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cursor</strong> &#8211; the database cursor used to perform the insert query</li>
<li><strong>model</strong> &#8211; the model class that was just created</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">the primary key of the most recently inserted instance</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.rows_affected">
<tt class="descname">rows_affected</tt><big>(</big><em>cursor</em><big>)</big><a class="headerlink" href="#Database.rows_affected" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">number of rows affected by the last query</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.compiler">
<tt class="descname">compiler</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.compiler" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">an instance of <tt class="xref py py-class docutils literal"><span class="pre">QueryCompiler</span></tt> using the field and
op overrides specified.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.execute_sql">
<tt class="descname">execute_sql</tt><big>(</big><em>sql</em><span class="optional">[</span>, <em>params=None</em><span class="optional">[</span>, <em>require_commit=True</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database.execute_sql" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sql</strong> &#8211; a string sql query</li>
<li><strong>params</strong> &#8211; a list or tuple of parameters to interpolate</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can configure whether queries will automatically commit by using
the <a class="reference internal" href="#Database.set_autocommit" title="Database.set_autocommit"><tt class="xref py py-meth docutils literal"><span class="pre">set_autocommit()</span></tt></a> and <a class="reference internal" href="#Database.get_autocommit" title="Database.get_autocommit"><tt class="xref py py-meth docutils literal"><span class="pre">Database.get_autocommit()</span></tt></a>
methods.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.begin">
<tt class="descname">begin</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate a new transaction.  By default <strong>not</strong> implemented as this is not
part of the DB-API 2.0, but provided for API compatibility.</p>
</dd></dl>

<dl class="method">
<dt id="Database.commit">
<tt class="descname">commit</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <tt class="docutils literal"><span class="pre">commit()</span></tt> on the active connection, committing the current transaction</p>
</dd></dl>

<dl class="method">
<dt id="Database.rollback">
<tt class="descname">rollback</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <tt class="docutils literal"><span class="pre">rollback()</span></tt> on the active connection, rolling back the current transaction</p>
</dd></dl>

<dl class="method">
<dt id="Database.set_autocommit">
<tt class="descname">set_autocommit</tt><big>(</big><em>autocommit</em><big>)</big><a class="headerlink" href="#Database.set_autocommit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>autocommit</strong> &#8211; a boolean value indicating whether to turn on/off autocommit
<strong>for the current connection</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.get_autocommit">
<tt class="descname">get_autocommit</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.get_autocommit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a boolean value indicating whether autocommit is on <strong>for the current connection</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.get_tables">
<tt class="descname">get_tables</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.get_tables" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">a list of table names in the database</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not implemented &#8211; implementations exist in subclasses</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.get_indexes_for_table">
<tt class="descname">get_indexes_for_table</tt><big>(</big><em>table</em><big>)</big><a class="headerlink" href="#Database.get_indexes_for_table" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>table</strong> &#8211; the name of table to introspect</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">a list of <tt class="docutils literal"><span class="pre">(index_name,</span> <span class="pre">is_unique)</span></tt> tuples</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not implemented &#8211; implementations exist in subclasses</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.sequence_exists">
<tt class="descname">sequence_exists</tt><big>(</big><em>sequence_name</em><big>)</big><a class="headerlink" href="#Database.sequence_exists" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype boolean:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not implemented &#8211; implementations exist in subclasses</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.create_table">
<tt class="descname">create_table</tt><big>(</big><em>model_class</em><big>)</big><a class="headerlink" href="#Database.create_table" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model_class</strong> &#8211; <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> class to create table for</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.create_index">
<tt class="descname">create_index</tt><big>(</big><em>model_class</em>, <em>fields</em><span class="optional">[</span>, <em>unique=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database.create_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_class</strong> &#8211; <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> table on which to create index</li>
<li><strong>fields</strong> &#8211; field(s) to create index on (either field instances or field names)</li>
<li><strong>unique</strong> &#8211; whether the index should enforce uniqueness</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.create_foreign_key">
<tt class="descname">create_foreign_key</tt><big>(</big><em>model_class</em>, <em>field</em><big>)</big><a class="headerlink" href="#Database.create_foreign_key" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_class</strong> &#8211; <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> table on which to create foreign key index / constraint</li>
<li><strong>field</strong> &#8211; <a class="reference internal" href="#Field" title="Field"><tt class="xref py py-class docutils literal"><span class="pre">Field</span></tt></a> object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.create_sequence">
<tt class="descname">create_sequence</tt><big>(</big><em>sequence_name</em><big>)</big><a class="headerlink" href="#Database.create_sequence" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sequence_name</strong> &#8211; name of sequence to create</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">only works with database engines that support sequences</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.drop_table">
<tt class="descname">drop_table</tt><big>(</big><em>model_class</em><span class="optional">[</span>, <em>fail_silently=False</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database.drop_table" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_class</strong> &#8211; <a class="reference internal" href="#Model" title="Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> table to drop</li>
<li><strong>fail_silently</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, query will add a <tt class="docutils literal"><span class="pre">IF</span> <span class="pre">EXISTS</span></tt> clause</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cascading drop tables are not supported at this time, so if a constraint
exists that prevents a table being dropped, you will need to handle
that in application logic.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.drop_sequence">
<tt class="descname">drop_sequence</tt><big>(</big><em>sequence_name</em><big>)</big><a class="headerlink" href="#Database.drop_sequence" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sequence_name</strong> &#8211; name of sequence to drop</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">only works with database engines that support sequences</p>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.transaction">
<tt class="descname">transaction</tt><big>(</big><big>)</big><a class="headerlink" href="#Database.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a context manager that executes statements in a transaction.  If an
error is raised inside the context manager, the transaction will be rolled
back, otherwise statements are committed when exiting.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># delete a blog instance and all its associated entries, but</span>
<span class="c"># do so within a transaction</span>
<span class="k">with</span> <span class="n">database</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.commit_on_success">
<tt class="descname">commit_on_success</tt><big>(</big><em>func</em><big>)</big><a class="headerlink" href="#Database.commit_on_success" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that wraps the given function in a single transaction, which,
upon success will be committed.  If an error is raised inside the function,
the transaction will be rolled back and the error will be re-raised.</p>
<p>Nested functions can be wrapped with <tt class="docutils literal"><span class="pre">commit_on_success</span></tt> - the database
will keep a stack and only commit when it reaches the end of the outermost
function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> &#8211; function to decorate</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@database.commit_on_success</span>
<span class="k">def</span> <span class="nf">transfer_money</span><span class="p">(</span><span class="n">from_acct</span><span class="p">,</span> <span class="n">to_acct</span><span class="p">,</span> <span class="n">amt</span><span class="p">):</span>
    <span class="n">from_acct</span><span class="o">.</span><span class="n">charge</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
    <span class="n">to_acct</span><span class="o">.</span><span class="n">pay</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">amt</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Database.savepoint">
<tt class="descname">savepoint</tt><big>(</big><span class="optional">[</span><em>sid=None</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#Database.savepoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a context manager that executes statements in a savepoint.  If an
error is raised inside the context manager, the savepoint will be rolled
back, otherwise statements are committed when exiting.</p>
<p>Savepoints can be thought of as nested transactions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sid</strong> (<em>str</em>) &#8211; A string identifier for the savepoint.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="Database.register_fields">
<em class="property">classmethod </em><tt class="descname">register_fields</tt><big>(</big><em>fields</em><big>)</big><a class="headerlink" href="#Database.register_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a mapping of field overrides for the database class.  Used
to register custom fields or override the defaults.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>dict</em>) &#8211; A mapping of <tt class="xref py py-attr docutils literal"><span class="pre">db_field</span></tt> to column type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="Database.register_ops">
<em class="property">classmethod </em><tt class="descname">register_ops</tt><big>(</big><em>ops</em><big>)</big><a class="headerlink" href="#Database.register_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a mapping of operations understood by the QueryCompiler to their
SQL equivalent, e.g. <tt class="docutils literal"><span class="pre">{OP_EQ:</span> <span class="pre">'='}</span></tt>.  Used to extend the types of field
comparisons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>dict</em>) &#8211; A mapping of <tt class="xref py py-attr docutils literal"><span class="pre">db_field</span></tt> to column type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.extract_date">
<tt class="descname">extract_date</tt><big>(</big><em>date_part</em>, <em>date_field</em><big>)</big><a class="headerlink" href="#Database.extract_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an expression suitable for extracting a date part from a date
field.  For instance, extract the year from a <a class="reference internal" href="#DateTimeField" title="DateTimeField"><tt class="xref py py-class docutils literal"><span class="pre">DateTimeField</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>date_part</strong> (<em>str</em>) &#8211; The date part attribute to retrieve.  Valid options
are: &#8220;year&#8221;, &#8220;month&#8221;, &#8220;day&#8221;, &#8220;hour&#8221;, &#8220;minute&#8221; and &#8220;second&#8221;.</li>
<li><strong>date_field</strong> (<a class="reference internal" href="#Field" title="Field"><em>Field</em></a>) &#8211; field instance storing a datetime, date or time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">an expression object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Database.sql_error_handler">
<tt class="descname">sql_error_handler</tt><big>(</big><em>exception</em>, <em>sql</em>, <em>params</em>, <em>require_commit</em><big>)</big><a class="headerlink" href="#Database.sql_error_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>This hook is called when an error is raised executing a query, allowing
your application to inject custom error handling behavior.  The default
implementation simply reraises the exception.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SqliteDatabaseCustom</span><span class="p">(</span><span class="n">SqliteDatabase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_error_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">require_commit</span><span class="p">):</span>
        <span class="c"># Perform some custom behavior, for example close the</span>
        <span class="c"># connection to the database.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c"># Re-raise the exception.</span>
        <span class="k">raise</span> <span class="n">exception</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="SqliteDatabase">
<em class="property">class </em><tt class="descname">SqliteDatabase</tt><big>(</big><em>Database</em><big>)</big><a class="headerlink" href="#SqliteDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#Database" title="Database"><tt class="xref py py-class docutils literal"><span class="pre">Database</span></tt></a> subclass that communicates to the &#8220;sqlite3&#8221; driver</p>
</dd></dl>

<dl class="class">
<dt id="MySQLDatabase">
<em class="property">class </em><tt class="descname">MySQLDatabase</tt><big>(</big><em>Database</em><big>)</big><a class="headerlink" href="#MySQLDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#Database" title="Database"><tt class="xref py py-class docutils literal"><span class="pre">Database</span></tt></a> subclass that communicates to the &#8220;MySQLdb&#8221; driver</p>
</dd></dl>

<dl class="class">
<dt id="PostgresqlDatabase">
<em class="property">class </em><tt class="descname">PostgresqlDatabase</tt><big>(</big><em>Database</em><big>)</big><a class="headerlink" href="#PostgresqlDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#Database" title="Database"><tt class="xref py py-class docutils literal"><span class="pre">Database</span></tt></a> subclass that communicates to the &#8220;psycopg2&#8221; driver</p>
</dd></dl>

</div>
<div class="section" id="misc">
<h2>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fn">
<em class="property">class </em><tt class="descname">fn</tt><a class="headerlink" href="#fn" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper class that will convert arbitrary function calls to SQL function calls.</p>
<p>To express functions in peewee, use the <a class="reference internal" href="#fn" title="fn"><tt class="xref py py-class docutils literal"><span class="pre">fn</span></tt></a> object.  The way it works is
anything to the right of the &#8220;dot&#8221; operator will be treated as a function.  You can
pass that function arbitrary parameters which can be other valid expressions.</p>
<p>For example:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Peewee expression</th>
<th class="head">Equivalent SQL</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">fn.Count(Tweet.id).alias('count')</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Count(t1.&quot;id&quot;)</span> <span class="pre">AS</span> <span class="pre">count</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">fn.Lower(fn.Substr(User.username,</span> <span class="pre">1,</span> <span class="pre">1))</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Lower(Substr(t1.&quot;username&quot;,</span> <span class="pre">1,</span> <span class="pre">1))</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">fn.Rand().alias('random')</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Rand()</span> <span class="pre">AS</span> <span class="pre">random</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">fn.Stddev(Employee.salary).alias('sdv')</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Stddev(t1.&quot;salary&quot;)</span> <span class="pre">AS</span> <span class="pre">sdv</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="Proxy">
<em class="property">class </em><tt class="descname">Proxy</tt><a class="headerlink" href="#Proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Proxy class useful for situations when you wish to defer the initialization of
an object.  For instance, you want to define your models but you do not know
what database engine you will be using until runtime.</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">database_proxy</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">()</span>  <span class="c"># Create a proxy for our db.</span>

<span class="k">class</span> <span class="nc">BaseModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">database_proxy</span>  <span class="c"># Use proxy for our DB.</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="c"># Based on configuration, use a different database.</span>
<span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;DEBUG&#39;</span><span class="p">]:</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;local.db&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;TESTING&#39;</span><span class="p">]:</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;:memory:&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">PostgresqlDatabase</span><span class="p">(</span><span class="s">&#39;mega_production_db&#39;</span><span class="p">)</span>

<span class="c"># Configure our proxy to use the db we specified in config.</span>
<span class="n">database_proxy</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="method">
<dt id="Proxy.initialize">
<tt class="descname">initialize</tt><big>(</big><em>obj</em><big>)</big><a class="headerlink" href="#Proxy.initialize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>obj</strong> &#8211; The object to proxy to.</td>
</tr>
</tbody>
</table>
<p>Once initialized, the attributes and methods on <tt class="docutils literal"><span class="pre">obj</span></tt> can be accessed
directly via the <a class="reference internal" href="#Proxy" title="Proxy"><tt class="xref py py-class docutils literal"><span class="pre">Proxy</span></tt></a> instance.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#expressions">Expressions</a></li>
<li><a class="reference internal" href="#models">Models</a></li>
<li><a class="reference internal" href="#fields">Fields</a></li>
<li><a class="reference internal" href="#query-types">Query Types</a></li>
<li><a class="reference internal" href="#database-and-its-subclasses">Database and its subclasses</a></li>
<li><a class="reference internal" href="#misc">Misc</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="database.html" title="previous chapter">Databases</a></li>
      <li>Next: <a href="playhouse.html" title="next chapter">Playhouse, a collection of addons</a></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/peewee/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright charles leifer.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>