<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva_poll"
  >

<span tal:replace="nothing"> _______ notice of previous version times _______ </span>
<!-- begin override publication date/time block -->
<metal:block
   metal:define-macro="datetime_info"
   tal:define="version model/get_editable"
   tal:condition="python:version is not None">
  <p tal:define="time python:mangle.DateTime(version.question_start_datetime()).toStr();"
     tal:condition="time">
    <span class="subhead"
          i18n:translate="">Publication time of question</span>
    <br />
    <tal:block replace="time" />
  </p>
  <p tal:define="time python:mangle.DateTime(version.question_end_datetime()).toStr();"
     tal:condition="time">
    <span class="subhead"
          i18n:translate="">Expiration time of question</span>
    <br />
    <tal:block replace="time" />
  </p>
  <p tal:define="time python: mangle.DateTime(version.result_start_datetime()).toStr();"
     tal:condition="time">
    <span class="subhead"
          i18n:translate="">Publication time of results</span>
    <br />
    <tal:block replace="time" />
  </p>
  <p tal:define="time python:mangle.DateTime(version.result_end_datetime()).toStr();"
     tal:condition="time">
    <span class="subhead"
          i18n:translate="">Expiration time of results</span>
    <br />
    <tal:block replace="time" />
  </p>
<!-- end override -->
</metal:block>

<span tal:replace="nothing"> _______ messages _______ </span>
<div tal:omit-tag=""
  tal:condition="python:model.get_approval_request_message()"
  metal:define-macro="messages">
<tr class="top-controls">
<td colspan="2">
<h3 i18n:translate="">
messages
</h3>
</td>
</tr>

<tr class="even">
<td class="feedback"
  colspan="2" i18n:translate="">
<span tal:replace="python:model.get_approval_requester()" i18n:name="author_id">author id</span>
sent a message on
<span tal:replace="structure python:mangle.DateTime(model.get_approval_request_datetime()).toStr()" i18n:name="some_date">some date</span>:
<tal:if condition="python:model.get_approval_request_message()" i18n:name="with_comments">
  <tal:block i18n:translate="">with the following comments:</tal:block>
</tal:if>
</td>
</tr>

<tr class="controls"
  tal:condition="python:model.get_approval_request_message()">
<td class="message"
  colspan="2"
  style="padding:0">
<div class="message"
  tal:content="python:model.get_approval_request_message() or 'whatever'">
message text
</div>
</td>
</tr>
</div>


<span tal:replace="nothing"> _______ Author requests approval _______ </span>
<div metal:define-macro="request_approval" tal:omit-tag="">
<form action="." method="POST">
<tr tal:condition="python:model.get_approval_request_message()">
<td class="feedback"
 colspan="2" i18n:translate="">
A previous request for approval has been rejected / withdrawn by
<span tal:replace="python:model.get_approval_requester()" i18n:name="requester" /> on
<span tal:replace="structure python:mangle.DateTime(model.get_approval_request_datetime()).toStr()" i18n:name="some_date">some date</span>.
The last message regarding this issue is:
</td>
<tal:comment condition="nothing"> actually the last message may not have been written
  by the person withdrawing the request; if this person for example made an empty reject,
  this is the message of the requester ...
</tal:comment>
</tr>

<tr class="even"
  tal:define="message python:model.get_approval_request_message()"
  tal:condition="message">
<td class="message"
  colspan="2">
<div class="message"
  tal:content="message">
  message text
</div>
</td>
</tr>

<tr class="top-controls">
<td colspan="2">
  <h3 i18n:translate="">request approval <span tal:condition="python:may_change_content and unapproved and published" i18n:name="for_new_version"><tal:block i18n:translate="">for new version</tal:block></span></h3>
</td>
</tr>

<tr class="even">
<th i18n:translate="">
message to editor
</th>
<th style="width:40%" i18n:translate="">
notes
</th>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_author/message">
<td class="align-right">
  <tal:block replace="structure python: field.render(REQUEST=request)" />
</td>
<td i18n:translate="">
This message will remain visible in the status screen for other authors and editors.
</td>
</tr>

<!-- start overridden bits, replaced publication/expiration datetime forms
      with question/result date ones -->

<tal:block define="
  now modules/DateTime/DateTime;
  previewable model/get_previewable;
">
<tr class="even"
  tal:define="field here/tab_status_form_author/question_start_datetime">
<td class="align-right"
  style="vertical-align:bottom; white-space: nowrap;'">
<label tal:attributes="for field/id"
  i18n:translate=""
  >question display start time</label><span class="warning"
    tal:condition="field/is_required">*</span>
<tal:block replace="structure python: field.render(value=(previewable.question_start_datetime() or now), REQUEST=request)"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
day / month / year &nbsp;(23:59)
</td>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_author/question_end_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >question display end time</label>
<tal:block replace="structure python: field.render(previewable.question_end_datetime())"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
If this content's question should expire, set the time.
</td>
</tr>

<tr class="even"
  tal:define="field here/tab_status_form_author/result_start_datetime">
<td class="align-right"
 style="vertical-align:bottom; white-space: nowrap;'">
<label tal:attributes="for field/id"
  i18n:translate=""
  >results display start time</label><span class="warning"
    tal:condition="field/is_required">*</span>
<tal:block replace="structure python: field.render(value=(previewable.result_start_datetime() or now), REQUEST=request)"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
day / month / year &nbsp;(23:59)
</td>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_author/result_end_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >results display end time</label>
<tal:block replace="structure python: field.render(previewable.result_end_datetime())"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
If this content's results should expire, set the time.
</td>
</tr>
</tal:block>

<!-- end override -->

<tr class="controls">
<td colspan="2" class="align-right">
<input 
  type="submit" 
  value="request approval" 
  name="tab_status_request:method"
  class="button" 
  title="access key: alt-r" 
  accesskey="r" 
  i18n:attributes="value;title" />
</td>
</tr>
</form>
</div>
<span tal:replace="nothing"> _______ / Author requests approval _______ </span>


<span tal:replace="nothing"> _______ Editor can change settings _______ </span>
<div metal:define-macro="approved_editor" tal:omit-tag="">
<form action="tab_status_change_settings" method="POST">
<tr class="top-controls">
<td colspan="2">
<h3 i18n:translate="">
change settings
</h3>
</td>
</tr>

<tr>
<th class="align-right" i18n:translate="">
current timings
</th>
<th i18n:translate="">
notes
</th>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_change_settings/publish_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >publish time:</label>&nbsp;
<tal:block replace="structure python: field.render(model.get_next_version_publication_datetime())"/>
</td>
<td>
&nbsp;
</td>
</tr>

<tr class="even"
  tal:define="field here/tab_status_form_change_settings/expiration_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >expiratio<u>n</u> time</label>&nbsp;
<tal:block replace="structure python: field.render(model.get_next_version_expiration_datetime())"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
If this content should expire, set the time.
</td>
</tr>

<tr>
<th class="align-right" colspan="2"
  tal:define="field here/tab_status_form_change_settings/clear_expiration">
<label tal:attributes="for field/id"
  i18n:translate=""
  >clear expiration
</label>
<tal:block replace="structure python: field.render()"/>
</th>
</tr>

<tr class="inter-controls">
<td class="align-right"
  colspan="2">
<input type="submit" value="update timing" class="button"  title="access key: alt-u" accesskey="u" i18n:attributes="value;title"/>
</td>
</tr>
</form>
</div>
<span tal:replace="nothing"> _______ / Editor can change settings _______ </span>



<span tal:replace="nothing"> ______________ sub tables ______________ </span>


<span tal:replace="nothing"> _______ Editor approves _______ </span>
<div tal:omit-tag=""
  metal:define-macro="approve_new">
<form action="tab_status_approve" method="POST">
<table class="listing">
<tr class="top-controls">
<td colspan="2">
<h3>
<span tal:condition="python:not closed or (unapproved and (closed or published))"
  i18n:translate="">
  poll display dates
</span>
<span tal:condition="python: closed and not unapproved" i18n:translate="">
  poll display dates for closed version
</span>
</h3>
</td>
</tr>

<tr>
<th class="align-right" i18n:translate="">
settings
</th>
<th style="width:40%" i18n:translate="">
notes
</th>
</tr>

<!-- begin overrides editor -->

<tal:block define="now modules/DateTime/DateTime;
                    previewable model/get_previewable;">
<tr class="even"
  tal:define="field here/tab_status_form_editor/question_start_datetime">
<td class="align-right"
 style="vertical-align:bottom; white-space: nowrap;'">
 <label tal:attributes="for field/id"
   i18n:translate=""
   >question display start time</label><span class="warning"
     tal:condition="field/is_required">*</span>
<tal:block replace="structure python: field.render(value=(previewable.question_start_datetime() or now), REQUEST=request)"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
day / month / year &nbsp;(23:59)
</td>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_editor/question_end_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >question display end time</label>
<tal:block replace="structure python: field.render(previewable.question_end_datetime())"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
If this content's question should expire, set the time.
</td>
</tr>

<tr class="even"
  tal:define="field here/tab_status_form_editor/result_start_datetime">
<td class="align-right"
 style="vertical-align:bottom; white-space: nowrap;'">
 <label tal:attributes="for field/id"
   i18n:translate=""
   >results display start time</label><span class="warning"
     tal:condition="field/is_required">*</span>
<tal:block replace="structure python: field.render(value=(previewable.result_start_datetime() or now), REQUEST=request)"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
day / month / year &nbsp;(23:59)
</td>
</tr>

<tr class="odd"
  tal:define="field here/tab_status_form_editor/result_end_datetime">
<td class="align-right" style="white-space: nowrap;">
<label tal:attributes="for field/id"
  i18n:translate=""
  >results display end time</label>
<tal:block replace="structure python: field.render(previewable.result_end_datetime())"/>
</td>
<td style="vertical-align:middle;" i18n:translate="">
If this content's results should expire, set the time.
</td>
</tr>
</tal:block>

<!-- end overrides editor -->

<tr class="inter-controls">
<td class="align-right"
  colspan="2">
<input class="executor"
  type="submit"
  value="publish now"
  title="access key: alt-p"
  accesskey="p"
  i18n:attributes="value;title"
/>
</td> 
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Editor approves _______ </span>


<span tal:replace="nothing"> _______ Author/Editor withdraws/rejects request for approval _______ </span>
<div tal:omit-tag=""
  metal:define-macro="withdraw_request_approval">
<form action="tab_status_withdraw" method="post">
<table class="listing">
<tr class="top-controls">
<td colspan="2">
<h3>
<tal:block condition="may_approve_content" i18n:translate="">reject</tal:block>
<tal:block condition="not: may_approve_content" i18n:translate="">withdraw</tal:block>
<tal:block i18n:translate="">request</tal:block>
</h3>
</td>
</tr>

<tr>
<input type="hidden" name="rejection_status" tal:attributes="value python:test(may_approve_content, 'true', 'false')" />
<input type="hidden" name="tab_name" value="publish" />
<th>
<tal:block i18n:translate="">
add message on
</tal:block>
<tal:block condition="may_approve_content" i18n:translate="">
rejection
</tal:block>
<tal:block condition="not: may_approve_content" i18n:translate="">
withdrawal
</tal:block>
</th>
<th style="width:40%" i18n:translate="">
notes
</th>
</tr>

<tr class="odd">
<td>
<textarea
  class="store"
  name="message"
  cols="65"
  rows="7"
  wrap="soft"></textarea>
</td>
<td width="40%" i18n:translate="">
The message may be viewed by local users.
</td>
</tr>

<tr class="controls">
<td>
&nbsp;
</td>
<td class="align-right"
  width="40%">
<input
  type="submit"
  class="button"
  title="access key: alt-j"
  accesskey="j"
  tal:condition="may_approve_content"
  value="reject approval request"
  i18n:attributes="title;value"
/>
<input
  type="submit"
  class="button"
  title="access key: alt-r"
  accesskey="r"
  tal:condition="not: may_approve_content"
  value="withdraw approval request"
  i18n:attributes="title;value"
/>
</td>
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Author/Editor withdraws/rejects request for  approval _______ </span>


<span tal:replace="nothing"> _______ Revoke approval _______ </span>
<div tal:omit-tag=""
  metal:define-macro="revoke_approval">
<form action="tab_status_revoke" method="POST">
<table class="listing">
<thead>
<tr class="top-controls">
<td>
<h3 i18n:translate="">
revoke approval
</h3>
</td>
</tr>
</thead>

<tbody>
<tr class="even">
<td i18n:translate="">
If further editing is required, first revoke the approval.
</td>
</tr>
</tbody>

<tfoot>
<tr class="controls">
<td class="align-right">
<input
  type="submit"
  value="revoke approval"
  class="button"
  title="access key: alt-v"
  accesskey="v"
  i18n:attributes="value;title" />
</td>
</tr>
</tfoot>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Revoke approval _______ </span>


<span tal:replace="nothing"> _______ Revert to previous _______ </span>
<div tal:omit-tag=""
  metal:define-macro="revert_to_previous">
<form action="tab_status_revert_to_previous" method="post">
<table class="listing">
<tr class="top-controls">
<td>
  <h3 i18n:translate="">
  revert to previous version
</h3>
</td>
</tr>
<tr class="even">
  <td i18n:translate="">
The current editable version can be replaced with the previous (published)
version. This can not be undone afterwards and will discard all changes
made to the current version.
</td>
</tr>
<tr class="inter-controls">
<td class="align-right">
<input class="button"
  type="submit"
  value="revert to previous"
  title="access key: alt-p"
  accesskey="p"
  onclick="return confirm('Really revert ?')"
  i18n:attributes="value;title"
/>
</td>
</tr>
</table>
</form>
</div>
<span tal:replace="nothing"> _______ / Revert to previous _______ </span>


<span tal:replace="nothing"> _______ Manual close _______ </span>
<div tal:omit-tag=""
  metal:define-macro="manual_close">
<form action="tab_status_close" method="post">
<table class="listing">
<thead>
<tr class="top-controls">
<td>
  <h3 i18n:translate="">manual close</h3>
</td>
</tr>
</thead>

<tbody>
<tr class="even">
  <td i18n:translate="">
If necessary, the published version of this content can be manually closed (taken offline). It will also be removed from the public index.
</td>
</tr>
</tbody>

<tfoot>
<tr class="controls">
<td class="align-right">
<input class="button"
  type="submit"
  value="close published version"
  title="access key: alt-c"
  accesskey="c"
  i18n:attributes="value;title"
  />
</td>
</tr>
</tfoot>
</table>
</form>
</div>

</html>
