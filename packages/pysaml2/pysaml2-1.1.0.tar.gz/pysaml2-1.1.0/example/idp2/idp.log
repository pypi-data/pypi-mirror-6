2013-07-12 09:28:12,553 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 09:28:12,559 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 09:28:12,560 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-c6a314c35c5dbc96d4a72c932375bb70" InResponseTo="id-26992892218594fe68ff5988a5e96da6" IssueInstant="2013-07-12T16:28:12Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-62da62624eccf1aba825cdd01aa01190" IssueInstant="2013-07-12T16:28:12Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">055eac03540b31e384c7de9341db5a8c68b3d56fcbc6ea0c35e8b5de2c48c65c</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-26992892218594fe68ff5988a5e96da6" NotOnOrAfter="2013-07-12T16:43:12Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T16:28:12Z" NotOnOrAfter="2013-07-12T16:43:12Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T16:28:12Z" SessionIndex="id-d4c710e884361cd1dc32e0bbb07c833b"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 09:28:12,560 saml2.entity:INFO HTTP POST
2013-07-12 09:28:12,561 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtYzZhMzE0YzM1YzVkYmM5NmQ0YTcyYzkzMjM3NWJiNzAiIEluUmVzcG9uc2VUbz0iaWQtMjY5OTI4OTIyMTg1OTRmZTY4ZmY1OTg4YTVlOTZkYTYiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjoyODoxMloiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtNjJkYTYyNjI0ZWNjZjFhYmE4MjVjZGQwMWFhMDExOTAiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjoyODoxMloiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+MDU1ZWFjMDM1NDBiMzFlMzg0YzdkZTkzNDFkYjVhOGM2OGIzZDU2ZmNiYzZlYTBjMzVlOGI1ZGUyYzQ4YzY1YzwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtMjY5OTI4OTIyMTg1OTRmZTY4ZmY1OTg4YTVlOTZkYTYiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNjo0MzoxMloiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE2OjI4OjEyWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE2OjQzOjEyWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNjoyODoxMloiIFNlc3Npb25JbmRleD0iaWQtZDRjNzEwZTg4NDM2MWNkMWRjMzJlMGJiYjA3YzgzM2IiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="QDFUzCBrEdxgcaAF" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 09:30:10,004 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:30:10,004 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT+MwEL3vr7B86SmNk/QjWE1QlwpRiYWKBg7cXGe6tZTaxTPpLv8eJ9sFIaEeuFgzo/c8b97M7PLvvmFH8GicLQbJUAwYWO1qY38Xg8fqOsoHl+WPmUUh5y3t7AO8tIDEAs2iDOWCt95Kp9CEVO0BJWm5nv+6lelQyIN35LRr+DshOU9QiOApiOFs/j+8chbbPfg1+KPR8PhwW/Ad0UHGceO0anYOSeYin8ZKY3wIGWeLINJY1dG/Bucxoos91MaDDoTlouCmjsRGTy6y8TTT4R3l43qbQZqNJvVos81TGAcgYgtLi6QsFTwVSRaJaZSkVTKRmZDi4pmz1Wnsn8b2Tp4defMPhPKmqlbR6n5d9R8cTQ3+LqAL3kFTRp3v5Dozn04L44HPy7CdRPayPLt2fq/ofMOuEkbd9lAJlgy98vJrR/EwDJubxR8tyv4YOmHLxco1Rr+yedO4P1ceFAWxW9Ug8G8IIa8smiCHs7jsOn4+ufIN'], 'RelayState': ['u8QGeaaXp5cM6b1C']}
2013-07-12 09:30:10,004 saml2.idp:INFO -- No USER --
2013-07-12 09:30:10,004 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:30:10,004 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT%2BMwEL3vr7B86SmNk%2FQjWE1QlwpRiYWKBg7cXGe6tZTaxTPpLv8eJ9sFIaEeuFgzo%2Fc8b97M7PLvvmFH8GicLQbJUAwYWO1qY38Xg8fqOsoHl%2BWPmUUh5y3t7AO8tIDEAs2iDOWCt95Kp9CEVO0BJWm5nv%2B6lelQyIN35LRr%2BDshOU9QiOApiOFs%2Fj%2B8chbbPfg1%2BKPR8PhwW%2FAd0UHGceO0anYOSeYin8ZKY3wIGWeLINJY1dG%2FBucxoos91MaDDoTlouCmjsRGTy6y8TTT4R3l43qbQZqNJvVos81TGAcgYgtLi6QsFTwVSRaJaZSkVTKRmZDi4pmz1Wnsn8b2Tp4defMPhPKmqlbR6n5d9R8cTQ3%2BLqAL3kFTRp3v5Dozn04L44HPy7CdRPayPLt2fq%2FofMOuEkbd9lAJlgy98vJrR%2FEwDJubxR8tyv4YOmHLxco1Rr%2ByedO4P1ceFAWxW9Ug8G8IIa8smiCHs7jsOn4%2BufIN&RelayState=u8QGeaaXp5cM6b1C', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:30:10,004 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:30:10,004 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 09:30:10,004 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 09:30:10,004 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0bc693573c935485df3e2346d4bf82e5" IssueInstant="2013-07-12T16:30:09Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:30:10,005 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0bc693573c935485df3e2346d4bf82e5" IssueInstant="2013-07-12T16:30:09Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:30:10,005 saml2.entity:DEBUG Loaded request
2013-07-12 09:30:10,005 saml2.entity:DEBUG Verified request
2013-07-12 09:30:10,005 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT+MwEL3vr7B86SmNk/QjWE1QlwpRiYWKBg7cXGe6tZTaxTPpLv8eJ9sFIaEeuFgzo/c8b97M7PLvvmFH8GicLQbJUAwYWO1qY38Xg8fqOsoHl+WPmUUh5y3t7AO8tIDEAs2iDOWCt95Kp9CEVO0BJWm5nv+6lelQyIN35LRr+DshOU9QiOApiOFs/j+8chbbPfg1+KPR8PhwW/Ad0UHGceO0anYOSeYin8ZKY3wIGWeLINJY1dG/Bucxoos91MaDDoTlouCmjsRGTy6y8TTT4R3l43qbQZqNJvVos81TGAcgYgtLi6QsFTwVSRaJaZSkVTKRmZDi4pmz1Wnsn8b2Tp4defMPhPKmqlbR6n5d9R8cTQ3+LqAL3kFTRp3v5Dozn04L44HPy7CdRPayPLt2fq/ofMOuEkbd9lAJlgy98vJrR/EwDJubxR8tyv4YOmHLxco1Rr+yedO4P1ceFAWxW9Ug8G8IIa8smiCHs7jsOn4+ufIN', 'RelayState': 'u8QGeaaXp5cM6b1C', 'req_info': <saml2.request.AuthnRequest object at 0x1021aae90>}
2013-07-12 09:30:10,005 saml2.idp:DEBUG Do authentication
2013-07-12 09:30:10,006 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 09:30:10,006 saml2.idp:INFO The login page
2013-07-12 09:30:10,006 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'e995ee18546e5f75b2019bdc8a2b3aded977e686', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 09:30:10,012 saml2.idp:INFO <application> PATH: verify
2013-07-12 09:30:10,012 saml2.idp:DEBUG QUERY: {}
2013-07-12 09:30:10,012 saml2.idp:INFO -- No USER --
2013-07-12 09:30:10,012 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 09:30:10,012 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['e995ee18546e5f75b2019bdc8a2b3aded977e686'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 09:30:10,013 saml2.idp:DEBUG Register roland under 'v1pwb46l9ptYEbssKErgLBt5'
2013-07-12 09:30:10,013 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 16:35:10 GMT
2013-07-12 09:30:10,013 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=v1pwb46l9ptYEbssKErgLBt5&key=e995ee18546e5f75b2019bdc8a2b3aded977e686
2013-07-12 09:30:10,019 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:30:10,019 saml2.idp:INFO = KAKA =
2013-07-12 09:30:10,019 saml2.idp:DEBUG KAKA: idpauthn=djFwd2I0Nmw5cHRZRWJzc0tFcmdMQnQ1OjE=
2013-07-12 09:30:10,019 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:30:10,019 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=djFwd2I0Nmw5cHRZRWJzc0tFcmdMQnQ1OjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=v1pwb46l9ptYEbssKErgLBt5&key=e995ee18546e5f75b2019bdc8a2b3aded977e686', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:30:10,020 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:30:10,020 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVJNT+MwEL3vr7B86SmNk/QjWE1QlwpRiYWKBg7cXGe6tZTaxTPpLv8eJ9sFIaEeuFgzo/c8b97M7PLvvmFH8GicLQbJUAwYWO1qY38Xg8fqOsoHl+WPmUUh5y3t7AO8tIDEAs2iDOWCt95Kp9CEVO0BJWm5nv+6lelQyIN35LRr+DshOU9QiOApiOFs/j+8chbbPfg1+KPR8PhwW/Ad0UHGceO0anYOSeYin8ZKY3wIGWeLINJY1dG/Bucxoos91MaDDoTlouCmjsRGTy6y8TTT4R3l43qbQZqNJvVos81TGAcgYgtLi6QsFTwVSRaJaZSkVTKRmZDi4pmz1Wnsn8b2Tp4defMPhPKmqlbR6n5d9R8cTQ3+LqAL3kFTRp3v5Dozn04L44HPy7CdRPayPLt2fq/ofMOuEkbd9lAJlgy98vJrR/EwDJubxR8tyv4YOmHLxco1Rr+yedO4P1ceFAWxW9Ug8G8IIa8smiCHs7jsOn4+ufIN', 'RelayState': 'u8QGeaaXp5cM6b1C', 'req_info': <saml2.request.AuthnRequest object at 0x1021aae90>}
2013-07-12 09:30:10,020 saml2.idp:INFO parsed OK
2013-07-12 09:30:10,020 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0bc693573c935485df3e2346d4bf82e5" IssueInstant="2013-07-12T16:30:09Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:30:10,020 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:30:10,020 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:30:10,020 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 09:30:10,020 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:30:10,020 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:30:10,020 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 09:30:10,021 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 09:30:10,021 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 09:30:10,022 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-4038dbe8c967f30055326c67b0152ac7" InResponseTo="id-0bc693573c935485df3e2346d4bf82e5" IssueInstant="2013-07-12T16:30:10Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-78142c17c5101cb01fcf3aa10e1e98b3" IssueInstant="2013-07-12T16:30:10Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">ef7f51000a15b58361c231a2c808adef5a463d80dd5b8810af5f9e73153064d4</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-0bc693573c935485df3e2346d4bf82e5" NotOnOrAfter="2013-07-12T16:45:10Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T16:30:10Z" NotOnOrAfter="2013-07-12T16:45:10Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T16:30:10Z" SessionIndex="id-667729a3d897e259b0cc08e76c6302f2"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 09:30:10,023 saml2.entity:INFO HTTP POST
2013-07-12 09:30:10,023 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtNDAzOGRiZThjOTY3ZjMwMDU1MzI2YzY3YjAxNTJhYzciIEluUmVzcG9uc2VUbz0iaWQtMGJjNjkzNTczYzkzNTQ4NWRmM2UyMzQ2ZDRiZjgyZTUiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozMDoxMFoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtNzgxNDJjMTdjNTEwMWNiMDFmY2YzYWExMGUxZTk4YjMiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozMDoxMFoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+ZWY3ZjUxMDAwYTE1YjU4MzYxYzIzMWEyYzgwOGFkZWY1YTQ2M2Q4MGRkNWI4ODEwYWY1ZjllNzMxNTMwNjRkNDwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtMGJjNjkzNTczYzkzNTQ4NWRmM2UyMzQ2ZDRiZjgyZTUiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNjo0NToxMFoiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE2OjMwOjEwWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE2OjQ1OjEwWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozMDoxMFoiIFNlc3Npb25JbmRleD0iaWQtNjY3NzI5YTNkODk3ZTI1OWIwY2MwOGU3NmM2MzAyZjIiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="u8QGeaaXp5cM6b1C" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 09:34:40,765 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:34:40,765 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['lVJBbsIwELz3FZYvnELiBEKwSBAFoSLRFkHooTcTTLEUbOrd0Pb3dVLaqhJC6s27mvHOzO5g+H4oyUlaUEanLdYOWkTqwmyVfklb63zqJa1hdjPQEPBRhXu9lK+VBCSOpoG7dkorq7kRoFwpDhI4Fnw1up/zsB3wozVoClPSHwK7ThAA0qITQ8no+zk2GqqDtCtpT6qQ6+U8pXvEI/f90hSi3BtAngRJzxcF+EdXUTJxIpUWNf0yOPEBjG/lVllZOMJsklK19eJ409+xfshEKBjbsLjDunE/ijdR3O12IumAAJWcaUChMaVhwCIv6HkszFnMow7vBM+ULM62b5VukrxqefMFAn6X5wtv8bjKmw9Oaivtg0OntIaGBOvc0dRhPp0XRh2fZm47jDeyLJkaexB4fWDdcVZ3DZRLjQo/aHY5UTi23eYG/u+IrDmGWthssjClKj7IqCzN29hKgU7sTpTgYvq/ELRCg3JyKPGzeuLfk8s+AQ=='], 'RelayState': ['aK5bSMV9JntCB2Cd']}
2013-07-12 09:34:40,766 saml2.idp:INFO -- No USER --
2013-07-12 09:34:40,766 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:34:40,766 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=lVJBbsIwELz3FZYvnELiBEKwSBAFoSLRFkHooTcTTLEUbOrd0Pb3dVLaqhJC6s27mvHOzO5g%2BH4oyUlaUEanLdYOWkTqwmyVfklb63zqJa1hdjPQEPBRhXu9lK%2BVBCSOpoG7dkorq7kRoFwpDhI4Fnw1up%2FzsB3wozVoClPSHwK7ThAA0qITQ8no%2Bzk2GqqDtCtpT6qQ6%2BU8pXvEI%2Ff90hSi3BtAngRJzxcF%2BEdXUTJxIpUWNf0yOPEBjG%2FlVllZOMJsklK19eJ409%2BxfshEKBjbsLjDunE%2FijdR3O12IumAAJWcaUChMaVhwCIv6HkszFnMow7vBM%2BULM62b5VukrxqefMFAn6X5wtv8bjKmw9Oaivtg0OntIaGBOvc0dRhPp0XRh2fZm47jDeyLJkaexB4fWDdcVZ3DZRLjQo%2FaHY5UTi23eYG%2Fu%2BIrDmGWthssjClKj7IqCzN29hKgU7sTpTgYvq%2FELRCg3JyKPGzeuLfk8s%2BAQ%3D%3D&RelayState=aK5bSMV9JntCB2Cd', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:34:40,766 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:34:40,766 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 09:34:40,766 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 09:34:40,766 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-66b9f1921a2a11b164156936b365543e" IssueInstant="2013-07-12T16:34:40Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:34:40,767 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-66b9f1921a2a11b164156936b365543e" IssueInstant="2013-07-12T16:34:40Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:34:40,767 saml2.entity:DEBUG Loaded request
2013-07-12 09:34:40,767 saml2.entity:DEBUG Verified request
2013-07-12 09:34:40,767 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'lVJBbsIwELz3FZYvnELiBEKwSBAFoSLRFkHooTcTTLEUbOrd0Pb3dVLaqhJC6s27mvHOzO5g+H4oyUlaUEanLdYOWkTqwmyVfklb63zqJa1hdjPQEPBRhXu9lK+VBCSOpoG7dkorq7kRoFwpDhI4Fnw1up/zsB3wozVoClPSHwK7ThAA0qITQ8no+zk2GqqDtCtpT6qQ6+U8pXvEI/f90hSi3BtAngRJzxcF+EdXUTJxIpUWNf0yOPEBjG/lVllZOMJsklK19eJ409+xfshEKBjbsLjDunE/ijdR3O12IumAAJWcaUChMaVhwCIv6HkszFnMow7vBM+ULM62b5VukrxqefMFAn6X5wtv8bjKmw9Oaivtg0OntIaGBOvc0dRhPp0XRh2fZm47jDeyLJkaexB4fWDdcVZ3DZRLjQo/aHY5UTi23eYG/u+IrDmGWthssjClKj7IqCzN29hKgU7sTpTgYvq/ELRCg3JyKPGzeuLfk8s+AQ==', 'RelayState': 'aK5bSMV9JntCB2Cd', 'req_info': <saml2.request.AuthnRequest object at 0x1021aa5d0>}
2013-07-12 09:34:40,767 saml2.idp:DEBUG Do authentication
2013-07-12 09:34:40,767 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 09:34:40,767 saml2.idp:INFO The login page
2013-07-12 09:34:40,767 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'ca00e4227ce2c1f194a832ae1c849dfda58a528f', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 09:34:40,774 saml2.idp:INFO <application> PATH: verify
2013-07-12 09:34:40,774 saml2.idp:DEBUG QUERY: {}
2013-07-12 09:34:40,774 saml2.idp:INFO -- No USER --
2013-07-12 09:34:40,774 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 09:34:40,774 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['ca00e4227ce2c1f194a832ae1c849dfda58a528f'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 09:34:40,774 saml2.idp:DEBUG Register roland under '0nrMaxz512nKrTKHngZCE4ct'
2013-07-12 09:34:40,774 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 16:39:40 GMT
2013-07-12 09:34:40,774 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=0nrMaxz512nKrTKHngZCE4ct&key=ca00e4227ce2c1f194a832ae1c849dfda58a528f
2013-07-12 09:34:40,781 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:34:40,781 saml2.idp:INFO = KAKA =
2013-07-12 09:34:40,781 saml2.idp:DEBUG KAKA: idpauthn=MG5yTWF4ejUxMm5LclRLSG5nWkNFNGN0OjE=
2013-07-12 09:34:40,781 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:34:40,781 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=MG5yTWF4ejUxMm5LclRLSG5nWkNFNGN0OjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=0nrMaxz512nKrTKHngZCE4ct&key=ca00e4227ce2c1f194a832ae1c849dfda58a528f', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:34:40,781 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:34:40,781 saml2.idp:DEBUG _operation: {'SAMLRequest': 'lVJBbsIwELz3FZYvnELiBEKwSBAFoSLRFkHooTcTTLEUbOrd0Pb3dVLaqhJC6s27mvHOzO5g+H4oyUlaUEanLdYOWkTqwmyVfklb63zqJa1hdjPQEPBRhXu9lK+VBCSOpoG7dkorq7kRoFwpDhI4Fnw1up/zsB3wozVoClPSHwK7ThAA0qITQ8no+zk2GqqDtCtpT6qQ6+U8pXvEI/f90hSi3BtAngRJzxcF+EdXUTJxIpUWNf0yOPEBjG/lVllZOMJsklK19eJ409+xfshEKBjbsLjDunE/ijdR3O12IumAAJWcaUChMaVhwCIv6HkszFnMow7vBM+ULM62b5VukrxqefMFAn6X5wtv8bjKmw9Oaivtg0OntIaGBOvc0dRhPp0XRh2fZm47jDeyLJkaexB4fWDdcVZ3DZRLjQo/aHY5UTi23eYG/u+IrDmGWthssjClKj7IqCzN29hKgU7sTpTgYvq/ELRCg3JyKPGzeuLfk8s+AQ==', 'RelayState': 'aK5bSMV9JntCB2Cd', 'req_info': <saml2.request.AuthnRequest object at 0x1021aa5d0>}
2013-07-12 09:34:40,781 saml2.idp:INFO parsed OK
2013-07-12 09:34:40,782 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-66b9f1921a2a11b164156936b365543e" IssueInstant="2013-07-12T16:34:40Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:34:40,782 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:34:40,782 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:34:40,782 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 09:34:40,782 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:34:40,782 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:34:40,782 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 09:34:40,783 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 09:34:40,783 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 09:34:40,784 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-9caacd03cc1a349d918ea4209592571b" InResponseTo="id-66b9f1921a2a11b164156936b365543e" IssueInstant="2013-07-12T16:34:40Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-8e65fa509740a1cc23e6130b56c0c7ff" IssueInstant="2013-07-12T16:34:40Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">76cdfe7cd68d50f4231e0bb321a3a6dcb152b1f2adefd2b715692bc29f5d9319</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-66b9f1921a2a11b164156936b365543e" NotOnOrAfter="2013-07-12T16:49:40Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T16:34:40Z" NotOnOrAfter="2013-07-12T16:49:40Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T16:34:40Z" SessionIndex="id-376de6c7cf64f3eea4f5f0ae34057b46"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 09:34:40,785 saml2.entity:INFO HTTP POST
2013-07-12 09:34:40,785 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtOWNhYWNkMDNjYzFhMzQ5ZDkxOGVhNDIwOTU5MjU3MWIiIEluUmVzcG9uc2VUbz0iaWQtNjZiOWYxOTIxYTJhMTFiMTY0MTU2OTM2YjM2NTU0M2UiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNDo0MFoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtOGU2NWZhNTA5NzQwYTFjYzIzZTYxMzBiNTZjMGM3ZmYiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNDo0MFoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+NzZjZGZlN2NkNjhkNTBmNDIzMWUwYmIzMjFhM2E2ZGNiMTUyYjFmMmFkZWZkMmI3MTU2OTJiYzI5ZjVkOTMxOTwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtNjZiOWYxOTIxYTJhMTFiMTY0MTU2OTM2YjM2NTU0M2UiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNjo0OTo0MFoiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE2OjM0OjQwWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE2OjQ5OjQwWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNDo0MFoiIFNlc3Npb25JbmRleD0iaWQtMzc2ZGU2YzdjZjY0ZjNlZWE0ZjVmMGFlMzQwNTdiNDYiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="aK5bSMV9JntCB2Cd" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 09:36:01,198 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:36:01,198 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT+MwEL3zKyxfekrz0aqkVhPUpUJbiY+KBg7cBmeytZTaXc+ku/x7nCwLQkI9cPOM3vO892YWF3/3rTiiJ+NsMUrHyUig1a429lcxeqiuonx0UZ4tLCVq2fHO3uPvDolFoFlSoV3IzlvlgEwoYY+kWKvt8uZaZeNEHbxjp10r3wnpaQIQoecgRorl/+els9Tt0W/RH43Gh/vrQu6YDyqOW6eh3TlilSf5eQya4kOopFgFkcZCT/8anMdELvZYG486ENarQpo6gvlUN5BndQZQz6czQJjNp9Dk08lzDnkTgEQdri0xWC5klqSTKDmP0qxKZ2oyU0n6JMXmzfYPY4ckT1p+/gci9bOqNtHmblsNHxxNjf42oAvZQzPBfe7s+jAf3xYmA1+WYTupGmR5ceX8Hvj0wL4TrDYDVKFlwy+y/DpROozD5hbxx4hyOIZe2Hq1ca3RL2LZtu7PpUfgILaBllB+Qwh7sGSCHCnisp/4+eTKVw=='], 'RelayState': ['DN1TIf8NFKNiURoz']}
2013-07-12 09:36:01,198 saml2.idp:INFO -- No USER --
2013-07-12 09:36:01,198 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:36:01,198 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT%2BMwEL3zKyxfekrz0aqkVhPUpUJbiY%2BKBg7cBmeytZTaXc%2Bku%2Fx7nCwLQkI9cPOM3vO892YWF3%2F3rTiiJ%2BNsMUrHyUig1a429lcxeqiuonx0UZ4tLCVq2fHO3uPvDolFoFlSoV3IzlvlgEwoYY%2BkWKvt8uZaZeNEHbxjp10r3wnpaQIQoecgRorl%2F%2Bels9Tt0W%2FRH43Gh%2FvrQu6YDyqOW6eh3TlilSf5eQya4kOopFgFkcZCT%2F8anMdELvZYG486ENarQpo6gvlUN5BndQZQz6czQJjNp9Dk08lzDnkTgEQdri0xWC5klqSTKDmP0qxKZ2oyU0n6JMXmzfYPY4ckT1p%2B%2Fgci9bOqNtHmblsNHxxNjf42oAvZQzPBfe7s%2BjAf3xYmA1%2BWYTupGmR5ceX8Hvj0wL4TrDYDVKFlwy%2By%2FDpROozD5hbxx4hyOIZe2Hq1ca3RL2LZtu7PpUfgILaBllB%2BQwh7sGSCHCnisp%2F4%2BeTKVw%3D%3D&RelayState=DN1TIf8NFKNiURoz', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:36:01,199 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:36:01,199 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 09:36:01,199 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 09:36:01,199 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-a94cfa82d2aad946aea694af843b8a8f" IssueInstant="2013-07-12T16:36:01Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:36:01,200 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-a94cfa82d2aad946aea694af843b8a8f" IssueInstant="2013-07-12T16:36:01Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:36:01,200 saml2.entity:DEBUG Loaded request
2013-07-12 09:36:01,200 saml2.entity:DEBUG Verified request
2013-07-12 09:36:01,200 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT+MwEL3zKyxfekrz0aqkVhPUpUJbiY+KBg7cBmeytZTaXc+ku/x7nCwLQkI9cPOM3vO892YWF3/3rTiiJ+NsMUrHyUig1a429lcxeqiuonx0UZ4tLCVq2fHO3uPvDolFoFlSoV3IzlvlgEwoYY+kWKvt8uZaZeNEHbxjp10r3wnpaQIQoecgRorl/+els9Tt0W/RH43Gh/vrQu6YDyqOW6eh3TlilSf5eQya4kOopFgFkcZCT/8anMdELvZYG486ENarQpo6gvlUN5BndQZQz6czQJjNp9Dk08lzDnkTgEQdri0xWC5klqSTKDmP0qxKZ2oyU0n6JMXmzfYPY4ckT1p+/gci9bOqNtHmblsNHxxNjf42oAvZQzPBfe7s+jAf3xYmA1+WYTupGmR5ceX8Hvj0wL4TrDYDVKFlwy+y/DpROozD5hbxx4hyOIZe2Hq1ca3RL2LZtu7PpUfgILaBllB+Qwh7sGSCHCnisp/4+eTKVw==', 'RelayState': 'DN1TIf8NFKNiURoz', 'req_info': <saml2.request.AuthnRequest object at 0x10218fd10>}
2013-07-12 09:36:01,200 saml2.idp:DEBUG Do authentication
2013-07-12 09:36:01,200 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 09:36:01,200 saml2.idp:INFO The login page
2013-07-12 09:36:01,200 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '12e54d5ac5b38d7856bfc218eb7a5a3c40b9b035', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 09:36:01,212 saml2.idp:INFO <application> PATH: verify
2013-07-12 09:36:01,212 saml2.idp:DEBUG QUERY: {}
2013-07-12 09:36:01,212 saml2.idp:INFO -- No USER --
2013-07-12 09:36:01,213 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 09:36:01,213 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['12e54d5ac5b38d7856bfc218eb7a5a3c40b9b035'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 09:36:01,213 saml2.idp:DEBUG Register roland under 'ZQ1xF4xZHu1t40omxlSy2WkE'
2013-07-12 09:36:01,213 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 16:41:01 GMT
2013-07-12 09:36:01,213 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=ZQ1xF4xZHu1t40omxlSy2WkE&key=12e54d5ac5b38d7856bfc218eb7a5a3c40b9b035
2013-07-12 09:36:01,219 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:36:01,219 saml2.idp:INFO = KAKA =
2013-07-12 09:36:01,220 saml2.idp:DEBUG KAKA: idpauthn=WlExeEY0eFpIdTF0NDBvbXhsU3kyV2tFOjE=
2013-07-12 09:36:01,220 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:36:01,220 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=WlExeEY0eFpIdTF0NDBvbXhsU3kyV2tFOjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=ZQ1xF4xZHu1t40omxlSy2WkE&key=12e54d5ac5b38d7856bfc218eb7a5a3c40b9b035', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:36:01,220 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:36:01,220 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVJNT+MwEL3zKyxfekrz0aqkVhPUpUJbiY+KBg7cBmeytZTaXc+ku/x7nCwLQkI9cPOM3vO892YWF3/3rTiiJ+NsMUrHyUig1a429lcxeqiuonx0UZ4tLCVq2fHO3uPvDolFoFlSoV3IzlvlgEwoYY+kWKvt8uZaZeNEHbxjp10r3wnpaQIQoecgRorl/+els9Tt0W/RH43Gh/vrQu6YDyqOW6eh3TlilSf5eQya4kOopFgFkcZCT/8anMdELvZYG486ENarQpo6gvlUN5BndQZQz6czQJjNp9Dk08lzDnkTgEQdri0xWC5klqSTKDmP0qxKZ2oyU0n6JMXmzfYPY4ckT1p+/gci9bOqNtHmblsNHxxNjf42oAvZQzPBfe7s+jAf3xYmA1+WYTupGmR5ceX8Hvj0wL4TrDYDVKFlwy+y/DpROozD5hbxx4hyOIZe2Hq1ca3RL2LZtu7PpUfgILaBllB+Qwh7sGSCHCnisp/4+eTKVw==', 'RelayState': 'DN1TIf8NFKNiURoz', 'req_info': <saml2.request.AuthnRequest object at 0x10218fd10>}
2013-07-12 09:36:01,220 saml2.idp:INFO parsed OK
2013-07-12 09:36:01,220 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-a94cfa82d2aad946aea694af843b8a8f" IssueInstant="2013-07-12T16:36:01Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:36:01,220 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:36:01,220 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:36:01,220 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 09:36:01,221 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 09:36:01,221 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 09:36:01,221 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 09:36:01,221 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 09:36:01,221 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 09:36:01,247 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-a8827219ad9cd6506ec18eb18c6442b5" InResponseTo="id-a94cfa82d2aad946aea694af843b8a8f" IssueInstant="2013-07-12T16:36:01Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-7ea1722bc5410aafa276ac2c7824c31e" IssueInstant="2013-07-12T16:36:01Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">ecaba63407183f5cae51b8fc867c21faec46dc65703e18be62598c1e170a3db1</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-a94cfa82d2aad946aea694af843b8a8f" NotOnOrAfter="2013-07-12T16:51:01Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T16:36:01Z" NotOnOrAfter="2013-07-12T16:51:01Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T16:36:01Z" SessionIndex="id-0e40c7c2387e8e98fd87168ca72debda"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 09:36:01,247 saml2.entity:INFO HTTP POST
2013-07-12 09:36:01,248 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtYTg4MjcyMTlhZDljZDY1MDZlYzE4ZWIxOGM2NDQyYjUiIEluUmVzcG9uc2VUbz0iaWQtYTk0Y2ZhODJkMmFhZDk0NmFlYTY5NGFmODQzYjhhOGYiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNjowMVoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtN2VhMTcyMmJjNTQxMGFhZmEyNzZhYzJjNzgyNGMzMWUiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNjowMVoiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+ZWNhYmE2MzQwNzE4M2Y1Y2FlNTFiOGZjODY3YzIxZmFlYzQ2ZGM2NTcwM2UxOGJlNjI1OThjMWUxNzBhM2RiMTwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtYTk0Y2ZhODJkMmFhZDk0NmFlYTY5NGFmODQzYjhhOGYiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNjo1MTowMVoiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE2OjM2OjAxWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE2OjUxOjAxWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNjozNjowMVoiIFNlc3Npb25JbmRleD0iaWQtMGU0MGM3YzIzODdlOGU5OGZkODcxNjhjYTcyZGViZGEiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="DN1TIf8NFKNiURoz" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 09:47:05,014 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 09:47:05,014 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['lVLBbuIwEL3vV1i+cApxApTUIkG0qCpSdxeVdA97c5yhWAo29UzY7d/XSWmrShVSb57Re5733sxs/n/fsCN4NM7mg2QoBgysdrWxj/ngobyJssG8+DGzKOSipZ29h6cWkFigWZShnfPWW+kUmlCqPaAkLTeLn3cyHQp58I6cdg1/JyTnCQoRPAUxnC3entfOYrsHvwF/NBoe7u9yviM6yDhunFbNziHJTGTTWGmMD6HibBlEGqs6+tfgLEZ0sYfaeNCBsFrm3NTRROjpZSaqalTVo+2lBjG+yCqt0yqFyURBACK2sLJIylLOU5GMIjGNkrRMLuR4KsXkL2frk+0rY/skz1quXkEob8tyHa1/b8r+g6Opwf8K6Jx30JRRlzu5Lsw/p4XxwOdF2E4ie1me3Ti/V3R+YNcJVrc9VIIlQ8+8+DpRPAzD5mbxx4iiP4ZO2Gq5do3Rz2zRNO7ftQdFQexWNRhi+r4Q8sqiCXI4i4tu4ueTK14A'], 'RelayState': ['MMwdqGEyArsDHRwz']}
2013-07-12 09:47:05,015 saml2.idp:INFO -- No USER --
2013-07-12 09:47:05,015 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 09:47:05,015 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=lVLBbuIwEL3vV1i%2BcApxApTUIkG0qCpSdxeVdA97c5yhWAo29UzY7d%2FXSWmrShVSb57Re5733sxs%2Fn%2FfsCN4NM7mg2QoBgysdrWxj%2FngobyJssG8%2BDGzKOSipZ29h6cWkFigWZShnfPWW%2BkUmlCqPaAkLTeLn3cyHQp58I6cdg1%2FJyTnCQoRPAUxnC3entfOYrsHvwF%2FNBoe7u9yviM6yDhunFbNziHJTGTTWGmMD6HibBlEGqs6%2BtfgLEZ0sYfaeNCBsFrm3NTRROjpZSaqalTVo%2B2lBjG%2ByCqt0yqFyURBACK2sLJIylLOU5GMIjGNkrRMLuR4KsXkL2frk%2B0rY%2Fskz1quXkEob8tyHa1%2Fb8r%2Bg6Opwf8K6Jx30JRRlzu5Lsw%2Fp4XxwOdF2E4ie1me3Ti%2FV3R%2BYNcJVrc9VIIlQ8%2B8%2BDpRPAzD5mbxx4iiP4ZO2Gq5do3Rz2zRNO7ftQdFQexWNRhi%2Br4Q8sqiCXI4i4tu4ueTK14A&RelayState=MMwdqGEyArsDHRwz', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 09:47:05,015 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 09:47:05,015 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 09:47:05,015 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 09:47:05,015 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-50c7980bb3bd3f9ce0468bcc2b2e55ae" IssueInstant="2013-07-12T16:47:05Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:47:05,016 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-50c7980bb3bd3f9ce0468bcc2b2e55ae" IssueInstant="2013-07-12T16:47:05Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 09:47:05,016 saml2.entity:DEBUG Loaded request
2013-07-12 09:47:05,016 saml2.entity:DEBUG Verified request
2013-07-12 09:47:05,016 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'lVLBbuIwEL3vV1i+cApxApTUIkG0qCpSdxeVdA97c5yhWAo29UzY7d/XSWmrShVSb57Re5733sxs/n/fsCN4NM7mg2QoBgysdrWxj/ngobyJssG8+DGzKOSipZ29h6cWkFigWZShnfPWW+kUmlCqPaAkLTeLn3cyHQp58I6cdg1/JyTnCQoRPAUxnC3entfOYrsHvwF/NBoe7u9yviM6yDhunFbNziHJTGTTWGmMD6HibBlEGqs6+tfgLEZ0sYfaeNCBsFrm3NTRROjpZSaqalTVo+2lBjG+yCqt0yqFyURBACK2sLJIylLOU5GMIjGNkrRMLuR4KsXkL2frk+0rY/skz1quXkEob8tyHa1/b8r+g6Opwf8K6Jx30JRRlzu5Lsw/p4XxwOdF2E4ie1me3Ti/V3R+YNcJVrc9VIIlQ8+8+DpRPAzD5mbxx4iiP4ZO2Gq5do3Rz2zRNO7ftQdFQexWNRhi+r4Q8sqiCXI4i4tu4ueTK14A', 'RelayState': 'MMwdqGEyArsDHRwz', 'req_info': <saml2.request.AuthnRequest object at 0x1021b0610>}
2013-07-12 09:47:05,016 saml2.idp:DEBUG Do authentication
2013-07-12 09:47:05,016 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 09:47:05,016 saml2.idp:INFO The login page
2013-07-12 09:47:05,016 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'a5b9e2a47e081d2a4aca706123193f4f065436af', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:09:19,501 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:09:19,501 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT8MwDL3zK6JcdurarEC7aC0aTIhJfEyscOAWUo9F6pIRuwP+PWn5EhLaAeViW+/Fz8+enLxuGrYDj8bZYiCGyYCB1a429qkY3FXnUT44KQ8mFhM5bWltb+G5BSQWaBZlKBe89VY6hSakagMoScvl9OpSjoaJ3HpHTruGfxPEfoJCBE9BDGfTr/DMWWw34Jfgd0bD3e1lwddEWxnHjdOqWTskmSd5FiuN8TZknM2CSGNVR/8bnMeILvZQGw86EOazgps6yo7C04+QQDpWYpxmx4cC8rRO69XxUZblAYjYwtwiKUsFHyUijZIsEqNKZDIZSzF+4GzxOfapsb2Te0d+/AChvKiqRbS4WVb9BztTg78O6IJ30BGjzndynZn3nwvjgc/LsB0he1menTu/UbS/YVcJo656qARLht54+bejuB2GzU3inxZlfwydsPls4Rqj39i0adzLmQdFQexKNQj8H0LIK4smyOEsLruOv0+ufAc='], 'RelayState': ['i9LDV2setslqDwTV']}
2013-07-12 10:09:19,501 saml2.idp:INFO -- No USER --
2013-07-12 10:09:19,502 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:09:19,502 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT8MwDL3zK6JcdurarEC7aC0aTIhJfEyscOAWUo9F6pIRuwP%2BPWn5EhLaAeViW%2B%2FFz8%2BenLxuGrYDj8bZYiCGyYCB1a429qkY3FXnUT44KQ8mFhM5bWltb%2BG5BSQWaBZlKBe89VY6hSakagMoScvl9OpSjoaJ3HpHTruGfxPEfoJCBE9BDGfTr%2FDMWWw34Jfgd0bD3e1lwddEWxnHjdOqWTskmSd5FiuN8TZknM2CSGNVR%2F8bnMeILvZQGw86EOazgps6yo7C04%2BQQDpWYpxmx4cC8rRO69XxUZblAYjYwtwiKUsFHyUijZIsEqNKZDIZSzF%2B4GzxOfapsb2Te0d%2B%2FAChvKiqRbS4WVb9BztTg78O6IJ30BGjzndynZn3nwvjgc%2FLsB0he1menTu%2FUbS%2FYVcJo656qARLht54%2BbejuB2GzU3inxZlfwydsPls4Rqj39i0adzLmQdFQexKNQj8H0LIK4smyOEsLruOv0%2BufAc%3D&RelayState=i9LDV2setslqDwTV', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:09:19,502 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:09:19,502 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:09:19,502 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:09:19,502 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-75757cbe0e39a1937641e83d3df65778" IssueInstant="2013-07-12T17:09:19Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:09:19,502 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-75757cbe0e39a1937641e83d3df65778" IssueInstant="2013-07-12T17:09:19Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:09:19,503 saml2.entity:DEBUG Loaded request
2013-07-12 10:09:19,503 saml2.entity:DEBUG Verified request
2013-07-12 10:09:19,503 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT8MwDL3zK6JcdurarEC7aC0aTIhJfEyscOAWUo9F6pIRuwP+PWn5EhLaAeViW+/Fz8+enLxuGrYDj8bZYiCGyYCB1a429qkY3FXnUT44KQ8mFhM5bWltb+G5BSQWaBZlKBe89VY6hSakagMoScvl9OpSjoaJ3HpHTruGfxPEfoJCBE9BDGfTr/DMWWw34Jfgd0bD3e1lwddEWxnHjdOqWTskmSd5FiuN8TZknM2CSGNVR/8bnMeILvZQGw86EOazgps6yo7C04+QQDpWYpxmx4cC8rRO69XxUZblAYjYwtwiKUsFHyUijZIsEqNKZDIZSzF+4GzxOfapsb2Te0d+/AChvKiqRbS4WVb9BztTg78O6IJ30BGjzndynZn3nwvjgc/LsB0he1menTu/UbS/YVcJo656qARLht54+bejuB2GzU3inxZlfwydsPls4Rqj39i0adzLmQdFQexKNQj8H0LIK4smyOEsLruOv0+ufAc=', 'RelayState': 'i9LDV2setslqDwTV', 'req_info': <saml2.request.AuthnRequest object at 0x1021b0890>}
2013-07-12 10:09:19,503 saml2.idp:DEBUG Do authentication
2013-07-12 10:09:19,503 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:09:19,503 saml2.idp:INFO The login page
2013-07-12 10:09:19,503 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '755bb725194baf15aab708f4ba961774eeb3aa75', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:10:05,243 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:10:05,244 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT+MwEL3vr7B86SlNnIgmWE1QoUJbid2taODAzXWm1FJqZz2TAv9+nSwfQkI9cPOM3vO892bmF8+Hlh3Bo3G2nIhpMmFgtWuMfSwnd/V1VEwuqh9zi4lc9LS3t/C3ByQWaBZlaJe891Y6hSaU6gAoScvN4teNTKeJ7Lwjp13L3wniNEEhgqcghrPF2/PKWewP4Dfgj0bD3e1NyfdEnYzj1mnV7h2SLJIij5XGuAsVZ8sg0lg10L8GFzGiiz00xoMOhNWy5KaJzjVkRdo0MxB5tj2fpbtZsVUqK8Ru1+TbLAARe1hZJGWp5GkisijJI5HWIpcikcnZA2frV9uXxo5JnrS8/Q9C+bOu19H6z6YePziaBvzvgC75AE0ZDbmTG8K8f10YD3xehe0IOcry7Nr5g6LTA4dOsLoboRIsGXrh1deJYjcNm5vHHyOq8RgGYavl2rVGv7BF27qnKw+KgljyPfBv6OgGT0hBDmdxNUz8fHLVPw=='], 'RelayState': ['JAfzsR918qUtCuyj']}
2013-07-12 10:10:05,244 saml2.idp:INFO -- No USER --
2013-07-12 10:10:05,244 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:10:05,244 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT%2BMwEL3vr7B86SlNnIgmWE1QoUJbid2taODAzXWm1FJqZz2TAv9%2BnSwfQkI9cPOM3vO892bmF8%2BHlh3Bo3G2nIhpMmFgtWuMfSwnd%2FV1VEwuqh9zi4lc9LS3t%2FC3ByQWaBZlaJe891Y6hSaU6gAoScvN4teNTKeJ7Lwjp13L3wniNEEhgqcghrPF2%2FPKWewP4Dfgj0bD3e1NyfdEnYzj1mnV7h2SLJIij5XGuAsVZ8sg0lg10L8GFzGiiz00xoMOhNWy5KaJzjVkRdo0MxB5tj2fpbtZsVUqK8Ru1%2BTbLAARe1hZJGWp5GkisijJI5HWIpcikcnZA2frV9uXxo5JnrS8%2FQ9C%2BbOu19H6z6YePziaBvzvgC75AE0ZDbmTG8K8f10YD3xehe0IOcry7Nr5g6LTA4dOsLoboRIsGXrh1deJYjcNm5vHHyOq8RgGYavl2rVGv7BF27qnKw%2BKgljyPfBv6OgGT0hBDmdxNUz8fHLVPw%3D%3D&RelayState=JAfzsR918qUtCuyj', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:10:05,244 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:10:05,244 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:10:05,244 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:10:05,244 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-9ce382dd6e173b962f68baa381ffd7b3" IssueInstant="2013-07-12T17:10:05Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:05,245 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-9ce382dd6e173b962f68baa381ffd7b3" IssueInstant="2013-07-12T17:10:05Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:05,245 saml2.entity:DEBUG Loaded request
2013-07-12 10:10:05,245 saml2.entity:DEBUG Verified request
2013-07-12 10:10:05,245 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT+MwEL3vr7B86SlNnIgmWE1QoUJbid2taODAzXWm1FJqZz2TAv9+nSwfQkI9cPOM3vO892bmF8+Hlh3Bo3G2nIhpMmFgtWuMfSwnd/V1VEwuqh9zi4lc9LS3t/C3ByQWaBZlaJe891Y6hSaU6gAoScvN4teNTKeJ7Lwjp13L3wniNEEhgqcghrPF2/PKWewP4Dfgj0bD3e1NyfdEnYzj1mnV7h2SLJIij5XGuAsVZ8sg0lg10L8GFzGiiz00xoMOhNWy5KaJzjVkRdo0MxB5tj2fpbtZsVUqK8Ru1+TbLAARe1hZJGWp5GkisijJI5HWIpcikcnZA2frV9uXxo5JnrS8/Q9C+bOu19H6z6YePziaBvzvgC75AE0ZDbmTG8K8f10YD3xehe0IOcry7Nr5g6LTA4dOsLoboRIsGXrh1deJYjcNm5vHHyOq8RgGYavl2rVGv7BF27qnKw+KgljyPfBv6OgGT0hBDmdxNUz8fHLVPw==', 'RelayState': 'JAfzsR918qUtCuyj', 'req_info': <saml2.request.AuthnRequest object at 0x1021ab910>}
2013-07-12 10:10:05,245 saml2.idp:DEBUG Do authentication
2013-07-12 10:10:05,245 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:10:05,245 saml2.idp:INFO The login page
2013-07-12 10:10:05,246 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '83319c386df3c14de0f0d1027ced219922a1498e', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:10:27,265 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:10:27,265 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLLTsMwELzzFZYvPaWJ00eC1QSVVhWVeFQ0cODmOIZaSu3g3RT4e5zwEhLqgYMlezXjnZnd2dnrviYH5UBbkw3YMBoQZaSttHnKBnfFKkgHZ/nJzEDE5y3uzK16bhUg8TQD3Jcz2jrDrQDtn2KvgKPk2/nVJY+HEW+cRSttTb8J7DhBACiHXgwl86/rwhpo98ptlTtoqe5uLzO6Q2x4GNZWinpnAXkapUkoJISNf1Gy9CK1ER39b3AaAtjQqUo7JT1hvcyoroLphEXTcVxWZSVTVj6OEn/SeDJK5fg0KcceCNCqtQEUBjMaR2wUREnA4oIlnEU8Th4o2XzaPtemT/Ko5fIDBPyiKDbB5mZb9B8cdKXctUdntIPGBLvc0XZh3n8OjHo+zf10GO9lObKybi/weMOu4q0+9lCuDGp8o/nfiUIz9JObhT8t8n4ZOmHr5cbWWr6ReV3bl4VTAr1YdK2i/9DRdJ4AvRxKwrzr+Hvl8nc='], 'RelayState': ['43a1NKu1ByKKUONp']}
2013-07-12 10:10:27,265 saml2.idp:INFO -- No USER --
2013-07-12 10:10:27,265 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:10:27,266 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLLTsMwELzzFZYvPaWJ00eC1QSVVhWVeFQ0cODmOIZaSu3g3RT4e5zwEhLqgYMlezXjnZnd2dnrviYH5UBbkw3YMBoQZaSttHnKBnfFKkgHZ%2FnJzEDE5y3uzK16bhUg8TQD3Jcz2jrDrQDtn2KvgKPk2%2FnVJY%2BHEW%2BcRSttTb8J7DhBACiHXgwl86%2Frwhpo98ptlTtoqe5uLzO6Q2x4GNZWinpnAXkapUkoJISNf1Gy9CK1ER39b3AaAtjQqUo7JT1hvcyoroLphEXTcVxWZSVTVj6OEn%2FSeDJK5fg0KcceCNCqtQEUBjMaR2wUREnA4oIlnEU8Th4o2XzaPtemT%2FKo5fIDBPyiKDbB5mZb9B8cdKXctUdntIPGBLvc0XZh3n8OjHo%2Bzf10GO9lObKybi%2FweMOu4q0%2B9lCuDGp8o%2FnfiUIz9JObhT8t8n4ZOmHr5cbWWr6ReV3bl4VTAr1YdK2i%2F9DRdJ4AvRxKwrzr%2BHvl8nc%3D&RelayState=43a1NKu1ByKKUONp', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:10:27,266 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:10:27,266 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:10:27,266 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:10:27,266 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-6510642bdbdc81bf37bf382538c497b4" IssueInstant="2013-07-12T17:10:27Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:27,266 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-6510642bdbdc81bf37bf382538c497b4" IssueInstant="2013-07-12T17:10:27Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:27,267 saml2.entity:DEBUG Loaded request
2013-07-12 10:10:27,267 saml2.entity:DEBUG Verified request
2013-07-12 10:10:27,267 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLLTsMwELzzFZYvPaWJ00eC1QSVVhWVeFQ0cODmOIZaSu3g3RT4e5zwEhLqgYMlezXjnZnd2dnrviYH5UBbkw3YMBoQZaSttHnKBnfFKkgHZ/nJzEDE5y3uzK16bhUg8TQD3Jcz2jrDrQDtn2KvgKPk2/nVJY+HEW+cRSttTb8J7DhBACiHXgwl86/rwhpo98ptlTtoqe5uLzO6Q2x4GNZWinpnAXkapUkoJISNf1Gy9CK1ER39b3AaAtjQqUo7JT1hvcyoroLphEXTcVxWZSVTVj6OEn/SeDJK5fg0KcceCNCqtQEUBjMaR2wUREnA4oIlnEU8Th4o2XzaPtemT/Ko5fIDBPyiKDbB5mZb9B8cdKXctUdntIPGBLvc0XZh3n8OjHo+zf10GO9lObKybi/weMOu4q0+9lCuDGp8o/nfiUIz9JObhT8t8n4ZOmHr5cbWWr6ReV3bl4VTAr1YdK2i/9DRdJ4AvRxKwrzr+Hvl8nc=', 'RelayState': '43a1NKu1ByKKUONp', 'req_info': <saml2.request.AuthnRequest object at 0x10219a750>}
2013-07-12 10:10:27,267 saml2.idp:DEBUG Do authentication
2013-07-12 10:10:27,267 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:10:27,267 saml2.idp:INFO The login page
2013-07-12 10:10:27,267 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '1082771322da05527e2da5f4375b0924178a1c64', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:10:47,628 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:10:47,628 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLBjtowEL33KyxfOIXE2ZakFgmiIFQkuouWsIe9GWe2WAp26pnQ8vfrZGmrSisOvXlG73neezPT2a9Tw87g0ThbjMQ4GTGw2tXGfi9G+2oV5aNZ+WFqMZHzjo72EX50gMQCzaIM7YJ33kqn0IRSnQAlabmbf9vIdJzI1jty2jX8D0HcJihE8BTEcDb//Vw4i90J/A782WjYP24KfiRqZRw3Tqvm6JBknuRZrDTGbag4WwaRxqqe/j44jxFd7KE2HnQgrJcFN3V0l08EHJJ88lLDQWef02xygEznQimYfErrAETsYG2RlKWCp4m4i5IsEmklMikS+TF75mx7tf3F2CHJm5YPbyCUX6tqG20fdtXwwdnU4O8DuuA9NGXU506uD/PpujAe+LwM2xFykOXZyvmTotsD+06w+jJAJVgydOHl+4liOw6bm8Z/R5TDMfTC1suta4y+sHnTuJ8LD4qCWPId8P/Q0faekIIczuKyn/jvyZWv'], 'RelayState': ['V9yQ6WauYNrLcnci']}
2013-07-12 10:10:47,628 saml2.idp:INFO -- No USER --
2013-07-12 10:10:47,628 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:10:47,628 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLBjtowEL33KyxfOIXE2ZakFgmiIFQkuouWsIe9GWe2WAp26pnQ8vfrZGmrSisOvXlG73neezPT2a9Tw87g0ThbjMQ4GTGw2tXGfi9G%2B2oV5aNZ%2BWFqMZHzjo72EX50gMQCzaIM7YJ33kqn0IRSnQAlabmbf9vIdJzI1jty2jX8D0HcJihE8BTEcDb%2F%2FVw4i90J%2FA782WjYP24KfiRqZRw3Tqvm6JBknuRZrDTGbag4WwaRxqqe%2Fj44jxFd7KE2HnQgrJcFN3V0l08EHJJ88lLDQWef02xygEznQimYfErrAETsYG2RlKWCp4m4i5IsEmklMikS%2BTF75mx7tf3F2CHJm5YPbyCUX6tqG20fdtXwwdnU4O8DuuA9NGXU506uD%2FPpujAe%2BLwM2xFykOXZyvmTotsD%2B06w%2BjJAJVgydOHl%2B4liOw6bm8Z%2FR5TDMfTC1suta4y%2BsHnTuJ8LD4qCWPId8P%2FQ0faekIIczuKyn%2FjvyZWv&RelayState=V9yQ6WauYNrLcnci', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:10:47,629 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:10:47,629 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:10:47,629 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:10:47,629 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-3861eb086fdebc79276be7c81aae652d" IssueInstant="2013-07-12T17:10:47Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:47,630 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-3861eb086fdebc79276be7c81aae652d" IssueInstant="2013-07-12T17:10:47Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:10:47,630 saml2.entity:DEBUG Loaded request
2013-07-12 10:10:47,630 saml2.entity:DEBUG Verified request
2013-07-12 10:10:47,630 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLBjtowEL33KyxfOIXE2ZakFgmiIFQkuouWsIe9GWe2WAp26pnQ8vfrZGmrSisOvXlG73neezPT2a9Tw87g0ThbjMQ4GTGw2tXGfi9G+2oV5aNZ+WFqMZHzjo72EX50gMQCzaIM7YJ33kqn0IRSnQAlabmbf9vIdJzI1jty2jX8D0HcJihE8BTEcDb//Vw4i90J/A782WjYP24KfiRqZRw3Tqvm6JBknuRZrDTGbag4WwaRxqqe/j44jxFd7KE2HnQgrJcFN3V0l08EHJJ88lLDQWef02xygEznQimYfErrAETsYG2RlKWCp4m4i5IsEmklMikS+TF75mx7tf3F2CHJm5YPbyCUX6tqG20fdtXwwdnU4O8DuuA9NGXU506uD/PpujAe+LwM2xFykOXZyvmTotsD+06w+jJAJVgydOHl+4liOw6bm8Z/R5TDMfTC1suta4y+sHnTuJ8LD4qCWPId8P/Q0faekIIczuKyn/jvyZWv', 'RelayState': 'V9yQ6WauYNrLcnci', 'req_info': <saml2.request.AuthnRequest object at 0x1021b06d0>}
2013-07-12 10:10:47,630 saml2.idp:DEBUG Do authentication
2013-07-12 10:10:47,630 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:10:47,630 saml2.idp:INFO The login page
2013-07-12 10:10:47,630 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '1121ab4edf647d2c3c1f0c8c95308d4f69a6f76a', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:12:13,359 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:12:13,359 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT+MwEL3zKyxfekoTp2wTrCaoUKGtBLsVTfewN9eZUEupXTyT7vLvccKXkFAP3Dyj9zzvvZnZ5f99y47g0ThbjMQ4GTGw2tXGPhSjTXUT5aPL8mxmMZHzjnb2Hh47QGKBZlGGdsE7b6VTaEKp9oCStFzP725lOk7kwTty2rX8nSBOExQieApiOJu/Pa+dxW4Pfg3+aDRs7m8LviM6yDhunVbtziHJPMmzWGmMD6HibBFEGqt6+tfgPEZ0sYfaeNCBsFwU3NQRNLm6mEy3qb7Q581U6Uz/SKaTJBN1U091E4CIHSwtkrJU8DQRkyjJIpFWIpMilWLyl7PVq+0rY4ckT1revoBQ/qyqVbT6va6GD46mBv8roAveQ1NGfe7k+jD/vC6MBz4vw3aEHGR5duP8XtHpgX0nWG0GqARLhp54+XWieBiHzc3ijxHlcAy9sOVi5Vqjn9i8bd2/aw+KgthGtQj8G0LIK4smyOEsLvuJn0+ufAY='], 'RelayState': ['0MwyT7WEMU9SVwju']}
2013-07-12 10:12:13,359 saml2.idp:INFO -- No USER --
2013-07-12 10:12:13,360 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:12:13,360 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT%2BMwEL3zKyxfekoTp2wTrCaoUKGtBLsVTfewN9eZUEupXTyT7vLvccKXkFAP3Dyj9zzvvZnZ5f99y47g0ThbjMQ4GTGw2tXGPhSjTXUT5aPL8mxmMZHzjnb2Hh47QGKBZlGGdsE7b6VTaEKp9oCStFzP725lOk7kwTty2rX8nSBOExQieApiOJu%2FPa%2BdxW4Pfg3%2BaDRs7m8LviM6yDhunVbtziHJPMmzWGmMD6HibBFEGqt6%2BtfgPEZ0sYfaeNCBsFwU3NQRNLm6mEy3qb7Q581U6Uz%2FSKaTJBN1U091E4CIHSwtkrJU8DQRkyjJIpFWIpMilWLyl7PVq%2B0rY4ckT1revoBQ%2FqyqVbT6va6GD46mBv8roAveQ1NGfe7k%2BjD%2FvC6MBz4vw3aEHGR5duP8XtHpgX0nWG0GqARLhp54%2BXWieBiHzc3ijxHlcAy9sOVi5Vqjn9i8bd2%2Faw%2BKgthGtQj8G0LIK4smyOEsLvuJn0%2BufAY%3D&RelayState=0MwyT7WEMU9SVwju', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:12:13,360 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:12:13,360 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:12:13,360 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:12:13,360 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-ef8a936b2c9c4f6ac7c5063071dfd6cf" IssueInstant="2013-07-12T17:12:13Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:12:13,366 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-ef8a936b2c9c4f6ac7c5063071dfd6cf" IssueInstant="2013-07-12T17:12:13Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:12:13,366 saml2.entity:DEBUG Loaded request
2013-07-12 10:12:13,366 saml2.entity:DEBUG Verified request
2013-07-12 10:12:13,366 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT+MwEL3zKyxfekoTp2wTrCaoUKGtBLsVTfewN9eZUEupXTyT7vLvccKXkFAP3Dyj9zzvvZnZ5f99y47g0ThbjMQ4GTGw2tXGPhSjTXUT5aPL8mxmMZHzjnb2Hh47QGKBZlGGdsE7b6VTaEKp9oCStFzP725lOk7kwTty2rX8nSBOExQieApiOJu/Pa+dxW4Pfg3+aDRs7m8LviM6yDhunVbtziHJPMmzWGmMD6HibBFEGqt6+tfgPEZ0sYfaeNCBsFwU3NQRNLm6mEy3qb7Q581U6Uz/SKaTJBN1U091E4CIHSwtkrJU8DQRkyjJIpFWIpMilWLyl7PVq+0rY4ckT1revoBQ/qyqVbT6va6GD46mBv8roAveQ1NGfe7k+jD/vC6MBz4vw3aEHGR5duP8XtHpgX0nWG0GqARLhp54+XWieBiHzc3ijxHlcAy9sOVi5Vqjn9i8bd2/aw+KgthGtQj8G0LIK4smyOEsLvuJn0+ufAY=', 'RelayState': '0MwyT7WEMU9SVwju', 'req_info': <saml2.request.AuthnRequest object at 0x1021b0e90>}
2013-07-12 10:12:13,366 saml2.idp:DEBUG Do authentication
2013-07-12 10:12:13,367 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:12:13,367 saml2.idp:INFO The login page
2013-07-12 10:12:13,367 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'd86a53ed49c2d0cac388c6e333dd8c32b4845f57', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:12:26,147 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:12:26,147 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLLTsMwELzzFZYvPaWJA20iqwkqVIhKPCoaOHAzzkItpXbwbgr8PU54CQn1wM27mvHOzO7s+HXbsB14NM4WIzFORgysdrWxT8XotjqL8tFxeTCzmMh5Rxt7A88dILFAsyhDu+Cdt9IpNKFUW0BJWq7nlxcyHSey9Y6cdg3/Joj9BIUInoIYzuZfz1NnsduCX4PfGQ23NxcF3xC1Mo4bp1WzcUgyT/IsVhrjNlScLYJIY1VP/xucx4gu9lAbDzoQlouCmzp6yMVkCml9lOnsKFOH2QTqfJpPEjHRQggdgIgdLC2SslTwNBGHUZJFIq1EJkUq0+k9Z6tP2yfGDknutfzwAUJ5XlWraHW9roYPdqYGfxXQBe+hKaM+d3J9mHefC+OBz8uwHSEHWZ6dOb9VtH9g3wlWHweoBEuG3nj5d6LYjsPmZvHPiHI4hl7YcrFyjdFvbN407uXUg6IglnwH/B862t4TUpDDWVz2E3+fXPkO'], 'RelayState': ['mZTCNkhOIDYPCNN1']}
2013-07-12 10:12:26,147 saml2.idp:INFO -- No USER --
2013-07-12 10:12:26,147 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:12:26,147 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLLTsMwELzzFZYvPaWJA20iqwkqVIhKPCoaOHAzzkItpXbwbgr8PU54CQn1wM27mvHOzO7s%2BHXbsB14NM4WIzFORgysdrWxT8XotjqL8tFxeTCzmMh5Rxt7A88dILFAsyhDu%2BCdt9IpNKFUW0BJWq7nlxcyHSey9Y6cdg3%2FJoj9BIUInoIYzuZfz1NnsduCX4PfGQ23NxcF3xC1Mo4bp1WzcUgyT%2FIsVhrjNlScLYJIY1VP%2Fxucx4gu9lAbDzoQlouCmzp6yMVkCml9lOnsKFOH2QTqfJpPEjHRQggdgIgdLC2SslTwNBGHUZJFIq1EJkUq0%2Bk9Z6tP2yfGDknutfzwAUJ5XlWraHW9roYPdqYGfxXQBe%2BhKaM%2Bd3J9mHefC%2BOBz8uwHSEHWZ6dOb9VtH9g3wlWHweoBEuG3nj5d6LYjsPmZvHPiHI4hl7YcrFyjdFvbN407uXUg6IglnwH%2FB862t4TUpDDWVz2E3%2BfXPkO&RelayState=mZTCNkhOIDYPCNN1', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:12:26,147 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:12:26,147 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:12:26,147 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:12:26,147 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-b8156e2d47c747a375ed8685015c111c" IssueInstant="2013-07-12T17:12:26Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:12:26,153 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-b8156e2d47c747a375ed8685015c111c" IssueInstant="2013-07-12T17:12:26Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:12:26,154 saml2.entity:DEBUG Loaded request
2013-07-12 10:12:26,154 saml2.entity:DEBUG Verified request
2013-07-12 10:12:26,154 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLLTsMwELzzFZYvPaWJA20iqwkqVIhKPCoaOHAzzkItpXbwbgr8PU54CQn1wM27mvHOzO7s+HXbsB14NM4WIzFORgysdrWxT8XotjqL8tFxeTCzmMh5Rxt7A88dILFAsyhDu+Cdt9IpNKFUW0BJWq7nlxcyHSey9Y6cdg3/Joj9BIUInoIYzuZfz1NnsduCX4PfGQ23NxcF3xC1Mo4bp1WzcUgyT/IsVhrjNlScLYJIY1VP/xucx4gu9lAbDzoQlouCmzp6yMVkCml9lOnsKFOH2QTqfJpPEjHRQggdgIgdLC2SslTwNBGHUZJFIq1EJkUq0+k9Z6tP2yfGDknutfzwAUJ5XlWraHW9roYPdqYGfxXQBe+hKaM+d3J9mHefC+OBz8uwHSEHWZ6dOb9VtH9g3wlWHweoBEuG3nj5d6LYjsPmZvHPiHI4hl7YcrFyjdFvbN407uXUg6IglnwH/B862t4TUpDDWVz2E3+fXPkO', 'RelayState': 'mZTCNkhOIDYPCNN1', 'req_info': <saml2.request.AuthnRequest object at 0x1021b4450>}
2013-07-12 10:12:26,154 saml2.idp:DEBUG Do authentication
2013-07-12 10:12:26,154 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:12:26,154 saml2.idp:INFO The login page
2013-07-12 10:12:26,154 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'c91e296df5ad1bdef9b42449de531d2393fae86f', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:13:09,037 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:13:09,037 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLLTsMwELzzFZYvPaV5AUmtJqhQISrxqGjgwM04W2optYN3U+DvccJLSKgHbt7VjHdmdqcnr9uG7cChtqYYxeNoxMAoW2vzVIzuqvMgH52UB1ODkZh1tDG38NwBEvM0g8K3C945I6xE7Uu5BRSkxGp2dSmScSRaZ8kq2/BvQryfIBHBkRfD2ezreWYNdltwK3A7reDu9rLgG6JWhGFjlWw2FknkUZ6FUmHY+oqzuRepjezpf4PzENGGDmrtQHnCYl5wXQepmqTHh2uZHdV5niYyzhQc50d5ehitZZJMPBCxg4VBkoYKnkRxGkRZECdVnIk4FdHkgbPlp+1TbYYk91p+/AChuKiqZbC8WVXDBztdg7v26IL30IRRnzvZPsz7z4Vxz+el304sBlmOnVu3lbR/YN/xVtcDVIAhTW+8/DtRbMd+c9PwZ0Q5HEMvbDFf2karNzZrGvty5kCSF0uuA/4PHW3vCcnL4Sws+4m/T658Bw=='], 'RelayState': ['LOFPTyVd1x0l0yGK']}
2013-07-12 10:13:09,037 saml2.idp:INFO -- No USER --
2013-07-12 10:13:09,037 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:13:09,038 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLLTsMwELzzFZYvPaV5AUmtJqhQISrxqGjgwM04W2optYN3U%2BDvccJLSKgHbt7VjHdmdqcnr9uG7cChtqYYxeNoxMAoW2vzVIzuqvMgH52UB1ODkZh1tDG38NwBEvM0g8K3C945I6xE7Uu5BRSkxGp2dSmScSRaZ8kq2%2FBvQryfIBHBkRfD2ezreWYNdltwK3A7reDu9rLgG6JWhGFjlWw2FknkUZ6FUmHY%2BoqzuRepjezpf4PzENGGDmrtQHnCYl5wXQepmqTHh2uZHdV5niYyzhQc50d5ehitZZJMPBCxg4VBkoYKnkRxGkRZECdVnIk4FdHkgbPlp%2B1TbYYk91p%2B%2FAChuKiqZbC8WVXDBztdg7v26IL30IRRnzvZPsz7z4Vxz%2Bel304sBlmOnVu3lbR%2FYN%2FxVtcDVIAhTW%2B8%2FDtRbMd%2Bc9PwZ0Q5HEMvbDFf2karNzZrGvty5kCSF0uuA%2F4PHW3vCcnL4Sws%2B4m%2FT658Bw%3D%3D&RelayState=LOFPTyVd1x0l0yGK', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:13:09,038 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:13:09,038 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:13:09,038 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:13:09,038 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-3c9364fa75d8832a17ce6858340fa229" IssueInstant="2013-07-12T17:13:09Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:13:09,044 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-3c9364fa75d8832a17ce6858340fa229" IssueInstant="2013-07-12T17:13:09Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:13:09,045 saml2.entity:DEBUG Loaded request
2013-07-12 10:13:09,045 saml2.entity:DEBUG Verified request
2013-07-12 10:13:09,045 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLLTsMwELzzFZYvPaV5AUmtJqhQISrxqGjgwM04W2optYN3U+DvccJLSKgHbt7VjHdmdqcnr9uG7cChtqYYxeNoxMAoW2vzVIzuqvMgH52UB1ODkZh1tDG38NwBEvM0g8K3C945I6xE7Uu5BRSkxGp2dSmScSRaZ8kq2/BvQryfIBHBkRfD2ezreWYNdltwK3A7reDu9rLgG6JWhGFjlWw2FknkUZ6FUmHY+oqzuRepjezpf4PzENGGDmrtQHnCYl5wXQepmqTHh2uZHdV5niYyzhQc50d5ehitZZJMPBCxg4VBkoYKnkRxGkRZECdVnIk4FdHkgbPlp+1TbYYk91p+/AChuKiqZbC8WVXDBztdg7v26IL30IRRnzvZPsz7z4Vxz+el304sBlmOnVu3lbR/YN/xVtcDVIAhTW+8/DtRbMd+c9PwZ0Q5HEMvbDFf2karNzZrGvty5kCSF0uuA/4PHW3vCcnL4Sws+4m/T658Bw==', 'RelayState': 'LOFPTyVd1x0l0yGK', 'req_info': <saml2.request.AuthnRequest object at 0x1021b4dd0>}
2013-07-12 10:13:09,045 saml2.idp:DEBUG Do authentication
2013-07-12 10:13:09,045 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:13:09,045 saml2.idp:INFO The login page
2013-07-12 10:13:09,045 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'c162e767ec6949c85f633761c1b1c1ae00b6f085', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:15:16,310 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:15:16,311 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT+MwEL3zKyxfekqTtIUEq0nVpUJU4qOi6R725jjD1lJqB8+kwL/HzrK7QkI9cPOM3vO892bmi9dDy47gUFtTjNJxMmJglG20+V2MdtV1lI8W5dncYCKWPe3NIzz3gMQ8zaDw7YL3zggrUftSHgAFKbFd3t2KyTgRnbNklW35P0J6miARwZEXw9ny7/PKGuwP4LbgjlrB7vG24HuiTsRxa5Vs9xZJ5EmexVJh3PmKs5UXqY0M9K/BeYxoYweNdqA8Yb0quG6ip3xWT+WlyqGezpqL2Uxl8rx5krJu6iRTlx6I2MPaIElDBZ8k6TRKsiidVGkm0nORXvzibPNh+4c2Q5InLdd/QChuqmoTbR621fDBUTfg7j264AE6YRRyJxvC/PmxMO75vPTbScUgy7Fr6w6STg8MnWB1gAowpOmNl18nit3Yb24e/x9RDscQhK1XG9tq9caWbWtfrhxI8mLJ9cC/oaMLnpC8HM7iMkz8fHLlOw=='], 'RelayState': ['DjHWvHA7nIcALB3o']}
2013-07-12 10:15:16,311 saml2.idp:INFO -- No USER --
2013-07-12 10:15:16,311 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:15:16,311 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT%2BMwEL3zKyxfekqTtIUEq0nVpUJU4qOi6R725jjD1lJqB8%2BkwL%2FHzrK7QkI9cPOM3vO892bmi9dDy47gUFtTjNJxMmJglG20%2BV2MdtV1lI8W5dncYCKWPe3NIzz3gMQ8zaDw7YL3zggrUftSHgAFKbFd3t2KyTgRnbNklW35P0J6miARwZEXw9ny7%2FPKGuwP4LbgjlrB7vG24HuiTsRxa5Vs9xZJ5EmexVJh3PmKs5UXqY0M9K%2FBeYxoYweNdqA8Yb0quG6ip3xWT%2BWlyqGezpqL2Uxl8rx5krJu6iRTlx6I2MPaIElDBZ8k6TRKsiidVGkm0nORXvzibPNh%2B4c2Q5InLdd%2FQChuqmoTbR621fDBUTfg7j264AE6YRRyJxvC%2FPmxMO75vPTbScUgy7Fr6w6STg8MnWB1gAowpOmNl18nit3Yb24e%2Fx9RDscQhK1XG9tq9caWbWtfrhxI8mLJ9cC%2FoaMLnpC8HM7iMkz8fHLlOw%3D%3D&RelayState=DjHWvHA7nIcALB3o', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:15:16,311 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:15:16,311 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:15:16,311 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:15:16,311 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-f84b3a9c8eb34d644c7a5dfaabdb07c9" IssueInstant="2013-07-12T17:15:16Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:15:16,317 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-f84b3a9c8eb34d644c7a5dfaabdb07c9" IssueInstant="2013-07-12T17:15:16Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:15:16,317 saml2.entity:DEBUG Loaded request
2013-07-12 10:15:16,317 saml2.entity:DEBUG Verified request
2013-07-12 10:15:16,317 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT+MwEL3zKyxfekqTtIUEq0nVpUJU4qOi6R725jjD1lJqB8+kwL/HzrK7QkI9cPOM3vO892bmi9dDy47gUFtTjNJxMmJglG20+V2MdtV1lI8W5dncYCKWPe3NIzz3gMQ8zaDw7YL3zggrUftSHgAFKbFd3t2KyTgRnbNklW35P0J6miARwZEXw9ny7/PKGuwP4LbgjlrB7vG24HuiTsRxa5Vs9xZJ5EmexVJh3PmKs5UXqY0M9K/BeYxoYweNdqA8Yb0quG6ip3xWT+WlyqGezpqL2Uxl8rx5krJu6iRTlx6I2MPaIElDBZ8k6TRKsiidVGkm0nORXvzibPNh+4c2Q5InLdd/QChuqmoTbR621fDBUTfg7j264AE6YRRyJxvC/PmxMO75vPTbScUgy7Fr6w6STg8MnWB1gAowpOmNl18nit3Yb24e/x9RDscQhK1XG9tq9caWbWtfrhxI8mLJ9cC/oaMLnpC8HM7iMkz8fHLlOw==', 'RelayState': 'DjHWvHA7nIcALB3o', 'req_info': <saml2.request.AuthnRequest object at 0x1021b0590>}
2013-07-12 10:15:16,317 saml2.idp:DEBUG Do authentication
2013-07-12 10:15:16,317 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:15:16,317 saml2.idp:INFO The login page
2013-07-12 10:15:16,317 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '5121cb3b9480d26d538cbcdbea6692aba0c9e7d9', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:17:13,616 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:17:13,616 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVJNT8MwDL3zK6Jcdur6xdQuWosGE2ISHxMrHLhlqccidcmI3QH/nrQMEBLaASkH23ovfn725Oxt27A9ONTWFIN4GA0YGGVrbZ6LwUN1GeSDs/JkYjAS05Y25h5eWkBinmZQ+HLBW2eElah9KreAgpRYTm+uRTKMxM5Zsso2/JsQHydIRHDkxXA2/QovrMF2C24Jbq8VPNxfF3xDtBNh2Fglm41FEnmUZ6FUGO58xtnMi9RGdvS/wXmIaEMHtXagPGE+K7iug9NVmsoMYDweJ9HoVK5XagSrWuajNPP1sQcitjA3SNJQwZMoToMoC+KkijPRvfSJs8Vh7HNteiePjrz6BKG4qqpFsLhbVv0He12Du/XognfQhFHnO9nOzMfDwrjn89JvJxa9LMcurdtKOt6wq/hR1z1UgCFN77z821HcDf3mJuFPi7I/hk7YfLawjVbvbNo09vXCgSQvdi0bBP4PIeSkQe3lcBaWXcffJ1d+AA=='], 'RelayState': ['Nj0SusYXuYkK1043']}
2013-07-12 10:17:13,616 saml2.idp:INFO -- No USER --
2013-07-12 10:17:13,616 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:17:13,616 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVJNT8MwDL3zK6Jcdur6xdQuWosGE2ISHxMrHLhlqccidcmI3QH%2FnrQMEBLaASkH23ovfn725Oxt27A9ONTWFIN4GA0YGGVrbZ6LwUN1GeSDs%2FJkYjAS05Y25h5eWkBinmZQ%2BHLBW2eElah9KreAgpRYTm%2BuRTKMxM5Zsso2%2FJsQHydIRHDkxXA2%2FQovrMF2C24Jbq8VPNxfF3xDtBNh2Fglm41FEnmUZ6FUGO58xtnMi9RGdvS%2FwXmIaEMHtXagPGE%2BK7iug9NVmsoMYDweJ9HoVK5XagSrWuajNPP1sQcitjA3SNJQwZMoToMoC%2BKkijPRvfSJs8Vh7HNteiePjrz6BKG4qqpFsLhbVv0He12Du%2FXognfQhFHnO9nOzMfDwrjn89JvJxa9LMcurdtKOt6wq%2FhR1z1UgCFN77z821HcDf3mJuFPi7I%2Fhk7YfLawjVbvbNo09vXCgSQvdi0bBP4PIeSkQe3lcBaWXcffJ1d%2BAA%3D%3D&RelayState=Nj0SusYXuYkK1043', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:17:13,616 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:17:13,616 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:17:13,616 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:17:13,617 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-4b33a7ee9992054afbc5ebda8537a7e9" IssueInstant="2013-07-12T17:17:13Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:17:13,617 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-4b33a7ee9992054afbc5ebda8537a7e9" IssueInstant="2013-07-12T17:17:13Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:17:13,617 saml2.entity:DEBUG Loaded request
2013-07-12 10:17:13,617 saml2.entity:DEBUG Verified request
2013-07-12 10:17:13,617 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVJNT8MwDL3zK6Jcdur6xdQuWosGE2ISHxMrHLhlqccidcmI3QH/nrQMEBLaASkH23ovfn725Oxt27A9ONTWFIN4GA0YGGVrbZ6LwUN1GeSDs/JkYjAS05Y25h5eWkBinmZQ+HLBW2eElah9KreAgpRYTm+uRTKMxM5Zsso2/JsQHydIRHDkxXA2/QovrMF2C24Jbq8VPNxfF3xDtBNh2Fglm41FEnmUZ6FUGO58xtnMi9RGdvS/wXmIaEMHtXagPGE+K7iug9NVmsoMYDweJ9HoVK5XagSrWuajNPP1sQcitjA3SNJQwZMoToMoC+KkijPRvfSJs8Vh7HNteiePjrz6BKG4qqpFsLhbVv0He12Du/XognfQhFHnO9nOzMfDwrjn89JvJxa9LMcurdtKOt6wq/hR1z1UgCFN77z821HcDf3mJuFPi7I/hk7YfLawjVbvbNo09vXCgSQvdi0bBP4PIeSkQe3lcBaWXcffJ1d+AA==', 'RelayState': 'Nj0SusYXuYkK1043', 'req_info': <saml2.request.AuthnRequest object at 0x1021beb10>}
2013-07-12 10:17:13,618 saml2.idp:DEBUG Do authentication
2013-07-12 10:17:13,618 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:17:13,618 saml2.idp:INFO The login page
2013-07-12 10:17:13,618 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'b23f22b87c0a9a3e6de68531c18556b29d82617e', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:17:13,624 saml2.idp:INFO <application> PATH: verify
2013-07-12 10:17:13,624 saml2.idp:DEBUG QUERY: {}
2013-07-12 10:17:13,624 saml2.idp:INFO -- No USER --
2013-07-12 10:17:13,624 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 10:17:13,625 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['b23f22b87c0a9a3e6de68531c18556b29d82617e'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 10:17:13,625 saml2.idp:DEBUG Register roland under 'cS7QWaVKN6Lg8pKILbD9QBFd'
2013-07-12 10:17:13,625 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 17:22:13 GMT
2013-07-12 10:17:13,625 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=cS7QWaVKN6Lg8pKILbD9QBFd&key=b23f22b87c0a9a3e6de68531c18556b29d82617e
2013-07-12 10:17:13,631 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:17:13,631 saml2.idp:INFO = KAKA =
2013-07-12 10:17:13,632 saml2.idp:DEBUG KAKA: idpauthn=Y1M3UVdhVktONkxnOHBLSUxiRDlRQkZkOjE=
2013-07-12 10:17:13,632 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:17:13,632 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=Y1M3UVdhVktONkxnOHBLSUxiRDlRQkZkOjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=cS7QWaVKN6Lg8pKILbD9QBFd&key=b23f22b87c0a9a3e6de68531c18556b29d82617e', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:17:13,632 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:17:13,632 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVJNT8MwDL3zK6Jcdur6xdQuWosGE2ISHxMrHLhlqccidcmI3QH/nrQMEBLaASkH23ovfn725Oxt27A9ONTWFIN4GA0YGGVrbZ6LwUN1GeSDs/JkYjAS05Y25h5eWkBinmZQ+HLBW2eElah9KreAgpRYTm+uRTKMxM5Zsso2/JsQHydIRHDkxXA2/QovrMF2C24Jbq8VPNxfF3xDtBNh2Fglm41FEnmUZ6FUGO58xtnMi9RGdvS/wXmIaEMHtXagPGE+K7iug9NVmsoMYDweJ9HoVK5XagSrWuajNPP1sQcitjA3SNJQwZMoToMoC+KkijPRvfSJs8Vh7HNteiePjrz6BKG4qqpFsLhbVv0He12Du/XognfQhFHnO9nOzMfDwrjn89JvJxa9LMcurdtKOt6wq/hR1z1UgCFN77z821HcDf3mJuFPi7I/hk7YfLawjVbvbNo09vXCgSQvdi0bBP4PIeSkQe3lcBaWXcffJ1d+AA==', 'RelayState': 'Nj0SusYXuYkK1043', 'req_info': <saml2.request.AuthnRequest object at 0x1021beb10>}
2013-07-12 10:17:13,632 saml2.idp:INFO parsed OK
2013-07-12 10:17:13,632 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-4b33a7ee9992054afbc5ebda8537a7e9" IssueInstant="2013-07-12T17:17:13Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:17:13,632 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:17:13,632 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:17:13,632 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 10:17:13,633 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:17:13,633 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:17:13,633 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 10:17:13,633 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 10:17:13,633 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 10:17:13,634 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-3b7ae3764d659ab28b4cab6b3fd887cf" InResponseTo="id-4b33a7ee9992054afbc5ebda8537a7e9" IssueInstant="2013-07-12T17:17:13Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-a26775110a60bdafbbee4307cfd19ee8" IssueInstant="2013-07-12T17:17:13Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">ea57cf602ce6939e1430028cb626cbcc27e691bc5de9a2ff6dcfe4853b503122</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-4b33a7ee9992054afbc5ebda8537a7e9" NotOnOrAfter="2013-07-12T17:32:13Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T17:17:13Z" NotOnOrAfter="2013-07-12T17:32:13Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T17:17:13Z" SessionIndex="id-dc8c4a0ba9d18531eabc76c41f7fae7a"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 10:17:13,635 saml2.entity:INFO HTTP POST
2013-07-12 10:17:13,635 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtM2I3YWUzNzY0ZDY1OWFiMjhiNGNhYjZiM2ZkODg3Y2YiIEluUmVzcG9uc2VUbz0iaWQtNGIzM2E3ZWU5OTkyMDU0YWZiYzVlYmRhODUzN2E3ZTkiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxNzoxM1oiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtYTI2Nzc1MTEwYTYwYmRhZmJiZWU0MzA3Y2ZkMTllZTgiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxNzoxM1oiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+ZWE1N2NmNjAyY2U2OTM5ZTE0MzAwMjhjYjYyNmNiY2MyN2U2OTFiYzVkZTlhMmZmNmRjZmU0ODUzYjUwMzEyMjwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtNGIzM2E3ZWU5OTkyMDU0YWZiYzVlYmRhODUzN2E3ZTkiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNzozMjoxM1oiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE3OjE3OjEzWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE3OjMyOjEzWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxNzoxM1oiIFNlc3Npb25JbmRleD0iaWQtZGM4YzRhMGJhOWQxODUzMWVhYmM3NmM0MWY3ZmFlN2EiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="Nj0SusYXuYkK1043" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 10:17:58,286 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:17:58,287 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLBTuMwEL3vV1i+9JQmDiTNWk1QoUJbiYWKBg7cXHdKLaV21jMp8Pc4obsrJNQDkg/26D3Pe29mevG6b9gBPBpny5EYJyMGVruNsc/l6KG+jorRRfVjajGRs4529h7+dIDEAs2iDOWSd95Kp9CEp9oDStJyNft9I9NxIlvvyGnX8H8EcZqgEMFTEMPZ7O/1ylns9uBX4A9Gw8P9Tcl3RK2M48Zp1ewckiySYhIrjXEbXpzNg0hjVU//GlzEiC72sDEedCAs5iU3m2i9hnybT4pMiCw7h22RijzN15kSPzOd5GkAInawsEjKUsnTRJxFySQSaS0mMpyseOJsebR9aeyQ5EnL6w8Qyl91vYyWd6t6+OBgNuBvA7rkPTRl1OdOrg/z8TgwHvi8CtMRcpDl2bXze0WnG/aVYHU7QCVYMvTGq68TxXYcJjeN/7eohmXohS3mS9cY/cZmTeNerjwoCmLJd8C/oaPtPSEFOZzFVd/x88pV7w=='], 'RelayState': ['tntLjS5TgAE9kS6e']}
2013-07-12 10:17:58,287 saml2.idp:INFO -- No USER --
2013-07-12 10:17:58,287 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:17:58,287 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLBTuMwEL3vV1i%2B9JQmDiTNWk1QoUJbiYWKBg7cXHdKLaV21jMp8Pc4obsrJNQDkg%2F26D3Pe29mevG6b9gBPBpny5EYJyMGVruNsc%2Fl6KG%2BjorRRfVjajGRs4529h7%2BdIDEAs2iDOWSd95Kp9CEp9oDStJyNft9I9NxIlvvyGnX8H8EcZqgEMFTEMPZ7O%2F1ylns9uBX4A9Gw8P9Tcl3RK2M48Zp1ewckiySYhIrjXEbXpzNg0hjVU%2F%2FGlzEiC72sDEedCAs5iU3m2i9hnybT4pMiCw7h22RijzN15kSPzOd5GkAInawsEjKUsnTRJxFySQSaS0mMpyseOJsebR9aeyQ5EnL6w8Qyl91vYyWd6t6%2BOBgNuBvA7rkPTRl1OdOrg%2Fz8TgwHvi8CtMRcpDl2bXze0WnG%2FaVYHU7QCVYMvTGq68TxXYcJjeN%2F7eohmXohS3mS9cY%2FcZmTeNerjwoCmLJd8C%2FoaPtPSEFOZzFVd%2Fx88pV7w%3D%3D&RelayState=tntLjS5TgAE9kS6e', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:17:58,287 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:17:58,287 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:17:58,287 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:17:58,287 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-bbe6f678511554ef821626b5a195c062" IssueInstant="2013-07-12T17:17:58Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:17:58,288 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-bbe6f678511554ef821626b5a195c062" IssueInstant="2013-07-12T17:17:58Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:17:58,288 saml2.entity:DEBUG Loaded request
2013-07-12 10:17:58,288 saml2.entity:DEBUG Verified request
2013-07-12 10:17:58,288 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLBTuMwEL3vV1i+9JQmDiTNWk1QoUJbiYWKBg7cXHdKLaV21jMp8Pc4obsrJNQDkg/26D3Pe29mevG6b9gBPBpny5EYJyMGVruNsc/l6KG+jorRRfVjajGRs4529h7+dIDEAs2iDOWSd95Kp9CEp9oDStJyNft9I9NxIlvvyGnX8H8EcZqgEMFTEMPZ7O/1ylns9uBX4A9Gw8P9Tcl3RK2M48Zp1ewckiySYhIrjXEbXpzNg0hjVU//GlzEiC72sDEedCAs5iU3m2i9hnybT4pMiCw7h22RijzN15kSPzOd5GkAInawsEjKUsnTRJxFySQSaS0mMpyseOJsebR9aeyQ5EnL6w8Qyl91vYyWd6t6+OBgNuBvA7rkPTRl1OdOrg/z8TgwHvi8CtMRcpDl2bXze0WnG/aVYHU7QCVYMvTGq68TxXYcJjeN/7eohmXohS3mS9cY/cZmTeNerjwoCmLJd8C/oaPtPSEFOZzFVd/x88pV7w==', 'RelayState': 'tntLjS5TgAE9kS6e', 'req_info': <saml2.request.AuthnRequest object at 0x1021be450>}
2013-07-12 10:17:58,288 saml2.idp:DEBUG Do authentication
2013-07-12 10:17:58,288 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:17:58,288 saml2.idp:INFO The login page
2013-07-12 10:17:58,288 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': 'ccb512bf5182435ea499c072be82c496ae3aff62', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:18:04,572 saml2.idp:INFO <application> PATH: verify
2013-07-12 10:18:04,573 saml2.idp:DEBUG QUERY: {}
2013-07-12 10:18:04,573 saml2.idp:INFO -- No USER --
2013-07-12 10:18:04,573 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 10:18:04,573 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['ccb512bf5182435ea499c072be82c496ae3aff62'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 10:18:04,573 saml2.idp:DEBUG Register roland under 'FfgkFQyBAgqu8sG2e1zENaAw'
2013-07-12 10:18:04,573 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 17:23:04 GMT
2013-07-12 10:18:04,573 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=FfgkFQyBAgqu8sG2e1zENaAw&key=ccb512bf5182435ea499c072be82c496ae3aff62
2013-07-12 10:18:32,797 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:18:32,797 saml2.idp:INFO = KAKA =
2013-07-12 10:18:32,797 saml2.idp:DEBUG KAKA: idpauthn=RmZna0ZReUJBZ3F1OHNHMmUxekVOYUF3OjE=
2013-07-12 10:18:32,797 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:18:32,798 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=RmZna0ZReUJBZ3F1OHNHMmUxekVOYUF3OjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=FfgkFQyBAgqu8sG2e1zENaAw&key=ccb512bf5182435ea499c072be82c496ae3aff62', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:18:32,798 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:18:32,798 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVLBTuMwEL3vV1i+9JQmDiTNWk1QoUJbiYWKBg7cXHdKLaV21jMp8Pc4obsrJNQDkg/26D3Pe29mevG6b9gBPBpny5EYJyMGVruNsc/l6KG+jorRRfVjajGRs4529h7+dIDEAs2iDOWSd95Kp9CEp9oDStJyNft9I9NxIlvvyGnX8H8EcZqgEMFTEMPZ7O/1ylns9uBX4A9Gw8P9Tcl3RK2M48Zp1ewckiySYhIrjXEbXpzNg0hjVU//GlzEiC72sDEedCAs5iU3m2i9hnybT4pMiCw7h22RijzN15kSPzOd5GkAInawsEjKUsnTRJxFySQSaS0mMpyseOJsebR9aeyQ5EnL6w8Qyl91vYyWd6t6+OBgNuBvA7rkPTRl1OdOrg/z8TgwHvi8CtMRcpDl2bXze0WnG/aVYHU7QCVYMvTGq68TxXYcJjeN/7eohmXohS3mS9cY/cZmTeNerjwoCmLJd8C/oaPtPSEFOZzFVd/x88pV7w==', 'RelayState': 'tntLjS5TgAE9kS6e', 'req_info': <saml2.request.AuthnRequest object at 0x1021be450>}
2013-07-12 10:18:32,798 saml2.idp:INFO parsed OK
2013-07-12 10:18:32,798 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-bbe6f678511554ef821626b5a195c062" IssueInstant="2013-07-12T17:17:58Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-07-12 10:18:32,798 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:18:32,798 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:18:32,798 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 10:18:32,799 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:18:32,799 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:18:32,799 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 10:18:32,799 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="true" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" />
2013-07-12 10:18:32,800 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 10:18:32,801 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-fd0e84860aeefbf3a12945236af18d23" InResponseTo="id-bbe6f678511554ef821626b5a195c062" IssueInstant="2013-07-12T17:18:32Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-26a42633464ddc2d667430265f637d19" IssueInstant="2013-07-12T17:18:32Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">38ff568b2f6c25517740c9fdc789be7902449887cbc26e9275bbd5b9571004cd</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-bbe6f678511554ef821626b5a195c062" NotOnOrAfter="2013-07-12T17:33:32Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T17:18:32Z" NotOnOrAfter="2013-07-12T17:33:32Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T17:18:32Z" SessionIndex="id-a927174a1f1dfeef86b8057b45e2294a"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 10:18:32,802 saml2.entity:INFO HTTP POST
2013-07-12 10:18:32,802 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtZmQwZTg0ODYwYWVlZmJmM2ExMjk0NTIzNmFmMThkMjMiIEluUmVzcG9uc2VUbz0iaWQtYmJlNmY2Nzg1MTE1NTRlZjgyMTYyNmI1YTE5NWMwNjIiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxODozMloiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtMjZhNDI2MzM0NjRkZGMyZDY2NzQzMDI2NWY2MzdkMTkiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxODozMloiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnBlcnNpc3RlbnQiIE5hbWVRdWFsaWZpZXI9Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sIiBTUE5hbWVRdWFsaWZpZXI9Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4Ny9zcC54bWwiPjM4ZmY1NjhiMmY2YzI1NTE3NzQwYzlmZGM3ODliZTc5MDI0NDk4ODdjYmMyNmU5Mjc1YmJkNWI5NTcxMDA0Y2Q8L25zMTpOYW1lSUQ+PG5zMTpTdWJqZWN0Q29uZmlybWF0aW9uIE1ldGhvZD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNtOmJlYXJlciI+PG5zMTpTdWJqZWN0Q29uZmlybWF0aW9uRGF0YSBJblJlc3BvbnNlVG89ImlkLWJiZTZmNjc4NTExNTU0ZWY4MjE2MjZiNWExOTVjMDYyIiBOb3RPbk9yQWZ0ZXI9IjIwMTMtMDctMTJUMTc6MzM6MzJaIiBSZWNpcGllbnQ9Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4Ny9hY3MvcG9zdCIgLz48L25zMTpTdWJqZWN0Q29uZmlybWF0aW9uPjwvbnMxOlN1YmplY3Q+PG5zMTpDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAxMy0wNy0xMlQxNzoxODozMloiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNzozMzozMloiPjxuczE6QXVkaWVuY2VSZXN0cmljdGlvbj48bnMxOkF1ZGllbmNlPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4Ny9zcC54bWw8L25zMTpBdWRpZW5jZT48L25zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvbnMxOkNvbmRpdGlvbnM+PG5zMTpBdXRoblN0YXRlbWVudCBBdXRobkluc3RhbnQ9IjIwMTMtMDctMTJUMTc6MTg6MzJaIiBTZXNzaW9uSW5kZXg9ImlkLWE5MjcxNzRhMWYxZGZlZWY4NmI4MDU3YjQ1ZTIyOTRhIj48bnMxOkF1dGhuQ29udGV4dD48bnMxOkF1dGhuQ29udGV4dENsYXNzUmVmPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphYzpjbGFzc2VzOlBhc3N3b3JkPC9uczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+PG5zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT5odHRwOi8vUm9sYW5kcy1NYWNCb29rLmxvY2FsPC9uczE6QXV0aGVudGljYXRpbmdBdXRob3JpdHk+PC9uczE6QXV0aG5Db250ZXh0PjwvbnMxOkF1dGhuU3RhdGVtZW50PjxuczE6QXR0cmlidXRlU3RhdGVtZW50PjxuczE6QXR0cmlidXRlIEZyaWVuZGx5TmFtZT0iZWR1cGVyc29udGFyZ2V0ZWRpZCIgTmFtZT0idXJuOm9pZDoxLjMuNi4xLjQuMS41OTIzLjEuMS4xLjEwIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OnVyaSI+PG5zMTpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIj5vbmUhZm9yIWFsbDwvbnMxOkF0dHJpYnV0ZVZhbHVlPjwvbnMxOkF0dHJpYnV0ZT48L25zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PC9uczE6QXNzZXJ0aW9uPjwvbnMwOlJlc3BvbnNlPg==" />\n   <input type="hidden" name="RelayState" value="tntLjS5TgAE9kS6e" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-07-12 10:19:23,768 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:19:23,769 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLLTsMwELzzFZYvPaWJHWiC1QQVKkQlHlWbcuBmHJdaSu3i3RT4e5zwEhLqgZt3NeOdmd3x2eu2IXvtwThbDNgwGRBtlauNfSoGq+oyygdn5dHYQiImLW7sQj+3GpAEmgUR2gVtvRVOggml3GoQqMRycnMt+DARO+/QKdfQbwI7TJAA2mMQQ8nk63nhLLRb7Zfa743Sq8V1QTeIOxHHjVOy2ThAkSd5FksF8S5UlEyDSGNlR/8bnMcALva6Nl6rQJhNC2rqKFHHqeSjJB2l/KROpWSSsxGrs3rNs/yRByBAq2cWUFosKE9YGiVZxHjFMsFOBU8fKJl/2j43tk/yoOXHDxCIq6qaR/O7ZdV/sDe19rcBXdAOygl2uaPrwrz/XBgNfFqG7TDRy/Lk0vmtxMMDu06wuu6hQls0+EbLvxOF3TBsbhz/jCj7Y+iEzaZz1xj1RiZN414uvJYYxK5lA5r+Qwh6acEEOZTEZTfx98mV7w=='], 'RelayState': ['5wVY2lWpdNdV82up']}
2013-07-12 10:19:23,769 saml2.idp:INFO -- No USER --
2013-07-12 10:19:23,769 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:19:23,769 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'SAMLRequest=nVLLTsMwELzzFZYvPaWJHWiC1QQVKkQlHlWbcuBmHJdaSu3i3RT4e5zwEhLqgZt3NeOdmd3x2eu2IXvtwThbDNgwGRBtlauNfSoGq%2Boyygdn5dHYQiImLW7sQj%2B3GpAEmgUR2gVtvRVOggml3GoQqMRycnMt%2BDARO%2B%2FQKdfQbwI7TJAA2mMQQ8nk63nhLLRb7Zfa743Sq8V1QTeIOxHHjVOy2ThAkSd5FksF8S5UlEyDSGNlR%2F8bnMcALva6Nl6rQJhNC2rqKFHHqeSjJB2l%2FKROpWSSsxGrs3rNs%2FyRByBAq2cWUFosKE9YGiVZxHjFMsFOBU8fKJl%2F2j43tk%2FyoOXHDxCIq6qaR%2FO7ZdV%2FsDe19rcBXdAOygl2uaPrwrz%2FXBgNfFqG7TDRy%2FLk0vmtxMMDu06wuu6hQls0%2BEbLvxOF3TBsbhz%2FjCj7Y%2BiEzaZz1xj1RiZN414uvJYYxK5lA5r%2BQwh6acEEOZTEZTfx98mV7w%3D%3D&RelayState=5wVY2lWpdNdV82up', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:19:23,769 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:19:23,769 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-07-12 10:19:23,769 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-07-12 10:19:23,769 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0c43a26036325d3aa1a2161d7df278b2" IssueInstant="2013-07-12T17:19:23Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:19:23,770 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0c43a26036325d3aa1a2161d7df278b2" IssueInstant="2013-07-12T17:19:23Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:19:23,770 saml2.entity:DEBUG Loaded request
2013-07-12 10:19:23,770 saml2.entity:DEBUG Verified request
2013-07-12 10:19:23,770 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLLTsMwELzzFZYvPaWJHWiC1QQVKkQlHlWbcuBmHJdaSu3i3RT4e5zwEhLqgZt3NeOdmd3x2eu2IXvtwThbDNgwGRBtlauNfSoGq+oyygdn5dHYQiImLW7sQj+3GpAEmgUR2gVtvRVOggml3GoQqMRycnMt+DARO+/QKdfQbwI7TJAA2mMQQ8nk63nhLLRb7Zfa743Sq8V1QTeIOxHHjVOy2ThAkSd5FksF8S5UlEyDSGNlR/8bnMcALva6Nl6rQJhNC2rqKFHHqeSjJB2l/KROpWSSsxGrs3rNs/yRByBAq2cWUFosKE9YGiVZxHjFMsFOBU8fKJl/2j43tk/yoOXHDxCIq6qaR/O7ZdV/sDe19rcBXdAOygl2uaPrwrz/XBgNfFqG7TDRy/Lk0vmtxMMDu06wuu6hQls0+EbLvxOF3TBsbhz/jCj7Y+iEzaZz1xj1RiZN414uvJYYxK5lA5r+Qwh6acEEOZTEZTfx98mV7w==', 'RelayState': '5wVY2lWpdNdV82up', 'req_info': <saml2.request.AuthnRequest object at 0x1021be590>}
2013-07-12 10:19:23,770 saml2.idp:DEBUG Do authentication
2013-07-12 10:19:23,770 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x101d4cc80> (ref=1)
2013-07-12 10:19:23,770 saml2.idp:INFO The login page
2013-07-12 10:19:23,770 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '64cd52d4f40e4a2933bc63bab1b7199b2cab2848', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-07-12 10:19:23,777 saml2.idp:INFO <application> PATH: verify
2013-07-12 10:19:23,777 saml2.idp:DEBUG QUERY: {}
2013-07-12 10:19:23,777 saml2.idp:INFO -- No USER --
2013-07-12 10:19:23,777 saml2.idp:DEBUG Callback: <function do_verify at 0x101d4cd70>
2013-07-12 10:19:23,777 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['64cd52d4f40e4a2933bc63bab1b7199b2cab2848'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-07-12 10:19:23,777 saml2.idp:DEBUG Register roland under 'SYBZYFIZ5FoIDhhpKDALbBCG'
2013-07-12 10:19:23,778 saml2.idp:DEBUG Cookie expires: Fri, 12-Jul-2013 17:24:23 GMT
2013-07-12 10:19:23,778 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=SYBZYFIZ5FoIDhhpKDALbBCG&key=64cd52d4f40e4a2933bc63bab1b7199b2cab2848
2013-07-12 10:19:23,784 saml2.idp:INFO <application> PATH: sso/redirect
2013-07-12 10:19:23,784 saml2.idp:INFO = KAKA =
2013-07-12 10:19:23,784 saml2.idp:DEBUG KAKA: idpauthn=U1lCWllGSVo1Rm9JRGhocEtEQUxiQkNHOjE=
2013-07-12 10:19:23,784 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-07-12 10:19:23,784 saml2.idp:DEBUG ENVIRON: {'idp.authn_ref': '1', 'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'TERM_PROGRAM_VERSION': '309', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-oOFjt7/org.macosforge.xquartz:0', 'TERM_PROGRAM': 'Apple_Terminal', 'LANG': 'sv_SE.UTF-8', 'SHELL': '/bin/bash', 'SECURITYSESSIONID': '186a6', '_': './idp.py', 'SERVER_PORT': '8088', 'HTTP_HOST': 'localhost:8088', 'SCRIPT_NAME': '', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100282270>, 'wsgi.multiprocess': False, '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', 'USER': 'rolandh', 'HTTP_COOKIE': 'idpauthn=U1lCWllGSVo1Rm9JRGhocEtEQUxiQkNHOjE=', 'LOGNAME': 'rolandh', 'PATH_INFO': '/sso/redirect', 'QUERY_STRING': 'id=SYBZYFIZ5FoIDhhpKDALbBCG&key=64cd52d4f40e4a2933bc63bab1b7199b2cab2848', 'PATH': '/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin', 'TERM': 'xterm-256color', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/12.4.0', 'SERVER_NAME': 'Rolands-MacBook.local', 'REMOTE_ADDR': '127.0.0.1', 'SHLVL': '1', 'MACOSX_DEPLOYMENT_TARGET': '10.6', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'CONTENT_LENGTH': '0', 'TERM_SESSION_ID': '8B64599D-0044-4C2B-A703-EE32A3C6C45B', 'SSH_AUTH_SOCK': '/tmp/launch-fAFYf0/Listeners', 'wsgi.input': <socket._fileobject object at 0x101f03950>, 'Apple_PubSub_Socket_Render': '/tmp/launch-Ayf7r5/Render', 'wsgi.multithread': True, 'LC_ALL': 'sv_SE.UTF-8', 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'Apple_Ubiquity_Message': '/tmp/launch-RniW1Y/Apple_Ubiquity_Message', 'PWD': '/Users/rolandh/code/pysaml2/example/idp2', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x101f173f8>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress', 'COMMAND_MODE': 'unix2003'}
2013-07-12 10:19:23,785 saml2.idp:INFO --- In SSO Redirect ---
2013-07-12 10:19:23,785 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVLLTsMwELzzFZYvPaWJHWiC1QQVKkQlHlWbcuBmHJdaSu3i3RT4e5zwEhLqgZt3NeOdmd3x2eu2IXvtwThbDNgwGRBtlauNfSoGq+oyygdn5dHYQiImLW7sQj+3GpAEmgUR2gVtvRVOggml3GoQqMRycnMt+DARO+/QKdfQbwI7TJAA2mMQQ8nk63nhLLRb7Zfa743Sq8V1QTeIOxHHjVOy2ThAkSd5FksF8S5UlEyDSGNlR/8bnMcALva6Nl6rQJhNC2rqKFHHqeSjJB2l/KROpWSSsxGrs3rNs/yRByBAq2cWUFosKE9YGiVZxHjFMsFOBU8fKJl/2j43tk/yoOXHDxCIq6qaR/O7ZdV/sDe19rcBXdAOygl2uaPrwrz/XBgNfFqG7TDRy/Lk0vmtxMMDu06wuu6hQls0+EbLvxOF3TBsbhz/jCj7Y+iEzaZz1xj1RiZN414uvJYYxK5lA5r+Qwh6acEEOZTEZTfx98mV7w==', 'RelayState': '5wVY2lWpdNdV82up', 'req_info': <saml2.request.AuthnRequest object at 0x1021be590>}
2013-07-12 10:19:23,785 saml2.idp:INFO parsed OK
2013-07-12 10:19:23,785 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-0c43a26036325d3aa1a2161d7df278b2" IssueInstant="2013-07-12T17:19:23Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" /></ns0:AuthnRequest>
2013-07-12 10:19:23,785 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:19:23,785 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:19:23,785 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087/acs/post
2013-07-12 10:19:23,785 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-07-12 10:19:23,785 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087/acs/post'}]
2013-07-12 10:19:23,785 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'schacHomeOrganization': 'example.com', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-07-12 10:19:23,786 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x101f1c990>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
2013-07-12 10:19:23,786 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-07-12 10:19:23,787 saml2.idp:INFO AuthNResponse: <?xml version='1.0' encoding='UTF-8'?>
<ns0:Response xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="http://localhost:8087/acs/post" ID="id-89e543d21d8318e742215dc49d405853" InResponseTo="id-0c43a26036325d3aa1a2161d7df278b2" IssueInstant="2013-07-12T17:19:23Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns0:Status><ns0:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></ns0:Status><ns1:Assertion ID="id-3b657df0e2f3f4865aa5bca240ecc5ab" IssueInstant="2013-07-12T17:19:23Z" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8088/idp.xml</ns1:Issuer><ns1:Subject><ns1:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="http://localhost:8088/idp.xml" SPNameQualifier="http://localhost:8087/sp.xml">3430b25e9268974dd80e04615ee29915eae48e6196886adcb4ccdce921a8dbdc</ns1:NameID><ns1:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><ns1:SubjectConfirmationData InResponseTo="id-0c43a26036325d3aa1a2161d7df278b2" NotOnOrAfter="2013-07-12T17:34:23Z" Recipient="http://localhost:8087/acs/post" /></ns1:SubjectConfirmation></ns1:Subject><ns1:Conditions NotBefore="2013-07-12T17:19:23Z" NotOnOrAfter="2013-07-12T17:34:23Z"><ns1:AudienceRestriction><ns1:Audience>http://localhost:8087/sp.xml</ns1:Audience></ns1:AudienceRestriction></ns1:Conditions><ns1:AuthnStatement AuthnInstant="2013-07-12T17:19:23Z" SessionIndex="id-6b7925f4c5e11c78fa26b446b3c0fe7b"><ns1:AuthnContext><ns1:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</ns1:AuthnContextClassRef><ns1:AuthenticatingAuthority>http://Rolands-MacBook.local</ns1:AuthenticatingAuthority></ns1:AuthnContext></ns1:AuthnStatement><ns1:AttributeStatement><ns1:Attribute FriendlyName="edupersontargetedid" Name="urn:oid:1.3.6.1.4.1.5923.1.1.1.10" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:uri"><ns1:AttributeValue xsi:type="xs:string">one!for!all</ns1:AttributeValue></ns1:Attribute></ns1:AttributeStatement></ns1:Assertion></ns0:Response>
2013-07-12 10:19:23,788 saml2.entity:INFO HTTP POST
2013-07-12 10:19:23,788 saml2.idp:DEBUG HTTPargs: {'url': 'http://localhost:8087/acs/post', 'headers': [('Content-type', 'text/html')], 'data': ['<head>', '<title>SAML 2.0 POST</title>', '</head><body>', '<form method="post" action="http://localhost:8087/acs/post">\n   <input type="hidden" name="SAMLResponse" value="PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPG5zMDpSZXNwb25zZSB4bWxuczpuczA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6bnMxPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiBJRD0iaWQtODllNTQzZDIxZDgzMThlNzQyMjE1ZGM0OWQ0MDU4NTMiIEluUmVzcG9uc2VUbz0iaWQtMGM0M2EyNjAzNjMyNWQzYWExYTIxNjFkN2RmMjc4YjIiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxOToyM1oiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczA6U3RhdHVzPjxuczA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvbnMwOlN0YXR1cz48bnMxOkFzc2VydGlvbiBJRD0iaWQtM2I2NTdkZjBlMmYzZjQ4NjVhYTViY2EyNDBlY2M1YWIiIElzc3VlSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxOToyM1oiIFZlcnNpb249IjIuMCI+PG5zMTpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4OC9pZHAueG1sPC9uczE6SXNzdWVyPjxuczE6U3ViamVjdD48bnMxOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OnRyYW5zaWVudCIgTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg4L2lkcC54bWwiIFNQTmFtZVF1YWxpZmllcj0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbCI+MzQzMGIyNWU5MjY4OTc0ZGQ4MGUwNDYxNWVlMjk5MTVlYWU0OGU2MTk2ODg2YWRjYjRjY2RjZTkyMWE4ZGJkYzwvbnMxOk5hbWVJRD48bnMxOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48bnMxOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iaWQtMGM0M2EyNjAzNjMyNWQzYWExYTIxNjFkN2RmMjc4YjIiIE5vdE9uT3JBZnRlcj0iMjAxMy0wNy0xMlQxNzozNDoyM1oiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MDg3L2Fjcy9wb3N0IiAvPjwvbnMxOlN1YmplY3RDb25maXJtYXRpb24+PC9uczE6U3ViamVjdD48bnMxOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDEzLTA3LTEyVDE3OjE5OjIzWiIgTm90T25PckFmdGVyPSIyMDEzLTA3LTEyVDE3OjM0OjIzWiI+PG5zMTpBdWRpZW5jZVJlc3RyaWN0aW9uPjxuczE6QXVkaWVuY2U+aHR0cDovL2xvY2FsaG9zdDo4MDg3L3NwLnhtbDwvbnMxOkF1ZGllbmNlPjwvbnMxOkF1ZGllbmNlUmVzdHJpY3Rpb24+PC9uczE6Q29uZGl0aW9ucz48bnMxOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNy0xMlQxNzoxOToyM1oiIFNlc3Npb25JbmRleD0iaWQtNmI3OTI1ZjRjNWUxMWM3OGZhMjZiNDQ2YjNjMGZlN2IiPjxuczE6QXV0aG5Db250ZXh0PjxuczE6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L25zMTpBdXRobkNvbnRleHRDbGFzc1JlZj48bnMxOkF1dGhlbnRpY2F0aW5nQXV0aG9yaXR5Pmh0dHA6Ly9Sb2xhbmRzLU1hY0Jvb2subG9jYWw8L25zMTpBdXRoZW50aWNhdGluZ0F1dGhvcml0eT48L25zMTpBdXRobkNvbnRleHQ+PC9uczE6QXV0aG5TdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PG5zMTpBdHRyaWJ1dGUgRnJpZW5kbHlOYW1lPSJlZHVwZXJzb250YXJnZXRlZGlkIiBOYW1lPSJ1cm46b2lkOjEuMy42LjEuNC4xLjU5MjMuMS4xLjEuMTAiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dXJpIj48bnMxOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm9uZSFmb3IhYWxsPC9uczE6QXR0cmlidXRlVmFsdWU+PC9uczE6QXR0cmlidXRlPjwvbnMxOkF0dHJpYnV0ZVN0YXRlbWVudD48L25zMTpBc3NlcnRpb24+PC9uczA6UmVzcG9uc2U+" />\n   <input type="hidden" name="RelayState" value="5wVY2lWpdNdV82up" />\n</form>', '<script type="text/javascript">', '     window.onload = function ()', ' { document.forms[0].submit(); }', '</script>', '</body>'], 'method': 'GET'}
2013-12-12 13:05:51,472 saml2:INFO Logging started
2013-12-12 13:06:08,117 saml2.idp:INFO <application> PATH: sso/redirect
2013-12-12 13:06:08,118 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['lVJNaxsxEL33VwhdfLL3I2mtCO8GJybU4DYmXueQm6ydjQVraauZdet/X2mTNhSMoaCDNLynee/NzG5/HVp2BI/G2WKUTdIRA6tdbexrMdpWD2Mxui0/zSymct7T3j7Bjx6QWKBZlKFc8N5b6RSa8FQHQElabubfVjKfpLLzjpx2Lf9LyC4TFCJ4CmI4m/+53juL/QH8BvzRaNg+rQq+J+pkkrROq3bvkKRIxTRRGpMuvDhbBJHGqkg/DxYJoks81MaDDoTlouCmHjcK6qnIG/isptdiCnW9a3ZZk2tRC3EDEICIPSwtkrJU8DzNrsZZHk6V5TL9IlPxwtn63fadsUOSFy3v3kAov1bVerx+3FTDB0dTg/8e0AWP0JxRzJ1cDPP5fWA88HkZppPJQZZnD84fFF1uGCvR6gCVYMnQiZfnE8VuEiY3Sz5alMMyRGHLxdq1Rp/YvG3dz3sPioLYRrUYYvp/IV00hRT0cJaUseW/O1f+Bg=='], 'RelayState': ['l0LX5FRIMBRZ5mJr']}
2013-12-12 13:06:08,119 saml2.idp:INFO -- No USER --
2013-12-12 13:06:08,122 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-12-12 13:06:08,123 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'SCRIPT_NAME': '', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-NEu4Gm/org.macosforge.xquartz:0', 'CONTENT_LENGTH': '0', 'Apple_PubSub_Socket_Render': '/tmp/launch-xVjbBY/Render', 'SERVER_PORT': '8088', 'PYTHONPATH': '/Users/rolandh/code/pysaml2/src:/Users/rolandh/code/pysaml2', 'HTTP_HOST': 'localhost:8088', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100283270>, 'wsgi.multiprocess': False, 'PYCHARM_HOSTED': '1', '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', '__CHECKFIX1436934': '1', 'PATH_INFO': '/sso/redirect', 'PYTHONIOENCODING': 'UTF-8', 'LOGNAME': 'roland', 'USER': 'roland', 'QUERY_STRING': 'SAMLRequest=lVJNaxsxEL33VwhdfLL3I2mtCO8GJybU4DYmXueQm6ydjQVraauZdet%2FX2mTNhSMoaCDNLynee%2FNzG5%2FHVp2BI%2FG2WKUTdIRA6tdbexrMdpWD2Mxui0%2FzSymct7T3j7Bjx6QWKBZlKFc8N5b6RSa8FQHQElabubfVjKfpLLzjpx2Lf9LyC4TFCJ4CmI4m%2F%2B53juL%2FQH8BvzRaNg%2BrQq%2BJ%2BpkkrROq3bvkKRIxTRRGpMuvDhbBJHGqkg%2FDxYJoks81MaDDoTlouCmHjcK6qnIG%2FisptdiCnW9a3ZZk2tRC3EDEICIPSwtkrJU8DzNrsZZHk6V5TL9IlPxwtn63fadsUOSFy3v3kAov1bVerx%2B3FTDB0dTg%2F8e0AWP0JxRzJ1cDPP5fWA88HkZppPJQZZnD84fFF1uGCvR6gCVYMnQiZfnE8VuEiY3Sz5alMMyRGHLxdq1Rp%2FYvG3dz3sPioLYRrUYYvp%2FIV00hRT0cJaUseW%2FO1f%2BBg%3D%3D&RelayState=l0LX5FRIMBRZ5mJr', 'PATH': '/usr/bin:/bin:/usr/sbin:/sbin', 'PYTHONUNBUFFERED': '1', 'TERM': 'emacs', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/13.0.0', 'SERVER_NAME': 'lingon.ladok.umu.se', 'REMOTE_ADDR': '127.0.0.1', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'GPG_AGENT_INFO': '/Users/rolandh/.gnupg/S.gpg-agent:379:1', 'SSH_AUTH_SOCK': '/tmp/launch-4QUUlT/Listeners', 'wsgi.input': <socket._fileobject object at 0x105756a50>, 'SHELL': '/bin/bash', 'wsgi.multithread': True, 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x10574a050>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress'}
2013-12-12 13:06:08,123 saml2.idp:INFO --- In SSO Redirect ---
2013-12-12 13:06:08,124 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-12-12 13:06:08,124 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-12-12 13:06:08,125 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-faed782fe5a7487eddbfb1f2c8d889ee" IssueInstant="2013-12-12T12:06:08Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:06:08,128 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-faed782fe5a7487eddbfb1f2c8d889ee" IssueInstant="2013-12-12T12:06:08Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:06:08,143 saml2.entity:DEBUG Loaded request
2013-12-12 13:06:08,144 saml2.entity:DEBUG Verified request
2013-12-12 13:06:08,144 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'lVJNaxsxEL33VwhdfLL3I2mtCO8GJybU4DYmXueQm6ydjQVraauZdet/X2mTNhSMoaCDNLynee/NzG5/HVp2BI/G2WKUTdIRA6tdbexrMdpWD2Mxui0/zSymct7T3j7Bjx6QWKBZlKFc8N5b6RSa8FQHQElabubfVjKfpLLzjpx2Lf9LyC4TFCJ4CmI4m/+53juL/QH8BvzRaNg+rQq+J+pkkrROq3bvkKRIxTRRGpMuvDhbBJHGqkg/DxYJoks81MaDDoTlouCmHjcK6qnIG/isptdiCnW9a3ZZk2tRC3EDEICIPSwtkrJU8DzNrsZZHk6V5TL9IlPxwtn63fadsUOSFy3v3kAov1bVerx+3FTDB0dTg/8e0AWP0JxRzJ1cDPP5fWA88HkZppPJQZZnD84fFF1uGCvR6gCVYMnQiZfnE8VuEiY3Sz5alMMyRGHLxdq1Rp/YvG3dz3sPioLYRrUYYvp/IV00hRT0cJaUseW/O1f+Bg==', 'RelayState': 'l0LX5FRIMBRZ5mJr', 'req_info': <saml2.request.AuthnRequest object at 0x105933d10>}
2013-12-12 13:06:08,144 saml2.idp:DEBUG Do authentication
2013-12-12 13:06:35,215 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x10573b488> (ref=1)
2013-12-12 13:06:35,215 saml2.idp:INFO The login page
2013-12-12 13:06:35,216 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '03c32d06310a5c753c616360ae73091fa5adf2bf', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-12-12 13:06:41,542 saml2.idp:INFO <application> PATH: verify
2013-12-12 13:06:41,543 saml2.idp:DEBUG QUERY: {}
2013-12-12 13:06:41,543 saml2.idp:INFO -- No USER --
2013-12-12 13:06:41,544 saml2.idp:DEBUG Callback: <function do_verify at 0x10573b578>
2013-12-12 13:06:41,544 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['03c32d06310a5c753c616360ae73091fa5adf2bf'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-12-12 13:06:41,545 saml2.idp:DEBUG Register roland under 'yhvTzExrDU0of6TuOwrC2ByC'
2013-12-12 13:06:41,546 saml2.idp:DEBUG Cookie expires: Thu, 12-Dec-2013 12:11:41 GMT
2013-12-12 13:06:41,546 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=yhvTzExrDU0of6TuOwrC2ByC&key=03c32d06310a5c753c616360ae73091fa5adf2bf
2013-12-12 13:06:41,577 saml2.idp:INFO <application> PATH: sso/redirect
2013-12-12 13:06:41,578 saml2.idp:INFO = KAKA =
2013-12-12 13:06:41,578 saml2.idp:DEBUG KAKA: idpauthn=eWh2VHpFeHJEVTBvZjZUdU93ckMyQnlDOjE=
2013-12-12 13:06:41,579 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-12-12 13:06:41,579 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'SCRIPT_NAME': '', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-NEu4Gm/org.macosforge.xquartz:0', 'CONTENT_LENGTH': '0', 'Apple_PubSub_Socket_Render': '/tmp/launch-xVjbBY/Render', 'idp.authn_ref': '1', 'SERVER_PORT': '8088', 'PYTHONPATH': '/Users/rolandh/code/pysaml2/src:/Users/rolandh/code/pysaml2', 'HTTP_HOST': 'localhost:8088', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100283270>, 'wsgi.multiprocess': False, 'PYCHARM_HOSTED': '1', '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', '__CHECKFIX1436934': '1', 'PATH_INFO': '/sso/redirect', 'PYTHONIOENCODING': 'UTF-8', 'HTTP_COOKIE': 'idpauthn=eWh2VHpFeHJEVTBvZjZUdU93ckMyQnlDOjE=', 'LOGNAME': 'roland', 'USER': 'roland', 'QUERY_STRING': 'id=yhvTzExrDU0of6TuOwrC2ByC&key=03c32d06310a5c753c616360ae73091fa5adf2bf', 'PATH': '/usr/bin:/bin:/usr/sbin:/sbin', 'PYTHONUNBUFFERED': '1', 'TERM': 'emacs', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/13.0.0', 'SERVER_NAME': 'lingon.ladok.umu.se', 'REMOTE_ADDR': '127.0.0.1', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'GPG_AGENT_INFO': '/Users/rolandh/.gnupg/S.gpg-agent:379:1', 'SSH_AUTH_SOCK': '/tmp/launch-4QUUlT/Listeners', 'wsgi.input': <socket._fileobject object at 0x105756a50>, 'SHELL': '/bin/bash', 'wsgi.multithread': True, 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x10574a050>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress'}
2013-12-12 13:06:41,580 saml2.idp:INFO --- In SSO Redirect ---
2013-12-12 13:06:41,580 saml2.idp:DEBUG _operation: {'SAMLRequest': 'lVJNaxsxEL33VwhdfLL3I2mtCO8GJybU4DYmXueQm6ydjQVraauZdet/X2mTNhSMoaCDNLynee/NzG5/HVp2BI/G2WKUTdIRA6tdbexrMdpWD2Mxui0/zSymct7T3j7Bjx6QWKBZlKFc8N5b6RSa8FQHQElabubfVjKfpLLzjpx2Lf9LyC4TFCJ4CmI4m/+53juL/QH8BvzRaNg+rQq+J+pkkrROq3bvkKRIxTRRGpMuvDhbBJHGqkg/DxYJoks81MaDDoTlouCmHjcK6qnIG/isptdiCnW9a3ZZk2tRC3EDEICIPSwtkrJU8DzNrsZZHk6V5TL9IlPxwtn63fadsUOSFy3v3kAov1bVerx+3FTDB0dTg/8e0AWP0JxRzJ1cDPP5fWA88HkZppPJQZZnD84fFF1uGCvR6gCVYMnQiZfnE8VuEiY3Sz5alMMyRGHLxdq1Rp/YvG3dz3sPioLYRrUYYvp/IV00hRT0cJaUseW/O1f+Bg==', 'RelayState': 'l0LX5FRIMBRZ5mJr', 'req_info': <saml2.request.AuthnRequest object at 0x105933d10>}
2013-12-12 13:06:41,581 saml2.idp:INFO parsed OK
2013-12-12 13:06:41,582 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-faed782fe5a7487eddbfb1f2c8d889ee" IssueInstant="2013-12-12T12:06:08Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:06:41,583 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-12-12 13:06:41,583 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087'}]
2013-12-12 13:06:41,583 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087
2013-12-12 13:06:41,584 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-12-12 13:06:41,584 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087'}]
2013-12-12 13:06:53,903 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-12-12 13:07:32,391 saml2.ident:DEBUG local_policy: <saml2.assertion.Policy object at 0x1057b9f10>, name_id_policy: <?xml version='1.0' encoding='UTF-8'?>
<ns0:NameIDPolicy xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" />
2013-12-12 13:09:01,555 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
2013-12-12 13:11:02,467 saml2.idp:INFO <application> PATH: sso/redirect
2013-12-12 13:11:02,468 saml2.idp:DEBUG QUERY: {'SAMLRequest': ['nVLBTuMwEL3zFZYvPbWxE6WNrCZVoUJbiYWKBg7cXMelllI7eCbd5e+xA7sICfWA5IM9es/z3puZL/4eW3LSHoyz5YhP2Ihoq1xj7HM5eqivx8VoUV3MLTCx7PFg7/VLrwFJoFkQoVzS3lvhJJjwlEcNApXYLn/fiHTCROcdOuVa+p/AzxMkgPYYxFCy/He9chb6o/Zb7U9G6Yf7m5IeEDuRJK1Tsj04QFGwYpZIBUkXXpSsgkhjZaR/Dy4SAJd43RivVSCsVyU1zXi/k3yXKp5nDctYPsvyaZ4rPt1N05kssmkAAvR6bQGlxZKmjGdjnoZT81RwJnL2RMnmw/alsUOSZy3v3kEgftX1Zry529bDByfTaH8b0CWN0JRgzB1dDPPxY2A08GkVpsPFIMuTa+ePEs83jJVodYAKbdHgK62+TxS6SZjcPPlsUQ3LEIWtVxvXGvVKlm3r/lx5LTGI3csWNP2BkC6aAgx6KEmq2PLrzlVv'], 'RelayState': ['kpzTIVITTRBrr7l5']}
2013-12-12 13:11:02,468 saml2.idp:INFO -- No USER --
2013-12-12 13:11:02,469 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-12-12 13:11:02,469 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'SCRIPT_NAME': '', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-NEu4Gm/org.macosforge.xquartz:0', 'CONTENT_LENGTH': '0', 'Apple_PubSub_Socket_Render': '/tmp/launch-xVjbBY/Render', 'SERVER_PORT': '8088', 'PYTHONPATH': '/Users/rolandh/code/pysaml2/src:/Users/rolandh/code/pysaml2', 'HTTP_HOST': 'localhost:8088', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100283270>, 'wsgi.multiprocess': False, 'PYCHARM_HOSTED': '1', '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', '__CHECKFIX1436934': '1', 'PATH_INFO': '/sso/redirect', 'PYTHONIOENCODING': 'UTF-8', 'LOGNAME': 'roland', 'USER': 'roland', 'QUERY_STRING': 'SAMLRequest=nVLBTuMwEL3zFZYvPbWxE6WNrCZVoUJbiYWKBg7cXMelllI7eCbd5e%2BxA7sICfWA5IM9es%2Fz3puZL%2F4eW3LSHoyz5YhP2Ihoq1xj7HM5eqivx8VoUV3MLTCx7PFg7%2FVLrwFJoFkQoVzS3lvhJJjwlEcNApXYLn%2FfiHTCROcdOuVa%2Bp%2FAzxMkgPYYxFCy%2FHe9chb6o%2FZb7U9G6Yf7m5IeEDuRJK1Tsj04QFGwYpZIBUkXXpSsgkhjZaR%2FDy4SAJd43RivVSCsVyU1zXi%2Fk3yXKp5nDctYPsvyaZ4rPt1N05kssmkAAvR6bQGlxZKmjGdjnoZT81RwJnL2RMnmw%2FalsUOSZy3v3kEgftX1Zry529bDByfTaH8b0CWN0JRgzB1dDPPxY2A08GkVpsPFIMuTa%2BePEs83jJVodYAKbdHgK62%2BTxS6SZjcPPlsUQ3LEIWtVxvXGvVKlm3r%2Flx5LTGI3csWNP2BkC6aAgx6KEmq2PLrzlVv&RelayState=kpzTIVITTRBrr7l5', 'PATH': '/usr/bin:/bin:/usr/sbin:/sbin', 'PYTHONUNBUFFERED': '1', 'TERM': 'emacs', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/13.0.0', 'SERVER_NAME': 'lingon.ladok.umu.se', 'REMOTE_ADDR': '127.0.0.1', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'GPG_AGENT_INFO': '/Users/rolandh/.gnupg/S.gpg-agent:379:1', 'SSH_AUTH_SOCK': '/tmp/launch-4QUUlT/Listeners', 'wsgi.input': <socket._fileobject object at 0x105756a50>, 'SHELL': '/bin/bash', 'wsgi.multithread': True, 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x10574a050>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress'}
2013-12-12 13:11:02,470 saml2.idp:INFO --- In SSO Redirect ---
2013-12-12 13:11:02,470 saml2.entity:INFO receiver addresses: ['http://localhost:8088/sso/redirect']
2013-12-12 13:11:02,471 saml2.entity:INFO Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
2013-12-12 13:11:02,471 saml2.request:INFO xmlstr: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-fba1b2c153d0305735655c16b627a836" IssueInstant="2013-12-12T12:10:50Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:11:02,474 saml2.request:INFO request: <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-fba1b2c153d0305735655c16b627a836" IssueInstant="2013-12-12T12:10:50Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:11:02,475 saml2.entity:DEBUG Loaded request
2013-12-12 13:11:02,475 saml2.entity:DEBUG Verified request
2013-12-12 13:11:02,476 saml2.idp:DEBUG _store_request: {'SAMLRequest': 'nVLBTuMwEL3zFZYvPbWxE6WNrCZVoUJbiYWKBg7cXMelllI7eCbd5e+xA7sICfWA5IM9es/z3puZL/4eW3LSHoyz5YhP2Ihoq1xj7HM5eqivx8VoUV3MLTCx7PFg7/VLrwFJoFkQoVzS3lvhJJjwlEcNApXYLn/fiHTCROcdOuVa+p/AzxMkgPYYxFCy/He9chb6o/Zb7U9G6Yf7m5IeEDuRJK1Tsj04QFGwYpZIBUkXXpSsgkhjZaR/Dy4SAJd43RivVSCsVyU1zXi/k3yXKp5nDctYPsvyaZ4rPt1N05kssmkAAvR6bQGlxZKmjGdjnoZT81RwJnL2RMnmw/alsUOSZy3v3kEgftX1Zry529bDByfTaH8b0CWN0JRgzB1dDPPxY2A08GkVpsPFIMuTa+ePEs83jJVodYAKbdHgK62+TxS6SZjcPPlsUQ3LEIWtVxvXGvVKlm3r/lx5LTGI3csWNP2BkC6aAgx6KEmq2PLrzlVv', 'RelayState': 'kpzTIVITTRBrr7l5', 'req_info': <saml2.request.AuthnRequest object at 0x105988410>}
2013-12-12 13:11:02,476 saml2.idp:DEBUG Do authentication
2013-12-12 13:11:06,777 saml2.idp:DEBUG Authn chosen: <function username_password_authn at 0x10573b488> (ref=1)
2013-12-12 13:11:06,777 saml2.idp:INFO The login page
2013-12-12 13:11:06,778 saml2.idp:INFO do_authentication argv: {'redirect_uri': 'http://localhost:8088/sso/redirect', 'key': '4360175f04be954143788a03a3c2e28fa24dd026', 'action': '/verify', 'authn_reference': '1', 'login': '', 'password': ''}
2013-12-12 13:11:13,682 saml2.idp:INFO <application> PATH: verify
2013-12-12 13:11:13,683 saml2.idp:DEBUG QUERY: {}
2013-12-12 13:11:13,683 saml2.idp:INFO -- No USER --
2013-12-12 13:11:13,683 saml2.idp:DEBUG Callback: <function do_verify at 0x10573b578>
2013-12-12 13:11:13,684 saml2.idp:DEBUG do_verify: {'form.submitted': ['Log In'], 'redirect_uri': ['http://localhost:8088/sso/redirect'], 'key': ['4360175f04be954143788a03a3c2e28fa24dd026'], 'authn_reference': ['1'], 'login': ['roland'], 'password': ['dianakra']}
2013-12-12 13:11:13,685 saml2.idp:DEBUG Register roland under 'KjdlXwR5XcltBA4odL1zHCgT'
2013-12-12 13:11:13,685 saml2.idp:DEBUG Cookie expires: Thu, 12-Dec-2013 12:16:13 GMT
2013-12-12 13:11:13,686 saml2.idp:DEBUG Redirect => http://localhost:8088/sso/redirect?id=KjdlXwR5XcltBA4odL1zHCgT&key=4360175f04be954143788a03a3c2e28fa24dd026
2013-12-12 13:11:13,714 saml2.idp:INFO <application> PATH: sso/redirect
2013-12-12 13:11:13,714 saml2.idp:INFO = KAKA =
2013-12-12 13:11:13,715 saml2.idp:DEBUG KAKA: idpauthn=S2pkbFh3UjVYY2x0QkE0b2RMMXpIQ2dUOjE=
2013-12-12 13:11:13,715 saml2.idp:DEBUG Callback: (<class '__main__.SSO'>, 'redirect')
2013-12-12 13:11:13,716 saml2.idp:DEBUG ENVIRON: {'SERVER_SOFTWARE': 'WSGIServer/0.1 Python/2.7.2', 'SCRIPT_NAME': '', 'REQUEST_METHOD': 'GET', 'SERVER_PROTOCOL': 'HTTP/1.1', 'HOME': '/Users/rolandh', 'DISPLAY': '/tmp/launch-NEu4Gm/org.macosforge.xquartz:0', 'CONTENT_LENGTH': '0', 'Apple_PubSub_Socket_Render': '/tmp/launch-xVjbBY/Render', 'idp.authn_ref': '1', 'SERVER_PORT': '8088', 'PYTHONPATH': '/Users/rolandh/code/pysaml2/src:/Users/rolandh/code/pysaml2', 'HTTP_HOST': 'localhost:8088', 'HTTP_ACCEPT': '*/*', 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.errors': <open file '<stderr>', mode 'w' at 0x100283270>, 'wsgi.multiprocess': False, 'PYCHARM_HOSTED': '1', '__CF_USER_TEXT_ENCODING': '0x1F6:0:7\n', '__CHECKFIX1436934': '1', 'PATH_INFO': '/sso/redirect', 'PYTHONIOENCODING': 'UTF-8', 'HTTP_COOKIE': 'idpauthn=S2pkbFh3UjVYY2x0QkE0b2RMMXpIQ2dUOjE=', 'LOGNAME': 'roland', 'USER': 'roland', 'QUERY_STRING': 'id=KjdlXwR5XcltBA4odL1zHCgT&key=4360175f04be954143788a03a3c2e28fa24dd026', 'PATH': '/usr/bin:/bin:/usr/sbin:/sbin', 'PYTHONUNBUFFERED': '1', 'TERM': 'emacs', 'HTTP_USER_AGENT': 'python-requests/1.1.0 CPython/2.7.2 Darwin/13.0.0', 'SERVER_NAME': 'lingon.ladok.umu.se', 'REMOTE_ADDR': '127.0.0.1', 'myapp.url_args': 'sso/redirect', 'wsgi.url_scheme': 'http', 'GPG_AGENT_INFO': '/Users/rolandh/.gnupg/S.gpg-agent:379:1', 'SSH_AUTH_SOCK': '/tmp/launch-4QUUlT/Listeners', 'wsgi.input': <socket._fileobject object at 0x105756a50>, 'SHELL': '/bin/bash', 'wsgi.multithread': True, 'TMPDIR': '/var/folders/5t/4k01mls142jd38mx3m3ht9000000gp/T/', 'GATEWAY_INTERFACE': 'CGI/1.1', 'CONTENT_TYPE': 'text/plain', 'wsgi.file_wrapper': <class wsgiref.util.FileWrapper at 0x10574a050>, 'REMOTE_HOST': '1.0.0.127.in-addr.arpa', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, compress'}
2013-12-12 13:11:13,716 saml2.idp:INFO --- In SSO Redirect ---
2013-12-12 13:11:13,717 saml2.idp:DEBUG _operation: {'SAMLRequest': 'nVLBTuMwEL3zFZYvPbWxE6WNrCZVoUJbiYWKBg7cXMelllI7eCbd5e+xA7sICfWA5IM9es/z3puZL/4eW3LSHoyz5YhP2Ihoq1xj7HM5eqivx8VoUV3MLTCx7PFg7/VLrwFJoFkQoVzS3lvhJJjwlEcNApXYLn/fiHTCROcdOuVa+p/AzxMkgPYYxFCy/He9chb6o/Zb7U9G6Yf7m5IeEDuRJK1Tsj04QFGwYpZIBUkXXpSsgkhjZaR/Dy4SAJd43RivVSCsVyU1zXi/k3yXKp5nDctYPsvyaZ4rPt1N05kssmkAAvR6bQGlxZKmjGdjnoZT81RwJnL2RMnmw/alsUOSZy3v3kEgftX1Zry529bDByfTaH8b0CWN0JRgzB1dDPPxY2A08GkVpsPFIMuTa+ePEs83jJVodYAKbdHgK62+TxS6SZjcPPlsUQ3LEIWtVxvXGvVKlm3r/lx5LTGI3csWNP2BkC6aAgx6KEmq2PLrzlVv', 'RelayState': 'kpzTIVITTRBrr7l5', 'req_info': <saml2.request.AuthnRequest object at 0x105988410>}
2013-12-12 13:11:13,717 saml2.idp:INFO parsed OK
2013-12-12 13:11:13,719 saml2.idp:DEBUG <?xml version='1.0' encoding='UTF-8'?>
<ns0:AuthnRequest xmlns:ns0="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:ns1="urn:oasis:names:tc:SAML:2.0:assertion" AssertionConsumerServiceURL="http://localhost:8087/acs/post" Destination="http://localhost:8088/sso/redirect" ID="id-fba1b2c153d0305735655c16b627a836" IssueInstant="2013-12-12T12:10:50Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" ProviderName="SAML2 test tool" Version="2.0"><ns1:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8087/sp.xml</ns1:Issuer><ns0:NameIDPolicy AllowCreate="false" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" /></ns0:AuthnRequest>
2013-12-12 13:11:13,719 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-12-12 13:11:13,719 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087'}]
2013-12-12 13:11:13,720 saml2.idp:DEBUG Binding: urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST, destination: http://localhost:8087
2013-12-12 13:11:13,720 saml2.mdstore:DEBUG _service(http://localhost:8087/sp.xml, spsso_descriptor, assertion_consumer_service, urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST)
2013-12-12 13:11:13,721 saml2.mdstore:DEBUG _service => [{'index': '1', 'binding': 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST', '__class__': 'urn:oasis:names:tc:SAML:2.0:metadata&AssertionConsumerService', 'location': 'http://localhost:8087'}]
2013-12-12 13:11:23,741 saml2.idp:INFO Identity: {'labeledURL': 'http://www.example.com/rohe My homepage', 'eduPersonTargetedID': 'one!for!all', 'displayName': 'P. Roland Hedberg', 'uid': 'rohe', 'c': 'SE', 'eduPersonScopedAffiliation': 'staff@example.com', 'o': 'Example Co.', 'eduPersonPrincipalName': 'rohe@example.com', 'sn': 'Hedberg', 'ou': 'IT', 'givenName': 'Roland', 'norEduPersonNIN': 'SE197001012222', 'email': 'roland@example.com', 'initials': 'P'}
2013-12-12 13:12:12,661 saml2.assertion:DEBUG filter based on: {'edupersontargetedid': None}
